{"episode_reward_max": -211788.3717629781, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -226596.71373514048, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2895.9127291478217}, "policy_reward_max": {"shared_policy": 1314.40678524971}, "policy_reward_mean": {"shared_policy": -932.4967643421419}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 104.76429292395774, "mean_processing_ms": 5.867383471822244, "mean_inference_ms": 0.900641490477225}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1240704, "num_steps_sampled": 10400, "sample_time_ms": 304498.451, "load_time_ms": 349.05, "grad_time_ms": 18292.042, "update_time_ms": 488.247, "learner": {"shared_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 3519.173095703125, "policy_loss": -0.0022897543385624886, "vf_loss": 3519.319091796875, "vf_explained_var": 0.08171325922012329, "kl": 0.009220690466463566, "entropy": 1.46102774143219, "entropy_coeff": 0.10000000149011612}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 10400, "episodes_total": 8, "training_iteration": 1, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-30-50", "timestamp": 1710293450, "time_this_iter_s": 323.806129693985, "time_total_s": 323.806129693985, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 323.806129693985, "timesteps_since_restore": 10400, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.01814254859611, "ram_util_percent": 30.657235421166313}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": -78507.44336087664, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -193885.9101488766, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1353.7670657634735}, "policy_reward_mean": {"shared_policy": -738.6129910433393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 104.13354684419372, "mean_processing_ms": 5.842034601748863, "mean_inference_ms": 0.8977710143117057}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2443904, "num_steps_sampled": 20800, "sample_time_ms": 298181.301, "load_time_ms": 310.412, "grad_time_ms": 18182.467, "update_time_ms": 245.733, "learner": {"shared_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.480000153416768e-05, "total_loss": 4787.87939453125, "policy_loss": 0.0007407116936519742, "vf_loss": 4788.01806640625, "vf_explained_var": 0.2740117907524109, "kl": 0.019815074279904366, "entropy": 1.5417718887329102, "entropy_coeff": 0.09167999774217606}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 20800, "episodes_total": 16, "training_iteration": 2, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-36-00", "timestamp": 1710293760, "time_this_iter_s": 310.3599052429199, "time_total_s": 634.1660349369049, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 634.1660349369049, "timesteps_since_restore": 20800, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.321266968325794, "ram_util_percent": 31.982805429864257}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": -78507.44336087664, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -171096.93689368878, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": -636.048092541594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 102.76243377722749, "mean_processing_ms": 5.782669944578928, "mean_inference_ms": 0.8973968998276766}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3516288, "num_steps_sampled": 31200, "sample_time_ms": 285985.056, "load_time_ms": 275.593, "grad_time_ms": 17531.88, "update_time_ms": 165.144, "learner": {"shared_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 8.959999831859022e-05, "total_loss": 7187.826171875, "policy_loss": 0.0027289954014122486, "vf_loss": 7187.95849609375, "vf_explained_var": 0.3569265902042389, "kl": 0.016166221350431442, "entropy": 1.6344716548919678, "entropy_coeff": 0.08336000144481659}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 31200, "episodes_total": 24, "training_iteration": 3, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-40-38", "timestamp": 1710294038, "time_this_iter_s": 278.178022146225, "time_total_s": 912.3440570831299, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 912.3440570831299, "timesteps_since_restore": 31200, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.49722921914358, "ram_util_percent": 32.14282115869018}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 9725.490102984098, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -136147.38035350287, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": -500.0822051551988}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 100.8208777194699, "mean_processing_ms": 5.708043289836294, "mean_inference_ms": 0.8998528138667325}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4420096, "num_steps_sampled": 41600, "sample_time_ms": 271828.393, "load_time_ms": 254.868, "grad_time_ms": 16939.004, "update_time_ms": 124.844, "learner": {"shared_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 8.440000237897038e-05, "total_loss": 8350.3857421875, "policy_loss": 0.0024788195732980967, "vf_loss": 8350.5087890625, "vf_explained_var": 0.4175126254558563, "kl": 0.010114372707903385, "entropy": 1.6931113004684448, "entropy_coeff": 0.07503999769687653}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 41600, "episodes_total": 32, "training_iteration": 4, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-44-43", "timestamp": 1710294283, "time_this_iter_s": 244.83360934257507, "time_total_s": 1157.177666425705, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1157.177666425705, "timesteps_since_restore": 41600, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.96171428571429, "ram_util_percent": 32.06485714285714}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 83650.31329392295, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -104980.06769905516, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": -382.8594737383484}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 98.6320628473682, "mean_processing_ms": 5.620356471352241, "mean_inference_ms": 0.8999494233921652}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5231488, "num_steps_sampled": 52000, "sample_time_ms": 257926.024, "load_time_ms": 238.083, "grad_time_ms": 16133.347, "update_time_ms": 100.656, "learner": {"shared_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 7.919999916339293e-05, "total_loss": 9328.4833984375, "policy_loss": 0.0019036661833524704, "vf_loss": 9328.5966796875, "vf_explained_var": 0.4581042528152466, "kl": 0.005663324147462845, "entropy": 1.7294048070907593, "entropy_coeff": 0.06672000139951706}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 52000, "episodes_total": 40, "training_iteration": 5, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-48-19", "timestamp": 1710294499, "time_this_iter_s": 215.5075273513794, "time_total_s": 1372.6851937770844, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1372.6851937770844, "timesteps_since_restore": 52000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.214332247557, "ram_util_percent": 32.07328990228013}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 83650.31329392295, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -87493.00858895331, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": -317.5789785442951}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 96.64371278862002, "mean_processing_ms": 5.540327158746089, "mean_inference_ms": 0.8999495404638814}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6049920, "num_steps_sampled": 62400, "sample_time_ms": 248634.807, "load_time_ms": 224.45, "grad_time_ms": 15660.29, "update_time_ms": 84.576, "learner": {"shared_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 7.400000322377309e-05, "total_loss": 9499.4296875, "policy_loss": 0.001264522667042911, "vf_loss": 9499.5322265625, "vf_explained_var": 0.4946022629737854, "kl": 0.004059362690895796, "entropy": 1.7776145935058594, "entropy_coeff": 0.058400001376867294}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 62400, "episodes_total": 48, "training_iteration": 6, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-51-54", "timestamp": 1710294714, "time_this_iter_s": 215.74025893211365, "time_total_s": 1588.425452709198, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1588.425452709198, "timesteps_since_restore": 62400, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.45811688311688, "ram_util_percent": 32.114285714285714}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 114922.17378758891, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -62959.940726663466, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": -227.76205947630194}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 94.66597356933588, "mean_processing_ms": 5.4610899997698565, "mean_inference_ms": 0.9000780519909074}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6741888, "num_steps_sampled": 72800, "sample_time_ms": 237773.043, "load_time_ms": 212.451, "grad_time_ms": 15108.299, "update_time_ms": 73.032, "learner": {"shared_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 6.880000000819564e-05, "total_loss": 11078.701171875, "policy_loss": 0.001225701766088605, "vf_loss": 11078.7880859375, "vf_explained_var": 0.5024599432945251, "kl": 0.003745871363207698, "entropy": 1.769147515296936, "entropy_coeff": 0.05008000135421753}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 72800, "episodes_total": 56, "training_iteration": 7, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-54-59", "timestamp": 1710294899, "time_this_iter_s": 184.65047669410706, "time_total_s": 1773.075929403305, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1773.075929403305, "timesteps_since_restore": 72800, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.92015209125475, "ram_util_percent": 32.13384030418253}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 171060.38288815934, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -38631.69980171779, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": -139.40171331246836}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 92.73511919035215, "mean_processing_ms": 5.383786687745736, "mean_inference_ms": 0.9006413665949058}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7358464, "num_steps_sampled": 83200, "sample_time_ms": 227692.643, "load_time_ms": 201.479, "grad_time_ms": 14426.073, "update_time_ms": 64.741, "learner": {"shared_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 6.359999679261819e-05, "total_loss": 12782.666015625, "policy_loss": 0.00038470185245387256, "vf_loss": 12782.7392578125, "vf_explained_var": 0.5031585693359375, "kl": 0.0016127341659739614, "entropy": 1.7510647773742676, "entropy_coeff": 0.041760001331567764}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 83200, "episodes_total": 64, "training_iteration": 8, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_21-57-46", "timestamp": 1710295066, "time_this_iter_s": 166.9877905845642, "time_total_s": 1940.0637199878693, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1940.0637199878693, "timesteps_since_restore": 83200, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.211715481171545, "ram_util_percent": 32.281589958158996}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 208067.62481431232, "episode_reward_min": -256522.29023409126, "episode_reward_mean": -18625.34280417676, "episode_len_mean": 1300.0, "episodes_this_iter": 7, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": -67.09281273955101}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 91.0815869299835, "mean_processing_ms": 5.315565846702957, "mean_inference_ms": 0.900727394337869}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7926400, "num_steps_sampled": 93600, "sample_time_ms": 218156.432, "load_time_ms": 189.345, "grad_time_ms": 13812.348, "update_time_ms": 57.982, "learner": {"shared_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 5.8400000852998346e-05, "total_loss": 14042.623046875, "policy_loss": -0.00022096913016866893, "vf_loss": 14042.6806640625, "vf_explained_var": 0.5042682886123657, "kl": 0.002155956346541643, "entropy": 1.7231686115264893, "entropy_coeff": 0.033440001308918}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 93600, "episodes_total": 71, "training_iteration": 9, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-00-17", "timestamp": 1710295217, "time_this_iter_s": 150.93164896965027, "time_total_s": 2090.9953689575195, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2090.9953689575195, "timesteps_since_restore": 93600, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 35.56325581395349, "ram_util_percent": 32.33441860465116}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 208067.62481431232, "episode_reward_min": -256522.29023409126, "episode_reward_mean": 532.7321703012611, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": 1.9159538128835463}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 89.25671324997161, "mean_processing_ms": 5.240292958822198, "mean_inference_ms": 0.9005378311612223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8481792, "num_steps_sampled": 104000, "sample_time_ms": 210167.921, "load_time_ms": 179.681, "grad_time_ms": 13359.775, "update_time_ms": 52.582, "learner": {"shared_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 5.32000012753997e-05, "total_loss": 14214.0078125, "policy_loss": -0.00023786071687936783, "vf_loss": 14214.05078125, "vf_explained_var": 0.5174831748008728, "kl": 0.0012221985962241888, "entropy": 1.7201566696166992, "entropy_coeff": 0.025119999423623085}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 104000, "episodes_total": 79, "training_iteration": 10, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-02-45", "timestamp": 1710295365, "time_this_iter_s": 147.72452902793884, "time_total_s": 2238.7198979854584, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2238.7198979854584, "timesteps_since_restore": 104000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.699052132701425, "ram_util_percent": 32.334597156398104}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 208067.62481431232, "episode_reward_min": -256522.29023409126, "episode_reward_mean": 17803.19428537172, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": 63.94508722761705}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 87.54167373586115, "mean_processing_ms": 5.169462642702785, "mean_inference_ms": 0.9001475287665811}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9017088, "num_steps_sampled": 114400, "sample_time_ms": 193148.775, "load_time_ms": 152.979, "grad_time_ms": 12356.948, "update_time_ms": 4.134, "learner": {"shared_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 14643.806640625, "policy_loss": -0.0004670166235882789, "vf_loss": 14643.83984375, "vf_explained_var": 0.5173557996749878, "kl": 0.0014670774107798934, "entropy": 1.6874362230300903, "entropy_coeff": 0.019899999722838402}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 114400, "episodes_total": 87, "training_iteration": 11, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-05-07", "timestamp": 1710295507, "time_this_iter_s": 142.71846961975098, "time_total_s": 2381.4383676052094, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2381.4383676052094, "timesteps_since_restore": 114400, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.81970443349754, "ram_util_percent": 32.34334975369458}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 243376.102081606, "episode_reward_min": -256522.29023409126, "episode_reward_mean": 33767.52526862327, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": 121.15397312936065}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 85.92995810911742, "mean_processing_ms": 5.102799174228244, "mean_inference_ms": 0.8996172975379381}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9530752, "num_steps_sampled": 124800, "sample_time_ms": 177085.427, "load_time_ms": 133.22, "grad_time_ms": 11332.284, "update_time_ms": 4.213, "learner": {"shared_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 15631.9453125, "policy_loss": -0.0005381801747716963, "vf_loss": 15631.978515625, "vf_explained_var": 0.5196793079376221, "kl": 0.0012827316531911492, "entropy": 1.65687096118927, "entropy_coeff": 0.01964000053703785}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 124800, "episodes_total": 95, "training_iteration": 12, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-07-27", "timestamp": 1710295647, "time_this_iter_s": 139.19486951828003, "time_total_s": 2520.6332371234894, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2520.6332371234894, "timesteps_since_restore": 124800, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.435175879396986, "ram_util_percent": 32.37738693467337}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 263444.4565755812, "episode_reward_min": -256522.29023409126, "episode_reward_mean": 56472.080091333824, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": 201.58520772233103}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 83.82500405693352, "mean_processing_ms": 5.015111606261192, "mean_inference_ms": 0.8986156211777018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10018176, "num_steps_sampled": 135200, "sample_time_ms": 162912.347, "load_time_ms": 119.692, "grad_time_ms": 10456.273, "update_time_ms": 4.338, "learner": {"shared_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 16994.474609375, "policy_loss": 8.53331875987351e-05, "vf_loss": 16994.505859375, "vf_explained_var": 0.5133724212646484, "kl": 0.0004759654402732849, "entropy": 1.6504616737365723, "entropy_coeff": 0.019379999488592148}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 135200, "episodes_total": 103, "training_iteration": 13, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-09-34", "timestamp": 1710295774, "time_this_iter_s": 127.46784973144531, "time_total_s": 2648.1010868549347, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2648.1010868549347, "timesteps_since_restore": 135200, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.862637362637365, "ram_util_percent": 32.395054945054945}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 263444.4565755812, "episode_reward_min": -222426.3185673108, "episode_reward_mean": 89950.22396648713, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3117.3440060373396}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": 318.98373689310654}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 80.65496650796041, "mean_processing_ms": 4.883401750765286, "mean_inference_ms": 0.8971064593453576}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10502272, "num_steps_sampled": 145600, "sample_time_ms": 151680.121, "load_time_ms": 107.548, "grad_time_ms": 9681.536, "update_time_ms": 4.376, "learner": {"shared_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 16923.08984375, "policy_loss": -0.0006312691257335246, "vf_loss": 16923.12109375, "vf_explained_var": 0.5146932005882263, "kl": 0.0016086294781416655, "entropy": 1.6141070127487183, "entropy_coeff": 0.019120000302791595}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 145600, "episodes_total": 111, "training_iteration": 14, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-11-39", "timestamp": 1710295899, "time_this_iter_s": 124.58547878265381, "time_total_s": 2772.6865656375885, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2772.6865656375885, "timesteps_since_restore": 145600, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 34.74494382022472, "ram_util_percent": 32.39943820224718}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269587.88041198277, "episode_reward_min": -131450.7960692343, "episode_reward_mean": 122422.1868246898, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2239.4458279944956}, "policy_reward_max": {"shared_policy": 1356.781165599823}, "policy_reward_mean": {"shared_policy": 434.15202079824735}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 77.46675097932271, "mean_processing_ms": 4.751859717475911, "mean_inference_ms": 0.8953435847485722}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10963072, "num_steps_sampled": 156000, "sample_time_ms": 142939.886, "load_time_ms": 97.323, "grad_time_ms": 9109.868, "update_time_ms": 4.351, "learner": {"shared_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 18438.853515625, "policy_loss": -0.00026054197223857045, "vf_loss": 18438.884765625, "vf_explained_var": 0.4984362721443176, "kl": 0.0015796867664903402, "entropy": 1.5999164581298828, "entropy_coeff": 0.018859999254345894}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 156000, "episodes_total": 119, "training_iteration": 15, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-13-41", "timestamp": 1710296021, "time_this_iter_s": 122.23994064331055, "time_total_s": 2894.926506280899, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2894.926506280899, "timesteps_since_restore": 156000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 35.18390804597701, "ram_util_percent": 32.39022988505747}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269587.88041198277, "episode_reward_min": -48593.70606113415, "episode_reward_mean": 149555.20184704033, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2110.168312638998}, "policy_reward_max": {"shared_policy": 1351.5096554756165}, "policy_reward_mean": {"shared_policy": 530.3752104654243}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 74.49537182930936, "mean_processing_ms": 4.628523624033025, "mean_inference_ms": 0.8928124424684278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11426176, "num_steps_sampled": 166400, "sample_time_ms": 133936.971, "load_time_ms": 88.442, "grad_time_ms": 8500.964, "update_time_ms": 4.351, "learner": {"shared_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 18095.625, "policy_loss": -0.0004781323077622801, "vf_loss": 18095.654296875, "vf_explained_var": 0.48981890082359314, "kl": 0.00254868739284575, "entropy": 1.5991079807281494, "entropy_coeff": 0.01860000006854534}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 166400, "episodes_total": 127, "training_iteration": 16, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-15-40", "timestamp": 1710296140, "time_this_iter_s": 119.48706722259521, "time_total_s": 3014.4135735034943, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3014.4135735034943, "timesteps_since_restore": 166400, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 35.134502923976605, "ram_util_percent": 32.39707602339181}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269587.88041198277, "episode_reward_min": -48593.70606113415, "episode_reward_mean": 169207.7060720128, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2110.168312638998}, "policy_reward_max": {"shared_policy": 1351.5096554756165}, "policy_reward_mean": {"shared_policy": 600.0911659822423}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 71.83996512734689, "mean_processing_ms": 4.516133642452409, "mean_inference_ms": 0.889621197655853}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11901312, "num_steps_sampled": 176800, "sample_time_ms": 128373.415, "load_time_ms": 81.255, "grad_time_ms": 8063.647, "update_time_ms": 4.334, "learner": {"shared_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 17363.189453125, "policy_loss": -0.00012497468560468405, "vf_loss": 17363.216796875, "vf_explained_var": 0.500725269317627, "kl": 0.000922282924875617, "entropy": 1.596409559249878, "entropy_coeff": 0.01834000088274479}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 176800, "episodes_total": 135, "training_iteration": 17, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-17-45", "timestamp": 1710296265, "time_this_iter_s": 124.52483248710632, "time_total_s": 3138.9384059906006, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3138.9384059906006, "timesteps_since_restore": 176800, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.179096045197745, "ram_util_percent": 32.4}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269587.88041198277, "episode_reward_min": -48593.70606113415, "episode_reward_mean": 188490.50098762932, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2110.168312638998}, "policy_reward_max": {"shared_policy": 1357.235096693039}, "policy_reward_mean": {"shared_policy": 668.5008546872938}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 69.43263213016526, "mean_processing_ms": 4.414145772688354, "mean_inference_ms": 0.8864756906682939}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12365312, "num_steps_sampled": 187200, "sample_time_ms": 123903.45, "load_time_ms": 76.141, "grad_time_ms": 7827.361, "update_time_ms": 4.124, "learner": {"shared_policy": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 17961.37890625, "policy_loss": -0.0003181633073836565, "vf_loss": 17961.408203125, "vf_explained_var": 0.4837247431278229, "kl": 0.0006895366823300719, "entropy": 1.5673972368240356, "entropy_coeff": 0.018079999834299088}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 187200, "episodes_total": 143, "training_iteration": 18, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-19-45", "timestamp": 1710296385, "time_this_iter_s": 119.8585422039032, "time_total_s": 3258.796948194504, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3258.796948194504, "timesteps_since_restore": 187200, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 34.94912280701754, "ram_util_percent": 32.4}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269587.88041198277, "episode_reward_min": 55081.77746894944, "episode_reward_mean": 203868.3112667891, "episode_len_mean": 1300.0, "episodes_this_iter": 7, "policy_reward_min": {"shared_policy": -1959.1004666630179}, "policy_reward_max": {"shared_policy": 1357.235096693039}, "policy_reward_mean": {"shared_policy": 723.0398328372431}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 67.48067706977292, "mean_processing_ms": 4.330353089879433, "mean_inference_ms": 0.8835350189992358}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12831744, "num_steps_sampled": 197600, "sample_time_ms": 121490.543, "load_time_ms": 73.958, "grad_time_ms": 7670.614, "update_time_ms": 4.181, "learner": {"shared_policy": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 17806.240234375, "policy_loss": -0.00020799953199457377, "vf_loss": 17806.267578125, "vf_explained_var": 0.48218441009521484, "kl": 0.0014522405108436942, "entropy": 1.5575019121170044, "entropy_coeff": 0.017820000648498535}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 197600, "episodes_total": 150, "training_iteration": 19, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-21-50", "timestamp": 1710296510, "time_this_iter_s": 125.20618033409119, "time_total_s": 3384.003128528595, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3384.003128528595, "timesteps_since_restore": 197600, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.3391061452514, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 91208.99846909463, "episode_reward_mean": 215919.7120488701, "episode_len_mean": 1300.0, "episodes_this_iter": 7, "policy_reward_min": {"shared_policy": -1959.1004666630179}, "policy_reward_max": {"shared_policy": 1357.235096693039}, "policy_reward_mean": {"shared_policy": 765.7813592313453}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 65.66807153841371, "mean_processing_ms": 4.2517654758011885, "mean_inference_ms": 0.8802466458274322}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13287040, "num_steps_sampled": 208000, "sample_time_ms": 118812.244, "load_time_ms": 72.704, "grad_time_ms": 7459.834, "update_time_ms": 4.124, "learner": {"shared_policy": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 18767.123046875, "policy_loss": -0.00027982002939097583, "vf_loss": 18767.150390625, "vf_explained_var": 0.4650963246822357, "kl": 0.0027285204268991947, "entropy": 1.5329841375350952, "entropy_coeff": 0.017559999600052834}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 208000, "episodes_total": 157, "training_iteration": 20, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-23-49", "timestamp": 1710296629, "time_this_iter_s": 118.81075358390808, "time_total_s": 3502.813882112503, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3502.813882112503, "timesteps_since_restore": 208000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 35.314201183431955, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 128549.01997592463, "episode_reward_mean": 225407.31682884757, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1504.64021140337}, "policy_reward_max": {"shared_policy": 1357.235096693039}, "policy_reward_mean": {"shared_policy": 799.4301206867908}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 63.828087668459595, "mean_processing_ms": 4.170945840261394, "mean_inference_ms": 0.8761182142865422}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13761920, "num_steps_sampled": 218400, "sample_time_ms": 116943.51, "load_time_ms": 71.982, "grad_time_ms": 7379.374, "update_time_ms": 4.125, "learner": {"shared_policy": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 17526.8828125, "policy_loss": -0.00015588417591061443, "vf_loss": 17526.908203125, "vf_explained_var": 0.472879558801651, "kl": 0.0010236765956506133, "entropy": 1.5287913084030151, "entropy_coeff": 0.01730000041425228}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 218400, "episodes_total": 165, "training_iteration": 21, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-25-52", "timestamp": 1710296752, "time_this_iter_s": 123.22122430801392, "time_total_s": 3626.035106420517, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3626.035106420517, "timesteps_since_restore": 218400, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 35.007386363636364, "ram_util_percent": 32.407386363636355}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 144703.77633107896, "episode_reward_mean": 231785.80691766273, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1290.4980764091015}, "policy_reward_max": {"shared_policy": 1357.235096693039}, "policy_reward_mean": {"shared_policy": 822.0520886567693}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 62.230900255720684, "mean_processing_ms": 4.100855886054028, "mean_inference_ms": 0.8721453783081522}, "off_policy_estimator": {}, "info": {"num_steps_trained": 14244736, "num_steps_sampled": 228800, "sample_time_ms": 115615.606, "load_time_ms": 71.337, "grad_time_ms": 7259.601, "update_time_ms": 4.1, "learner": {"shared_policy": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 16904.23828125, "policy_loss": -0.0002667659427970648, "vf_loss": 16904.265625, "vf_explained_var": 0.47583824396133423, "kl": 0.0015145248034968972, "entropy": 1.5301685333251953, "entropy_coeff": 0.01703999936580658}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 228800, "episodes_total": 173, "training_iteration": 22, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-27-57", "timestamp": 1710296877, "time_this_iter_s": 124.71476197242737, "time_total_s": 3750.7498683929443, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3750.7498683929443, "timesteps_since_restore": 228800, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 35.208988764044946, "ram_util_percent": 32.41011235955056}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 169231.04498601134, "episode_reward_mean": 236962.48041348282, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1005.4815281033516}, "policy_reward_max": {"shared_policy": 1357.235096693039}, "policy_reward_mean": {"shared_policy": 840.4116910678209}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 60.80074170244329, "mean_processing_ms": 4.037515326064351, "mean_inference_ms": 0.8682342567139061}, "off_policy_estimator": {}, "info": {"num_steps_trained": 14724096, "num_steps_sampled": 239200, "sample_time_ms": 115492.938, "load_time_ms": 71.874, "grad_time_ms": 7236.105, "update_time_ms": 3.926, "learner": {"shared_policy": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 17241.421875, "policy_loss": -0.00016649077588226646, "vf_loss": 17241.44921875, "vf_explained_var": 0.47629204392433167, "kl": 0.000615023251157254, "entropy": 1.5185145139694214, "entropy_coeff": 0.016780000180006027}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 239200, "episodes_total": 181, "training_iteration": 23, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-30-03", "timestamp": 1710297003, "time_this_iter_s": 126.01108407974243, "time_total_s": 3876.7609524726868, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3876.7609524726868, "timesteps_since_restore": 239200, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.55222222222222, "ram_util_percent": 32.40333333333332}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 182262.77928176674, "episode_reward_mean": 242904.15831435513, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -782.0318073630333}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 861.4844599033731}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 59.4995332668577, "mean_processing_ms": 3.9795198261298186, "mean_inference_ms": 0.8643754614459361}, "off_policy_estimator": {}, "info": {"num_steps_trained": 15168512, "num_steps_sampled": 249600, "sample_time_ms": 114992.567, "load_time_ms": 71.543, "grad_time_ms": 7189.807, "update_time_ms": 3.805, "learner": {"shared_policy": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 19915.998046875, "policy_loss": -0.0002246714720968157, "vf_loss": 19916.0234375, "vf_explained_var": 0.4317238926887512, "kl": 0.0015742819523438811, "entropy": 1.4928507804870605, "entropy_coeff": 0.016519999131560326}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 249600, "episodes_total": 189, "training_iteration": 24, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-32-02", "timestamp": 1710297122, "time_this_iter_s": 119.1093156337738, "time_total_s": 3995.8702681064606, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3995.8702681064606, "timesteps_since_restore": 249600, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.24882352941176, "ram_util_percent": 32.39999999999999}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 201402.1271380395, "episode_reward_mean": 248059.67587108232, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -592.0023908894509}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 879.8002336268215}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 58.32164097225305, "mean_processing_ms": 3.926814500530889, "mean_inference_ms": 0.8606688274554877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 15611520, "num_steps_sampled": 260000, "sample_time_ms": 114612.121, "load_time_ms": 71.513, "grad_time_ms": 7158.393, "update_time_ms": 3.833, "learner": {"shared_policy": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 20218.169921875, "policy_loss": -0.00017754957661964, "vf_loss": 20218.193359375, "vf_explained_var": 0.4094642698764801, "kl": 0.0021073243115097284, "entropy": 1.478715419769287, "entropy_coeff": 0.016259999945759773}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 260000, "episodes_total": 197, "training_iteration": 25, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-34-00", "timestamp": 1710297240, "time_this_iter_s": 118.12289524078369, "time_total_s": 4113.993163347244, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4113.993163347244, "timesteps_since_restore": 260000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 35.030177514792896, "ram_util_percent": 32.40769230769231}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 212699.86109713453, "episode_reward_mean": 251406.98751848165, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -592.0023908894509}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 891.6722380510078}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 57.26519396391574, "mean_processing_ms": 3.879564598706462, "mean_inference_ms": 0.8574304216621929}, "off_policy_estimator": {}, "info": {"num_steps_trained": 16054784, "num_steps_sampled": 270400, "sample_time_ms": 114303.806, "load_time_ms": 71.463, "grad_time_ms": 7121.749, "update_time_ms": 3.869, "learner": {"shared_policy": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 19926.32421875, "policy_loss": -0.0004801569157280028, "vf_loss": 19926.34765625, "vf_explained_var": 0.39863666892051697, "kl": 0.0022806550841778517, "entropy": 1.4562207460403442, "entropy_coeff": 0.01600000075995922}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 270400, "episodes_total": 205, "training_iteration": 26, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-35-56", "timestamp": 1710297356, "time_this_iter_s": 116.03844952583313, "time_total_s": 4230.031612873077, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4230.031612873077, "timesteps_since_restore": 270400, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 35.24484848484848, "ram_util_percent": 32.479393939393944}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 221700.22963798593, "episode_reward_mean": 254331.32434526976, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -592.0023908894509}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 902.0440657750305}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 56.30879848508413, "mean_processing_ms": 3.836564358488762, "mean_inference_ms": 0.8545931624560461}, "off_policy_estimator": {}, "info": {"num_steps_trained": 16505216, "num_steps_sampled": 280800, "sample_time_ms": 113651.248, "load_time_ms": 71.129, "grad_time_ms": 7077.955, "update_time_ms": 3.873, "learner": {"shared_policy": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 19535.63671875, "policy_loss": -0.00047342979814857244, "vf_loss": 19535.658203125, "vf_explained_var": 0.3968689739704132, "kl": 0.0012546766083687544, "entropy": 1.4405204057693481, "entropy_coeff": 0.01573999971151352}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 280800, "episodes_total": 213, "training_iteration": 27, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-37-54", "timestamp": 1710297474, "time_this_iter_s": 117.56153321266174, "time_total_s": 4347.593146085739, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4347.593146085739, "timesteps_since_restore": 280800, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 35.22380952380953, "ram_util_percent": 32.477380952380955}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 289684.1579618448, "episode_reward_min": 224714.80399078515, "episode_reward_mean": 256303.07176967352, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 909.0050779176958}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.44954894777973, "mean_processing_ms": 3.7980643176432727, "mean_inference_ms": 0.8520802531128103}, "off_policy_estimator": {}, "info": {"num_steps_trained": 16951168, "num_steps_sampled": 291200, "sample_time_ms": 113323.14, "load_time_ms": 69.987, "grad_time_ms": 7050.952, "update_time_ms": 3.818, "learner": {"shared_policy": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 20231.193359375, "policy_loss": -3.961943366448395e-05, "vf_loss": 20231.21484375, "vf_explained_var": 0.3832126259803772, "kl": 0.0015492342645302415, "entropy": 1.4492793083190918, "entropy_coeff": 0.015479999594390392}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 291200, "episodes_total": 221, "training_iteration": 28, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-39-50", "timestamp": 1710297590, "time_this_iter_s": 116.29423356056213, "time_total_s": 4463.887379646301, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4463.887379646301, "timesteps_since_restore": 291200, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 35.38614457831326, "ram_util_percent": 32.494578313253015}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 294652.9912277004, "episode_reward_min": 224714.80399078515, "episode_reward_mean": 259119.5773169587, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 918.9615112138126}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.665122483357806, "mean_processing_ms": 3.7629548220739224, "mean_inference_ms": 0.8498387876486271}, "off_policy_estimator": {}, "info": {"num_steps_trained": 17396480, "num_steps_sampled": 301600, "sample_time_ms": 112592.572, "load_time_ms": 69.377, "grad_time_ms": 7009.396, "update_time_ms": 3.819, "learner": {"shared_policy": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 19560.173828125, "policy_loss": -0.00031125935493037105, "vf_loss": 19560.197265625, "vf_explained_var": 0.3740050494670868, "kl": 0.001975580118596554, "entropy": 1.439765453338623, "entropy_coeff": 0.01522000040858984}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 301600, "episodes_total": 229, "training_iteration": 29, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-41-48", "timestamp": 1710297708, "time_this_iter_s": 117.48445415496826, "time_total_s": 4581.3718338012695, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4581.3718338012695, "timesteps_since_restore": 301600, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 34.723214285714285, "ram_util_percent": 32.48809523809524}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 304255.57494092453, "episode_reward_min": 224714.80399078515, "episode_reward_mean": 261424.97523374073, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 927.1375509229376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.942829685411404, "mean_processing_ms": 3.7307540337361984, "mean_inference_ms": 0.847839612358807}, "off_policy_estimator": {}, "info": {"num_steps_trained": 17831424, "num_steps_sampled": 312000, "sample_time_ms": 112305.53, "load_time_ms": 68.058, "grad_time_ms": 6973.095, "update_time_ms": 3.91, "learner": {"shared_policy": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 20872.857421875, "policy_loss": -0.00023481999232899398, "vf_loss": 20872.880859375, "vf_explained_var": 0.3388712406158447, "kl": 0.0009988113306462765, "entropy": 1.415350317955017, "entropy_coeff": 0.014960000291466713}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 312000, "episodes_total": 237, "training_iteration": 30, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-43-43", "timestamp": 1710297823, "time_this_iter_s": 115.56302213668823, "time_total_s": 4696.934855937958, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4696.934855937958, "timesteps_since_restore": 312000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 36.19878787878788, "ram_util_percent": 32.49818181818182}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 304255.57494092453, "episode_reward_min": 226133.90914282494, "episode_reward_mean": 264500.51520578685, "episode_len_mean": 1300.0, "episodes_this_iter": 9, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 938.0448813908816}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.188142206420544, "mean_processing_ms": 3.698201123870904, "mean_inference_ms": 0.845816085563892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 18257536, "num_steps_sampled": 322400, "sample_time_ms": 111573.329, "load_time_ms": 67.833, "grad_time_ms": 6880.74, "update_time_ms": 4.016, "learner": {"shared_policy": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 21841.962890625, "policy_loss": -0.0003458864812273532, "vf_loss": 21841.982421875, "vf_explained_var": 0.3256153464317322, "kl": 0.0017849949654191732, "entropy": 1.398598551750183, "entropy_coeff": 0.014700000174343586}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 322400, "episodes_total": 246, "training_iteration": 31, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-45-38", "timestamp": 1710297938, "time_this_iter_s": 114.96533131599426, "time_total_s": 4811.900187253952, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4811.900187253952, "timesteps_since_restore": 322400, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 34.66280487804878, "ram_util_percent": 32.49146341463414}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 305097.3669916924, "episode_reward_min": 226133.90914282494, "episode_reward_mean": 266298.9095948508, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 944.4228449652474}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.58686190248168, "mean_processing_ms": 3.6722740563056475, "mean_inference_ms": 0.8441804593689506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 18708736, "num_steps_sampled": 332800, "sample_time_ms": 111132.115, "load_time_ms": 67.775, "grad_time_ms": 6909.712, "update_time_ms": 4.084, "learner": {"shared_policy": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 19760.873046875, "policy_loss": -0.00018058168643619865, "vf_loss": 19760.89453125, "vf_explained_var": 0.34763267636299133, "kl": 0.0016213712515309453, "entropy": 1.4008355140686035, "entropy_coeff": 0.014440000057220459}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 332800, "episodes_total": 254, "training_iteration": 32, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-47-39", "timestamp": 1710298059, "time_this_iter_s": 120.58681583404541, "time_total_s": 4932.487003087997, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4932.487003087997, "timesteps_since_restore": 332800, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 34.7953488372093, "ram_util_percent": 32.484302325581396}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 305097.3669916924, "episode_reward_min": 226133.90914282494, "episode_reward_mean": 268113.2005081717, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 950.8571851905227}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.03740197376092, "mean_processing_ms": 3.6491734184365985, "mean_inference_ms": 0.8426786435210447}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19167104, "num_steps_sampled": 343200, "sample_time_ms": 110473.965, "load_time_ms": 67.171, "grad_time_ms": 6891.414, "update_time_ms": 4.113, "learner": {"shared_policy": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 19362.78125, "policy_loss": -0.0003288285224698484, "vf_loss": 19362.80078125, "vf_explained_var": 0.33215588331222534, "kl": 0.0024037607945501804, "entropy": 1.3963556289672852, "entropy_coeff": 0.014179999940097332}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 343200, "episodes_total": 262, "training_iteration": 33, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-49-38", "timestamp": 1710298178, "time_this_iter_s": 119.23706364631653, "time_total_s": 5051.724066734314, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5051.724066734314, "timesteps_since_restore": 343200, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 34.780588235294125, "ram_util_percent": 32.493529411764705}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 305097.3669916924, "episode_reward_min": 226133.90914282494, "episode_reward_mean": 270153.29003111226, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1374.0536711215973}, "policy_reward_mean": {"shared_policy": 958.0923148955997}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.51727411650655, "mean_processing_ms": 3.6273136531132604, "mean_inference_ms": 0.8412627228070718}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19611648, "num_steps_sampled": 353600, "sample_time_ms": 110235.561, "load_time_ms": 66.711, "grad_time_ms": 6878.678, "update_time_ms": 4.212, "learner": {"shared_policy": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 20887.5234375, "policy_loss": -0.0005392074817791581, "vf_loss": 20887.541015625, "vf_explained_var": 0.3316064476966858, "kl": 0.001585054793395102, "entropy": 1.3587483167648315, "entropy_coeff": 0.013919999822974205}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 353600, "episodes_total": 270, "training_iteration": 34, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-51-35", "timestamp": 1710298295, "time_this_iter_s": 116.61102795600891, "time_total_s": 5168.335094690323, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5168.335094690323, "timesteps_since_restore": 353600, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 34.98855421686747, "ram_util_percent": 32.5}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 305097.3669916924, "episode_reward_min": 234387.53331182315, "episode_reward_mean": 273437.4473833349, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 969.7738948196015}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.02460008274604, "mean_processing_ms": 3.6066592079294097, "mean_inference_ms": 0.8399169504943376}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20041472, "num_steps_sampled": 364000, "sample_time_ms": 110052.639, "load_time_ms": 66.206, "grad_time_ms": 6855.002, "update_time_ms": 4.279, "learner": {"shared_policy": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 22341.615234375, "policy_loss": -0.00018406262097414583, "vf_loss": 22341.634765625, "vf_explained_var": 0.3057063817977905, "kl": 0.0022245971485972404, "entropy": 1.3574663400650024, "entropy_coeff": 0.013659999705851078}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 364000, "episodes_total": 278, "training_iteration": 35, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-53-31", "timestamp": 1710298411, "time_this_iter_s": 116.04710745811462, "time_total_s": 5284.3822021484375, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5284.3822021484375, "timesteps_since_restore": 364000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.07048192771084, "ram_util_percent": 32.47650602409639}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 307837.0674866268, "episode_reward_min": 242041.8718284265, "episode_reward_mean": 276643.9656743214, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 981.1461401415853}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.55415681853423, "mean_processing_ms": 3.586897176997633, "mean_inference_ms": 0.8386357959122037}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20447872, "num_steps_sampled": 374400, "sample_time_ms": 109356.615, "load_time_ms": 65.566, "grad_time_ms": 6798.179, "update_time_ms": 4.171, "learner": {"shared_policy": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 24095.87890625, "policy_loss": -0.00019112121663056314, "vf_loss": 24095.89453125, "vf_explained_var": 0.2381269931793213, "kl": 0.0011446790304034948, "entropy": 1.3475264310836792, "entropy_coeff": 0.013399999588727951}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 374400, "episodes_total": 286, "training_iteration": 36, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-55-20", "timestamp": 1710298520, "time_this_iter_s": 108.49361205101013, "time_total_s": 5392.875814199448, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5392.875814199448, "timesteps_since_restore": 374400, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 34.86645161290323, "ram_util_percent": 32.45161290322581}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 307837.0674866268, "episode_reward_min": 249708.55981992203, "episode_reward_mean": 278243.8471867318, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 986.7852863309284}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.113255644962685, "mean_processing_ms": 3.568383887769108, "mean_inference_ms": 0.8374260531674783}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20885888, "num_steps_sampled": 384800, "sample_time_ms": 109197.742, "load_time_ms": 65.651, "grad_time_ms": 6786.255, "update_time_ms": 4.299, "learner": {"shared_policy": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 21921.341796875, "policy_loss": -0.00047511752927675843, "vf_loss": 21921.361328125, "vf_explained_var": 0.311177134513855, "kl": 0.0026248900685459375, "entropy": 1.3352458477020264, "entropy_coeff": 0.013140000402927399}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 384800, "episodes_total": 294, "training_iteration": 37, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-57-15", "timestamp": 1710298635, "time_this_iter_s": 115.84602856636047, "time_total_s": 5508.721842765808, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5508.721842765808, "timesteps_since_restore": 384800, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 34.94909090909091, "ram_util_percent": 32.42060606060606}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 307837.0674866268, "episode_reward_min": 255736.04619897512, "episode_reward_mean": 279774.4725785647, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 992.213613428963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.69907174535749, "mean_processing_ms": 3.5510669519472926, "mean_inference_ms": 0.8362962934823344}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21325440, "num_steps_sampled": 395200, "sample_time_ms": 109217.802, "load_time_ms": 67.655, "grad_time_ms": 6727.422, "update_time_ms": 4.273, "learner": {"shared_policy": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 21802.669921875, "policy_loss": -0.00014789422857575119, "vf_loss": 21802.6875, "vf_explained_var": 0.3060573637485504, "kl": 0.0010760684963315725, "entropy": 1.324867606163025, "entropy_coeff": 0.012880000285804272}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 395200, "episodes_total": 302, "training_iteration": 38, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_22-59-11", "timestamp": 1710298751, "time_this_iter_s": 115.92660975456238, "time_total_s": 5624.6484525203705, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5624.6484525203705, "timesteps_since_restore": 395200, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 35.045180722891565, "ram_util_percent": 32.498795180722894}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 307837.0674866268, "episode_reward_min": 255736.04619897512, "episode_reward_mean": 280404.264788155, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 994.4824258340011}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.310322666188185, "mean_processing_ms": 3.5348815117715726, "mean_inference_ms": 0.8352524896315805}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21763712, "num_steps_sampled": 405600, "sample_time_ms": 109313.361, "load_time_ms": 67.627, "grad_time_ms": 6697.15, "update_time_ms": 4.245, "learner": {"shared_policy": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 22020.365234375, "policy_loss": -0.0002816740015987307, "vf_loss": 22020.380859375, "vf_explained_var": 0.3095017969608307, "kl": 0.0022035015281289816, "entropy": 1.3058513402938843, "entropy_coeff": 0.012620000168681145}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 405600, "episodes_total": 310, "training_iteration": 39, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-01-10", "timestamp": 1710298870, "time_this_iter_s": 118.13892006874084, "time_total_s": 5742.787372589111, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5742.787372589111, "timesteps_since_restore": 405600, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 36.11488095238095, "ram_util_percent": 32.5}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 307837.0674866268, "episode_reward_min": 255736.04619897512, "episode_reward_mean": 281969.94348989, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -684.4775735139847}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 1000.0352656046604}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.94357982991046, "mean_processing_ms": 3.519624532623934, "mean_inference_ms": 0.8342644025648684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22207872, "num_steps_sampled": 416000, "sample_time_ms": 109303.932, "load_time_ms": 67.806, "grad_time_ms": 6689.299, "update_time_ms": 4.23, "learner": {"shared_policy": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 21937.154296875, "policy_loss": -0.0002618700673338026, "vf_loss": 21937.171875, "vf_explained_var": 0.30978259444236755, "kl": 0.0018931974191218615, "entropy": 1.2929222583770752, "entropy_coeff": 0.012360000051558018}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 416000, "episodes_total": 318, "training_iteration": 40, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-03-05", "timestamp": 1710298985, "time_this_iter_s": 115.39740872383118, "time_total_s": 5858.1847813129425, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5858.1847813129425, "timesteps_since_restore": 416000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.237575757575755, "ram_util_percent": 32.5}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 309847.9281538626, "episode_reward_min": 255736.04619897512, "episode_reward_mean": 283303.8639932622, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 1004.766151203228}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.59474172283162, "mean_processing_ms": 3.5051374567490527, "mean_inference_ms": 0.8333300943988371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22630912, "num_steps_sampled": 426400, "sample_time_ms": 108896.15, "load_time_ms": 66.677, "grad_time_ms": 6676.164, "update_time_ms": 4.184, "learner": {"shared_policy": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 24262.931640625, "policy_loss": -0.00022468148381449282, "vf_loss": 24262.947265625, "vf_explained_var": 0.2741159498691559, "kl": 0.0015206922544166446, "entropy": 1.271645426750183, "entropy_coeff": 0.01209999993443489}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 426400, "episodes_total": 326, "training_iteration": 41, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-04-56", "timestamp": 1710299096, "time_this_iter_s": 110.75150680541992, "time_total_s": 5968.936288118362, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5968.936288118362, "timesteps_since_restore": 426400, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.87341772151899, "ram_util_percent": 32.50759493670886}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 319410.8380218371, "episode_reward_min": 257558.48985056148, "episode_reward_mean": 285972.6131251077, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 1014.2671151803785}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.261943029348856, "mean_processing_ms": 3.4912974212267796, "mean_inference_ms": 0.8324122496036557}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23040896, "num_steps_sampled": 436800, "sample_time_ms": 107647.161, "load_time_ms": 66.412, "grad_time_ms": 6610.8, "update_time_ms": 4.266, "learner": {"shared_policy": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 25100.59375, "policy_loss": -0.000502813549246639, "vf_loss": 25100.60546875, "vf_explained_var": 0.21230058372020721, "kl": 0.004557666834443808, "entropy": 1.262274980545044, "entropy_coeff": 0.011839999817311764}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 436800, "episodes_total": 334, "training_iteration": 42, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-06-43", "timestamp": 1710299203, "time_this_iter_s": 107.44443678855896, "time_total_s": 6076.380724906921, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6076.380724906921, "timesteps_since_restore": 436800, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 35.02418300653595, "ram_util_percent": 32.507189542483665}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 320078.99767222884, "episode_reward_min": 257558.48985056148, "episode_reward_mean": 287442.76738769165, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 1019.4451957287972}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.9542471645843, "mean_processing_ms": 3.4777205609494053, "mean_inference_ms": 0.8315912370247998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23449728, "num_steps_sampled": 447200, "sample_time_ms": 106897.267, "load_time_ms": 65.436, "grad_time_ms": 6482.438, "update_time_ms": 4.484, "learner": {"shared_policy": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 25333.337890625, "policy_loss": -0.00048502429854124784, "vf_loss": 25333.349609375, "vf_explained_var": 0.23019373416900635, "kl": 0.0022732370998710394, "entropy": 1.2427091598510742, "entropy_coeff": 0.011579999700188637}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 447200, "episodes_total": 342, "training_iteration": 43, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-08-34", "timestamp": 1710299314, "time_this_iter_s": 110.4416983127594, "time_total_s": 6186.822423219681, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6186.822423219681, "timesteps_since_restore": 447200, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 35.810759493670886, "ram_util_percent": 32.50886075949367}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 320078.99767222884, "episode_reward_min": 257845.21721790856, "episode_reward_mean": 290122.78134797385, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1400.019378900528}, "policy_reward_mean": {"shared_policy": 1028.9501395516168}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.64457817476381, "mean_processing_ms": 3.464426067024038, "mean_inference_ms": 0.8307790362887666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23853824, "num_steps_sampled": 457600, "sample_time_ms": 106044.494, "load_time_ms": 65.018, "grad_time_ms": 6424.583, "update_time_ms": 4.407, "learner": {"shared_policy": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 25645.1953125, "policy_loss": -0.00021808398014400154, "vf_loss": 25645.20703125, "vf_explained_var": 0.19626334309577942, "kl": 0.002588064642623067, "entropy": 1.2351130247116089, "entropy_coeff": 0.01131999958306551}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 457600, "episodes_total": 350, "training_iteration": 44, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-10-21", "timestamp": 1710299421, "time_this_iter_s": 107.49120616912842, "time_total_s": 6294.313629388809, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6294.313629388809, "timesteps_since_restore": 457600, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 35.03333333333334, "ram_util_percent": 32.51176470588236}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 257845.21721790856, "episode_reward_mean": 292482.26809100324, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1403.203607559204}, "policy_reward_mean": {"shared_policy": 1037.3183007909038}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.342879455793934, "mean_processing_ms": 3.4514055569508866, "mean_inference_ms": 0.8299952560949562}, "off_policy_estimator": {}, "info": {"num_steps_trained": 24249728, "num_steps_sampled": 468000, "sample_time_ms": 105082.106, "load_time_ms": 64.068, "grad_time_ms": 6363.104, "update_time_ms": 4.329, "learner": {"shared_policy": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 27320.78125, "policy_loss": -3.159108018735424e-05, "vf_loss": 27320.794921875, "vf_explained_var": 0.1910094916820526, "kl": 0.0013043113285675645, "entropy": 1.2316522598266602, "entropy_coeff": 0.011060000397264957}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 468000, "episodes_total": 358, "training_iteration": 45, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-12-07", "timestamp": 1710299527, "time_this_iter_s": 105.80119061470032, "time_total_s": 6400.1148200035095, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6400.1148200035095, "timesteps_since_restore": 468000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 34.09470198675496, "ram_util_percent": 32.56490066225165}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 261456.87028300646, "episode_reward_mean": 295484.03377366153, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1405.0696737766266}, "policy_reward_mean": {"shared_policy": 1048.0758832818835}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.04688485971181, "mean_processing_ms": 3.4386294161860484, "mean_inference_ms": 0.8292328994677126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 24645760, "num_steps_sampled": 478400, "sample_time_ms": 104657.838, "load_time_ms": 63.443, "grad_time_ms": 6335.961, "update_time_ms": 4.29, "learner": {"shared_policy": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 27904.646484375, "policy_loss": -9.424472955288365e-05, "vf_loss": 27904.66015625, "vf_explained_var": 0.19777412712574005, "kl": 0.001880018156953156, "entropy": 1.2115981578826904, "entropy_coeff": 0.01080000028014183}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 478400, "episodes_total": 366, "training_iteration": 46, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-13-51", "timestamp": 1710299631, "time_this_iter_s": 103.97418689727783, "time_total_s": 6504.089006900787, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6504.089006900787, "timesteps_since_restore": 478400, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 34.78791946308725, "ram_util_percent": 32.56510067114093}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 266482.3624135704, "episode_reward_mean": 297816.26127776026, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1405.0758082866669}, "policy_reward_mean": {"shared_policy": 1056.3107798743004}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.76163717001678, "mean_processing_ms": 3.4264021169422536, "mean_inference_ms": 0.828500178948863}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25047680, "num_steps_sampled": 488800, "sample_time_ms": 103915.458, "load_time_ms": 62.362, "grad_time_ms": 6255.696, "update_time_ms": 4.197, "learner": {"shared_policy": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 26496.30078125, "policy_loss": -0.0001768599613569677, "vf_loss": 26496.310546875, "vf_explained_var": 0.18051613867282867, "kl": 0.0021724002435803413, "entropy": 1.2140159606933594, "entropy_coeff": 0.010540000163018703}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 488800, "episodes_total": 374, "training_iteration": 47, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-15-39", "timestamp": 1710299739, "time_this_iter_s": 107.6007080078125, "time_total_s": 6611.6897149086, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6611.6897149086, "timesteps_since_restore": 488800, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 36.00261437908497, "ram_util_percent": 32.54509803921568}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 266482.3624135704, "episode_reward_mean": 299190.7679409319, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -216.3675738722086}, "policy_reward_max": {"shared_policy": 1405.0758082866669}, "policy_reward_mean": {"shared_policy": 1061.1859542488896}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.486189645535234, "mean_processing_ms": 3.4144674112783195, "mean_inference_ms": 0.8277817986341893}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25456128, "num_steps_sampled": 499200, "sample_time_ms": 103113.13, "load_time_ms": 60.07, "grad_time_ms": 6230.812, "update_time_ms": 4.2, "learner": {"shared_policy": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 26039.3359375, "policy_loss": -0.000331997056491673, "vf_loss": 26039.34765625, "vf_explained_var": 0.18090510368347168, "kl": 0.001941882655955851, "entropy": 1.203527569770813, "entropy_coeff": 0.010280000045895576}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 499200, "episodes_total": 382, "training_iteration": 48, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-17-26", "timestamp": 1710299846, "time_this_iter_s": 107.62090182304382, "time_total_s": 6719.310616731644, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6719.310616731644, "timesteps_since_restore": 499200, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 34.96103896103896, "ram_util_percent": 32.562987012987016}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 266482.3624135704, "episode_reward_mean": 300125.5985887435, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -211.34028213843703}, "policy_reward_max": {"shared_policy": 1408.473023891449}, "policy_reward_mean": {"shared_policy": 1064.5016620158315}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.22499183692349, "mean_processing_ms": 3.40317704801339, "mean_inference_ms": 0.8270735039159848}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25877760, "num_steps_sampled": 509600, "sample_time_ms": 102230.828, "load_time_ms": 59.356, "grad_time_ms": 6210.125, "update_time_ms": 4.161, "learner": {"shared_policy": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 24992.884765625, "policy_loss": -4.175186040811241e-05, "vf_loss": 24992.8984375, "vf_explained_var": 0.19851592183113098, "kl": 0.0013594140764325857, "entropy": 1.2054554224014282, "entropy_coeff": 0.01001999992877245}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 509600, "episodes_total": 390, "training_iteration": 49, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-19-16", "timestamp": 1710299956, "time_this_iter_s": 109.09098887443542, "time_total_s": 6828.401605606079, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6828.401605606079, "timesteps_since_restore": 509600, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.766666666666666, "ram_util_percent": 32.579487179487174}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 266482.3624135704, "episode_reward_mean": 301680.868319028, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -211.34028213843703}, "policy_reward_max": {"shared_policy": 1413.5766949653625}, "policy_reward_mean": {"shared_policy": 1070.0179765873168}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.9725288652505, "mean_processing_ms": 3.3922804962988646, "mean_inference_ms": 0.8263948411029969}, "off_policy_estimator": {}, "info": {"num_steps_trained": 26301184, "num_steps_sampled": 520000, "sample_time_ms": 101961.225, "load_time_ms": 58.131, "grad_time_ms": 6173.808, "update_time_ms": 4.174, "learner": {"shared_policy": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 25045.4609375, "policy_loss": -0.0002110468631144613, "vf_loss": 25045.47265625, "vf_explained_var": 0.1909799426794052, "kl": 0.0028240042738616467, "entropy": 1.2040424346923828, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 520000, "episodes_total": 398, "training_iteration": 50, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-21-08", "timestamp": 1710300068, "time_this_iter_s": 112.31412434577942, "time_total_s": 6940.7157299518585, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6940.7157299518585, "timesteps_since_restore": 520000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 36.1225, "ram_util_percent": 32.596250000000005}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 266482.3624135704, "episode_reward_mean": 303596.6422746899, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1413.5766949653625}, "policy_reward_mean": {"shared_policy": 1076.812946991168}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.72572241534106, "mean_processing_ms": 3.3815889191485207, "mean_inference_ms": 0.8257066037379779}, "off_policy_estimator": {}, "info": {"num_steps_trained": 26717824, "num_steps_sampled": 530400, "sample_time_ms": 101667.783, "load_time_ms": 57.871, "grad_time_ms": 6160.486, "update_time_ms": 4.132, "learner": {"shared_policy": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 25736.73046875, "policy_loss": -0.0004240247653797269, "vf_loss": 25736.740234375, "vf_explained_var": 0.18940970301628113, "kl": 0.003899409668520093, "entropy": 1.1991318464279175, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 530400, "episodes_total": 406, "training_iteration": 51, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-22-56", "timestamp": 1710300176, "time_this_iter_s": 107.67330932617188, "time_total_s": 7048.38903927803, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7048.38903927803, "timesteps_since_restore": 530400, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 34.79415584415584, "ram_util_percent": 32.59285714285714}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326061.70166570996, "episode_reward_min": 266482.3624135704, "episode_reward_mean": 305899.9276744442, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1413.5766949653625}, "policy_reward_mean": {"shared_policy": 1084.9438825126592}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.4836329526768, "mean_processing_ms": 3.3710769821004236, "mean_inference_ms": 0.8250113204226505}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27120128, "num_steps_sampled": 540800, "sample_time_ms": 101501.769, "load_time_ms": 57.453, "grad_time_ms": 6140.871, "update_time_ms": 3.909, "learner": {"shared_policy": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 27523.263671875, "policy_loss": -0.00011589661153266206, "vf_loss": 27523.275390625, "vf_explained_var": 0.1847706437110901, "kl": 0.0016028601676225662, "entropy": 1.1875375509262085, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 540800, "episodes_total": 414, "training_iteration": 52, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-24-41", "timestamp": 1710300281, "time_this_iter_s": 105.57631945610046, "time_total_s": 7153.965358734131, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7153.965358734131, "timesteps_since_restore": 540800, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 34.693999999999996, "ram_util_percent": 32.60666666666667}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 331777.0461726191, "episode_reward_min": 266482.3624135704, "episode_reward_mean": 307899.51918039116, "episode_len_mean": 1300.0, "episodes_this_iter": 9, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1413.5766949653625}, "policy_reward_mean": {"shared_policy": 1092.11335856557}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.20626845268103, "mean_processing_ms": 3.3596106442593827, "mean_inference_ms": 0.8243245596620458}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27497728, "num_steps_sampled": 551200, "sample_time_ms": 100673.499, "load_time_ms": 56.414, "grad_time_ms": 6134.855, "update_time_ms": 3.672, "learner": {"shared_policy": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 30012.30078125, "policy_loss": -0.00010858034511329606, "vf_loss": 30012.3125, "vf_explained_var": 0.12585467100143433, "kl": 0.001009449944831431, "entropy": 1.1989679336547852, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 551200, "episodes_total": 423, "training_iteration": 53, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-26-23", "timestamp": 1710300383, "time_this_iter_s": 102.08556294441223, "time_total_s": 7256.050921678543, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7256.050921678543, "timesteps_since_restore": 551200, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 36.15821917808219, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 331777.0461726191, "episode_reward_min": 288100.3267553159, "episode_reward_mean": 309134.6849966276, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1415.2665631771088}, "policy_reward_mean": {"shared_policy": 1096.4944666996334}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.977628073984235, "mean_processing_ms": 3.3499093952330803, "mean_inference_ms": 0.8236836629223875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27901952, "num_steps_sampled": 561600, "sample_time_ms": 100566.088, "load_time_ms": 55.937, "grad_time_ms": 6107.276, "update_time_ms": 3.76, "learner": {"shared_policy": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 26722.056640625, "policy_loss": -0.00014924579591024667, "vf_loss": 26722.06640625, "vf_explained_var": 0.15201666951179504, "kl": 0.001178913633339107, "entropy": 1.1926648616790771, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 561600, "episodes_total": 431, "training_iteration": 54, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-28-10", "timestamp": 1710300490, "time_this_iter_s": 106.12975454330444, "time_total_s": 7362.1806762218475, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7362.1806762218475, "timesteps_since_restore": 561600, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 35.09276315789474, "ram_util_percent": 32.651315789473685}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 331777.0461726191, "episode_reward_min": 294267.995618206, "episode_reward_mean": 309525.5850105719, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1415.2665631771088}, "policy_reward_mean": {"shared_policy": 1097.8809811320962}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.75611238295222, "mean_processing_ms": 3.340481490426896, "mean_inference_ms": 0.8230412630961226}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28318720, "num_steps_sampled": 572000, "sample_time_ms": 100757.527, "load_time_ms": 56.619, "grad_time_ms": 6125.527, "update_time_ms": 3.802, "learner": {"shared_policy": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 25727.720703125, "policy_loss": -0.00046251880121417344, "vf_loss": 25727.73046875, "vf_explained_var": 0.1656714230775833, "kl": 0.0032922395039349794, "entropy": 1.1784741878509521, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 572000, "episodes_total": 439, "training_iteration": 55, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-29-57", "timestamp": 1710300597, "time_this_iter_s": 107.90025901794434, "time_total_s": 7470.080935239792, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7470.080935239792, "timesteps_since_restore": 572000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 35.19675324675324, "ram_util_percent": 32.61753246753247}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 331777.0461726191, "episode_reward_min": 294267.995618206, "episode_reward_mean": 309998.06858053396, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1415.2665631771088}, "policy_reward_mean": {"shared_policy": 1099.5958732283414}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.543344907098636, "mean_processing_ms": 3.3314210094096985, "mean_inference_ms": 0.8223969100026923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28714496, "num_steps_sampled": 582400, "sample_time_ms": 100788.859, "load_time_ms": 56.865, "grad_time_ms": 6121.722, "update_time_ms": 3.915, "learner": {"shared_policy": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 28134.8125, "policy_loss": -0.00013415617286227643, "vf_loss": 28134.826171875, "vf_explained_var": 0.15972068905830383, "kl": 0.002333425683900714, "entropy": 1.1893622875213623, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 582400, "episodes_total": 447, "training_iteration": 56, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-31-42", "timestamp": 1710300702, "time_this_iter_s": 104.25229930877686, "time_total_s": 7574.333234548569, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7574.333234548569, "timesteps_since_restore": 582400, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 35.2472972972973, "ram_util_percent": 32.600675675675674}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 331777.0461726191, "episode_reward_min": 295053.96751624596, "episode_reward_mean": 310621.3326478954, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1415.2665631771088}, "policy_reward_mean": {"shared_policy": 1101.8066566681875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.33826559023493, "mean_processing_ms": 3.3227499103737386, "mean_inference_ms": 0.8217896768065062}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29117568, "num_steps_sampled": 592800, "sample_time_ms": 100569.318, "load_time_ms": 56.305, "grad_time_ms": 6083.041, "update_time_ms": 3.977, "learner": {"shared_policy": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 27573.078125, "policy_loss": -4.8143592721316963e-05, "vf_loss": 27573.087890625, "vf_explained_var": 0.16075623035430908, "kl": 0.002058521844446659, "entropy": 1.192056655883789, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 592800, "episodes_total": 455, "training_iteration": 57, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-33-27", "timestamp": 1710300807, "time_this_iter_s": 105.01549410820007, "time_total_s": 7679.348728656769, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7679.348728656769, "timesteps_since_restore": 592800, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 35.50933333333333, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 295053.96751624596, "episode_reward_mean": 310915.50224499614, "episode_len_mean": 1300.0, "episodes_this_iter": 7, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1415.2665631771088}, "policy_reward_mean": {"shared_policy": 1102.7718743172172}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.17422929395447, "mean_processing_ms": 3.315488594515598, "mean_inference_ms": 0.821222492862315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29514880, "num_steps_sampled": 603200, "sample_time_ms": 100144.566, "load_time_ms": 56.16, "grad_time_ms": 6056.745, "update_time_ms": 3.916, "learner": {"shared_policy": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 28332.654296875, "policy_loss": -0.00017185152682941407, "vf_loss": 28332.66796875, "vf_explained_var": 0.13826367259025574, "kl": 0.0027377204969525337, "entropy": 1.180679440498352, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 603200, "episodes_total": 462, "training_iteration": 58, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-35-10", "timestamp": 1710300910, "time_this_iter_s": 103.10672354698181, "time_total_s": 7782.455452203751, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7782.455452203751, "timesteps_since_restore": 603200, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 36.08571428571429, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 295053.96751624596, "episode_reward_mean": 311271.124147477, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1419.9580233097076}, "policy_reward_mean": {"shared_policy": 1103.9940562066924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.9827783237128, "mean_processing_ms": 3.307197018976818, "mean_inference_ms": 0.8206553011900559}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29909120, "num_steps_sampled": 613600, "sample_time_ms": 99668.787, "load_time_ms": 55.809, "grad_time_ms": 6006.238, "update_time_ms": 4.083, "learner": {"shared_policy": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 28811.345703125, "policy_loss": -0.00030169051024131477, "vf_loss": 28811.35546875, "vf_explained_var": 0.1392538845539093, "kl": 0.0024539832957088947, "entropy": 1.1600040197372437, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 613600, "episodes_total": 470, "training_iteration": 59, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-36-54", "timestamp": 1710301014, "time_this_iter_s": 103.81973218917847, "time_total_s": 7886.275184392929, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7886.275184392929, "timesteps_since_restore": 613600, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 35.05436241610739, "ram_util_percent": 32.599999999999994}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 295053.96751624596, "episode_reward_mean": 311537.0800903163, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1419.9580233097076}, "policy_reward_mean": {"shared_policy": 1104.9373296340354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.79812061886005, "mean_processing_ms": 3.2991927006649, "mean_inference_ms": 0.8200997083782079}, "off_policy_estimator": {}, "info": {"num_steps_trained": 30318720, "num_steps_sampled": 624000, "sample_time_ms": 99252.638, "load_time_ms": 55.571, "grad_time_ms": 5981.118, "update_time_ms": 4.038, "learner": {"shared_policy": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 27270.119140625, "policy_loss": -0.00024463952286168933, "vf_loss": 27270.130859375, "vf_explained_var": 0.16065244376659393, "kl": 0.0017331130802631378, "entropy": 1.156783938407898, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 624000, "episodes_total": 478, "training_iteration": 60, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-38-42", "timestamp": 1710301122, "time_this_iter_s": 107.89795517921448, "time_total_s": 7994.173139572144, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7994.173139572144, "timesteps_since_restore": 624000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 34.703896103896106, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 295053.96751624596, "episode_reward_mean": 311889.2639966355, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -145.68101373687387}, "policy_reward_max": {"shared_policy": 1419.9580233097076}, "policy_reward_mean": {"shared_policy": 1106.1864302061908}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.619443223385424, "mean_processing_ms": 3.2914563287080774, "mean_inference_ms": 0.8195636563121375}, "off_policy_estimator": {}, "info": {"num_steps_trained": 30723840, "num_steps_sampled": 634400, "sample_time_ms": 98897.144, "load_time_ms": 55.654, "grad_time_ms": 5952.454, "update_time_ms": 3.986, "learner": {"shared_policy": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 27818.05078125, "policy_loss": -0.0002965223684441298, "vf_loss": 27818.0625, "vf_explained_var": 0.1783929169178009, "kl": 0.0015957894502207637, "entropy": 1.1380963325500488, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 634400, "episodes_total": 486, "training_iteration": 61, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-40-26", "timestamp": 1710301226, "time_this_iter_s": 103.82823967933655, "time_total_s": 8098.00137925148, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8098.00137925148, "timesteps_since_restore": 634400, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 35.03243243243244, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 295053.96751624596, "episode_reward_mean": 312988.7094424069, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.4510807991027832}, "policy_reward_max": {"shared_policy": 1420.2038371562958}, "policy_reward_mean": {"shared_policy": 1110.0858643107179}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.441384445141594, "mean_processing_ms": 3.283686718883879, "mean_inference_ms": 0.8190304885593023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 31112704, "num_steps_sampled": 644800, "sample_time_ms": 98591.597, "load_time_ms": 54.966, "grad_time_ms": 5930.22, "update_time_ms": 4.08, "learner": {"shared_policy": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 29903.02734375, "policy_loss": 3.923586518794764e-06, "vf_loss": 29903.0390625, "vf_explained_var": 0.14393512904644012, "kl": 0.0016419895691797137, "entropy": 1.1299395561218262, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 644800, "episodes_total": 494, "training_iteration": 62, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-42-08", "timestamp": 1710301328, "time_this_iter_s": 102.2884509563446, "time_total_s": 8200.289830207825, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8200.289830207825, "timesteps_since_restore": 644800, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 35.08424657534246, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 300920.29055183707, "episode_reward_mean": 314151.84490255377, "episode_len_mean": 1300.0, "episodes_this_iter": 9, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1430.537133216858}, "policy_reward_mean": {"shared_policy": 1114.2111895816768}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.23799338042336, "mean_processing_ms": 3.2752503653360963, "mean_inference_ms": 0.8185200695398328}, "off_policy_estimator": {}, "info": {"num_steps_trained": 31512576, "num_steps_sampled": 655200, "sample_time_ms": 98994.596, "load_time_ms": 55.565, "grad_time_ms": 5972.322, "update_time_ms": 4.162, "learner": {"shared_policy": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 28530.814453125, "policy_loss": -0.0005205891793593764, "vf_loss": 28530.826171875, "vf_explained_var": 0.15934060513973236, "kl": 0.003905054647475481, "entropy": 1.1203001737594604, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 655200, "episodes_total": 503, "training_iteration": 63, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-43-55", "timestamp": 1710301435, "time_this_iter_s": 106.54440641403198, "time_total_s": 8306.834236621857, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8306.834236621857, "timesteps_since_restore": 655200, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 35.473684210526315, "ram_util_percent": 32.598684210526315}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 300920.29055183707, "episode_reward_mean": 314746.11025455594, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1438.6252295970917}, "policy_reward_mean": {"shared_policy": 1116.318887230204}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.07100902084222, "mean_processing_ms": 3.2681631164426763, "mean_inference_ms": 0.8180488602487559}, "off_policy_estimator": {}, "info": {"num_steps_trained": 31906176, "num_steps_sampled": 665600, "sample_time_ms": 98828.087, "load_time_ms": 57.069, "grad_time_ms": 5983.056, "update_time_ms": 4.201, "learner": {"shared_policy": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 29424.7890625, "policy_loss": 6.0577935073524714e-05, "vf_loss": 29424.798828125, "vf_explained_var": 0.15382784605026245, "kl": 0.0012878809357061982, "entropy": 1.1236395835876465, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 665600, "episodes_total": 511, "training_iteration": 64, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-45-40", "timestamp": 1710301540, "time_this_iter_s": 104.58972191810608, "time_total_s": 8411.423958539963, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8411.423958539963, "timesteps_since_restore": 665600, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 35.21466666666667, "ram_util_percent": 32.599333333333334}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 300920.29055183707, "episode_reward_mean": 315574.88058666943, "episode_len_mean": 1300.0, "episodes_this_iter": 7, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1438.6252295970917}, "policy_reward_mean": {"shared_policy": 1119.2186146498418}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.92676732237452, "mean_processing_ms": 3.2618375545958265, "mean_inference_ms": 0.8176548151069938}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32284032, "num_steps_sampled": 676000, "sample_time_ms": 98030.352, "load_time_ms": 56.485, "grad_time_ms": 5924.774, "update_time_ms": 4.226, "learner": {"shared_policy": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 31018.23828125, "policy_loss": -0.00025514946901239455, "vf_loss": 31018.25, "vf_explained_var": 0.09619318693876266, "kl": 0.003056808141991496, "entropy": 1.1047743558883667, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 676000, "episodes_total": 518, "training_iteration": 65, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-47-19", "timestamp": 1710301639, "time_this_iter_s": 99.33427882194519, "time_total_s": 8510.758237361908, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8510.758237361908, "timesteps_since_restore": 676000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.168309859154924, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 300920.29055183707, "episode_reward_mean": 315843.26660566643, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1438.6252295970917}, "policy_reward_mean": {"shared_policy": 1120.0513018393078}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.77680314291124, "mean_processing_ms": 3.254865058116124, "mean_inference_ms": 0.8171347954182763}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32677504, "num_steps_sampled": 686400, "sample_time_ms": 98042.137, "load_time_ms": 56.23, "grad_time_ms": 5927.638, "update_time_ms": 4.326, "learner": {"shared_policy": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 29698.8515625, "policy_loss": -0.00032561717671342194, "vf_loss": 29698.86328125, "vf_explained_var": 0.13034823536872864, "kl": 0.0034724094439297915, "entropy": 1.1034387350082397, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 686400, "episodes_total": 526, "training_iteration": 66, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-49-03", "timestamp": 1710301743, "time_this_iter_s": 104.40018486976624, "time_total_s": 8615.158422231674, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8615.158422231674, "timesteps_since_restore": 686400, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 35.09060402684564, "ram_util_percent": 32.599999999999994}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 300920.29055183707, "episode_reward_mean": 316665.8712055886, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1438.6252295970917}, "policy_reward_mean": {"shared_policy": 1122.968442872402}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.62101819769887, "mean_processing_ms": 3.2478216767418395, "mean_inference_ms": 0.8167120766604481}, "off_policy_estimator": {}, "info": {"num_steps_trained": 33077632, "num_steps_sampled": 696800, "sample_time_ms": 98198.39, "load_time_ms": 56.995, "grad_time_ms": 5966.908, "update_time_ms": 4.229, "learner": {"shared_policy": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 29131.693359375, "policy_loss": -0.00048381119268015027, "vf_loss": 29131.705078125, "vf_explained_var": 0.12996532022953033, "kl": 0.004574630409479141, "entropy": 1.1048179864883423, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 696800, "episodes_total": 534, "training_iteration": 67, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-50-50", "timestamp": 1710301850, "time_this_iter_s": 106.99468564987183, "time_total_s": 8722.153107881546, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8722.153107881546, "timesteps_since_restore": 696800, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 35.435526315789474, "ram_util_percent": 32.596710526315796}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 300920.29055183707, "episode_reward_mean": 317263.23491281184, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1438.6252295970917}, "policy_reward_mean": {"shared_policy": 1125.1267285368174}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.470845914348956, "mean_processing_ms": 3.241011216731504, "mean_inference_ms": 0.8163195590574768}, "off_policy_estimator": {}, "info": {"num_steps_trained": 33489408, "num_steps_sampled": 707200, "sample_time_ms": 98794.748, "load_time_ms": 58.165, "grad_time_ms": 6002.054, "update_time_ms": 4.303, "learner": {"shared_policy": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 28078.1953125, "policy_loss": -0.00036485810414887965, "vf_loss": 28078.205078125, "vf_explained_var": 0.14323307573795319, "kl": 0.003493773750960827, "entropy": 1.109447717666626, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 707200, "episodes_total": 542, "training_iteration": 68, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-52-40", "timestamp": 1710301960, "time_this_iter_s": 109.44236207008362, "time_total_s": 8831.59546995163, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8831.59546995163, "timesteps_since_restore": 707200, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 35.44615384615385, "ram_util_percent": 32.59935897435897}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 335056.32496779785, "episode_reward_min": 301619.8704327382, "episode_reward_mean": 317293.448928264, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1438.6252295970917}, "policy_reward_mean": {"shared_policy": 1125.1939747092592}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.326991156610376, "mean_processing_ms": 3.2345326432366015, "mean_inference_ms": 0.8159512605706203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 33903488, "num_steps_sampled": 717600, "sample_time_ms": 99349.357, "load_time_ms": 58.937, "grad_time_ms": 6046.411, "update_time_ms": 4.117, "learner": {"shared_policy": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 27938.1484375, "policy_loss": -2.9405816803773632e-06, "vf_loss": 27938.158203125, "vf_explained_var": 0.1665242463350296, "kl": 0.0017246626084670424, "entropy": 1.1116522550582886, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 717600, "episodes_total": 550, "training_iteration": 69, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-54-30", "timestamp": 1710302070, "time_this_iter_s": 109.82184076309204, "time_total_s": 8941.417310714722, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8941.417310714722, "timesteps_since_restore": 717600, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 35.48089171974522, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334883.0210675574, "episode_reward_min": 301619.8704327382, "episode_reward_mean": 317807.62937539304, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1127.0173742877162}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.18784123980061, "mean_processing_ms": 3.228289688192011, "mean_inference_ms": 0.8155955925362072}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34294272, "num_steps_sampled": 728000, "sample_time_ms": 98771.445, "load_time_ms": 59.377, "grad_time_ms": 6026.481, "update_time_ms": 4.161, "learner": {"shared_policy": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 30573.474609375, "policy_loss": 7.279849523911253e-05, "vf_loss": 30573.486328125, "vf_explained_var": 0.181064173579216, "kl": 0.0008843223913572729, "entropy": 1.108665943145752, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 728000, "episodes_total": 558, "training_iteration": 70, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-56-12", "timestamp": 1710302172, "time_this_iter_s": 101.92676377296448, "time_total_s": 9043.344074487686, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9043.344074487686, "timesteps_since_restore": 728000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 35.147260273972606, "ram_util_percent": 32.58698630136986}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334883.0210675574, "episode_reward_min": 303301.2405450288, "episode_reward_mean": 317967.8046752925, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1127.5853919475603}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.04613286861658, "mean_processing_ms": 3.22217707603621, "mean_inference_ms": 0.8153380005706313}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34706560, "num_steps_sampled": 738400, "sample_time_ms": 99110.34, "load_time_ms": 59.038, "grad_time_ms": 6057.173, "update_time_ms": 4.186, "learner": {"shared_policy": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 28072.509765625, "policy_loss": -0.0001347544603049755, "vf_loss": 28072.5234375, "vf_explained_var": 0.15190452337265015, "kl": 0.002607285976409912, "entropy": 1.1006091833114624, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 738400, "episodes_total": 566, "training_iteration": 71, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-57-59", "timestamp": 1710302279, "time_this_iter_s": 107.52536940574646, "time_total_s": 9150.869443893433, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9150.869443893433, "timesteps_since_restore": 738400, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 35.430065359477126, "ram_util_percent": 32.59803921568628}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 342094.8468568316, "episode_reward_min": 303301.2405450288, "episode_reward_mean": 318495.4171306733, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1129.4564244500632}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.917882540407284, "mean_processing_ms": 3.2166230115586347, "mean_inference_ms": 0.8150288829431364}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35102976, "num_steps_sampled": 748800, "sample_time_ms": 99297.414, "load_time_ms": 59.15, "grad_time_ms": 6078.587, "update_time_ms": 4.185, "learner": {"shared_policy": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 29692.279296875, "policy_loss": -5.651128594763577e-05, "vf_loss": 29692.291015625, "vf_explained_var": 0.15943185985088348, "kl": 0.001225415151566267, "entropy": 1.097744107246399, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 748800, "episodes_total": 574, "training_iteration": 72, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-12_23-59-44", "timestamp": 1710302384, "time_this_iter_s": 104.37527585029602, "time_total_s": 9255.244719743729, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9255.244719743729, "timesteps_since_restore": 748800, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 34.94429530201342, "ram_util_percent": 32.59798657718121}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 342094.8468568316, "episode_reward_min": 304006.2245063061, "episode_reward_mean": 318774.79251686356, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1130.447152441092}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.7942977240148, "mean_processing_ms": 3.211299878896358, "mean_inference_ms": 0.8147543426972796}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35512960, "num_steps_sampled": 759200, "sample_time_ms": 99652.47, "load_time_ms": 60.697, "grad_time_ms": 6098.175, "update_time_ms": 4.089, "learner": {"shared_policy": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 28776.265625, "policy_loss": -0.0001714106765575707, "vf_loss": 28776.27734375, "vf_explained_var": 0.15082888305187225, "kl": 0.003000787226483226, "entropy": 1.1099839210510254, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 759200, "episodes_total": 582, "training_iteration": 73, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-01-34", "timestamp": 1710302494, "time_this_iter_s": 110.3170874118805, "time_total_s": 9365.56180715561, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9365.56180715561, "timesteps_since_restore": 759200, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 35.367721518987345, "ram_util_percent": 32.5993670886076}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 342094.8468568316, "episode_reward_min": 304006.2245063061, "episode_reward_mean": 318824.6386910066, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1130.6239181921576}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.676591335009434, "mean_processing_ms": 3.206260336387286, "mean_inference_ms": 0.8145083754425432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35922816, "num_steps_sampled": 769600, "sample_time_ms": 100032.756, "load_time_ms": 59.894, "grad_time_ms": 6122.008, "update_time_ms": 3.97, "learner": {"shared_policy": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 28747.388671875, "policy_loss": -0.00031588540878146887, "vf_loss": 28747.400390625, "vf_explained_var": 0.15203067660331726, "kl": 0.0033365872222930193, "entropy": 1.09433114528656, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 769600, "episodes_total": 590, "training_iteration": 74, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-03-23", "timestamp": 1710302603, "time_this_iter_s": 108.61625647544861, "time_total_s": 9474.178063631058, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9474.178063631058, "timesteps_since_restore": 769600, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 35.39677419354839, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 342094.8468568316, "episode_reward_min": 304006.2245063061, "episode_reward_mean": 318898.96494230186, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.505400657653809}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1130.9276010436975}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.564381726160946, "mean_processing_ms": 3.2014421309168934, "mean_inference_ms": 0.8142831545405417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 36334208, "num_steps_sampled": 780000, "sample_time_ms": 100975.802, "load_time_ms": 60.679, "grad_time_ms": 6186.413, "update_time_ms": 3.891, "learner": {"shared_policy": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 28788.87890625, "policy_loss": -0.0003960377653129399, "vf_loss": 28788.890625, "vf_explained_var": 0.15409554541110992, "kl": 0.0034833308309316635, "entropy": 1.0892478227615356, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 780000, "episodes_total": 598, "training_iteration": 75, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-05-12", "timestamp": 1710302712, "time_this_iter_s": 109.41696405410767, "time_total_s": 9583.595027685165, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9583.595027685165, "timesteps_since_restore": 780000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 35.0198717948718, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 319526.18329435954, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.505400657653809}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1133.1519373514416}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.46251253766974, "mean_processing_ms": 3.196803041379349, "mean_inference_ms": 0.8139770390409676}, "off_policy_estimator": {}, "info": {"num_steps_trained": 36725888, "num_steps_sampled": 790400, "sample_time_ms": 100835.996, "load_time_ms": 60.704, "grad_time_ms": 6176.542, "update_time_ms": 3.692, "learner": {"shared_policy": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 30537.626953125, "policy_loss": -0.0001576306385686621, "vf_loss": 30537.638671875, "vf_explained_var": 0.10724011808633804, "kl": 0.0013428269885480404, "entropy": 1.070333480834961, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 790400, "episodes_total": 606, "training_iteration": 76, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-06-55", "timestamp": 1710302815, "time_this_iter_s": 102.89814448356628, "time_total_s": 9686.493172168732, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9686.493172168732, "timesteps_since_restore": 790400, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 35.43809523809524, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 319681.2311789643, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.174060821533203}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1133.7017915418269}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.35535527006873, "mean_processing_ms": 3.192054511668078, "mean_inference_ms": 0.8137396757503629}, "off_policy_estimator": {}, "info": {"num_steps_trained": 37118208, "num_steps_sampled": 800800, "sample_time_ms": 100546.305, "load_time_ms": 60.149, "grad_time_ms": 6155.198, "update_time_ms": 3.695, "learner": {"shared_policy": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 30319.171875, "policy_loss": -0.00012518161383923143, "vf_loss": 30319.18359375, "vf_explained_var": 0.10372007638216019, "kl": 0.0029146564193069935, "entropy": 1.0702284574508667, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 800800, "episodes_total": 614, "training_iteration": 77, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-08-39", "timestamp": 1710302919, "time_this_iter_s": 103.8582398891449, "time_total_s": 9790.351412057877, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9790.351412057877, "timesteps_since_restore": 800800, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 35.0304054054054, "ram_util_percent": 32.59932432432433}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 319843.90081524896, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.174060821533203}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1134.3591318458252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.25171980055511, "mean_processing_ms": 3.187395514909611, "mean_inference_ms": 0.813510788650074}, "off_policy_estimator": {}, "info": {"num_steps_trained": 37515520, "num_steps_sampled": 811200, "sample_time_ms": 99953.618, "load_time_ms": 58.748, "grad_time_ms": 6123.649, "update_time_ms": 3.633, "learner": {"shared_policy": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 30464.248046875, "policy_loss": -0.0002583145978860557, "vf_loss": 30464.2578125, "vf_explained_var": 0.10874874144792557, "kl": 0.003134516067802906, "entropy": 1.0625454187393188, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 811200, "episodes_total": 622, "training_iteration": 78, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-10-22", "timestamp": 1710303022, "time_this_iter_s": 103.18030381202698, "time_total_s": 9893.531715869904, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9893.531715869904, "timesteps_since_restore": 811200, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 35.54489795918368, "ram_util_percent": 32.59863945578231}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 320158.2428369679, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1135.4739780003117}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.15110129388829, "mean_processing_ms": 3.1831054136500314, "mean_inference_ms": 0.8132771553909179}, "off_policy_estimator": {}, "info": {"num_steps_trained": 37906560, "num_steps_sampled": 821600, "sample_time_ms": 99179.92, "load_time_ms": 58.158, "grad_time_ms": 6090.864, "update_time_ms": 3.684, "learner": {"shared_policy": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 31291.748046875, "policy_loss": 5.362127558328211e-05, "vf_loss": 31291.7578125, "vf_explained_var": 0.10738047957420349, "kl": 0.0015435641398653388, "entropy": 1.0600184202194214, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 821600, "episodes_total": 630, "training_iteration": 79, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-12-04", "timestamp": 1710303124, "time_this_iter_s": 101.74738454818726, "time_total_s": 9995.27910041809, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9995.27910041809, "timesteps_since_restore": 821600, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 35.702739726027396, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 320705.07782260963, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1137.4537252087591}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.05220283449161, "mean_processing_ms": 3.178866767078711, "mean_inference_ms": 0.8130535452012674}, "off_policy_estimator": {}, "info": {"num_steps_trained": 38296704, "num_steps_sampled": 832000, "sample_time_ms": 99560.745, "load_time_ms": 59.141, "grad_time_ms": 6098.349, "update_time_ms": 3.678, "learner": {"shared_policy": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 31391.302734375, "policy_loss": -0.00016476045129820704, "vf_loss": 31391.3125, "vf_explained_var": 0.11311958730220795, "kl": 0.0025691038463264704, "entropy": 1.0588868856430054, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 832000, "episodes_total": 638, "training_iteration": 80, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-13-50", "timestamp": 1710303230, "time_this_iter_s": 105.82130455970764, "time_total_s": 10101.100404977798, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10101.100404977798, "timesteps_since_restore": 832000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 35.317880794701985, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 321859.9986355675, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1141.5094291231644}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.95311577573454, "mean_processing_ms": 3.1746209720622693, "mean_inference_ms": 0.8128375320060193}, "off_policy_estimator": {}, "info": {"num_steps_trained": 38681216, "num_steps_sampled": 842400, "sample_time_ms": 99128.889, "load_time_ms": 59.173, "grad_time_ms": 6062.115, "update_time_ms": 3.743, "learner": {"shared_policy": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 32237.83984375, "policy_loss": -1.2431814866431523e-05, "vf_loss": 32237.84765625, "vf_explained_var": 0.11170662939548492, "kl": 0.0017052701441571116, "entropy": 1.053400993347168, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 842400, "episodes_total": 646, "training_iteration": 81, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-15-33", "timestamp": 1710303333, "time_this_iter_s": 102.86105918884277, "time_total_s": 10203.961464166641, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10203.961464166641, "timesteps_since_restore": 842400, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 35.672108843537416, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 322274.25066213676, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1440.0555386543274}, "policy_reward_mean": {"shared_policy": 1142.9786163361355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.85635751235883, "mean_processing_ms": 3.170465960999633, "mean_inference_ms": 0.8126280813357427}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39072256, "num_steps_sampled": 852800, "sample_time_ms": 99228.197, "load_time_ms": 59.633, "grad_time_ms": 6062.464, "update_time_ms": 3.732, "learner": {"shared_policy": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 31797.517578125, "policy_loss": -5.61322012799792e-05, "vf_loss": 31797.525390625, "vf_explained_var": 0.12101957947015762, "kl": 0.0018569803796708584, "entropy": 1.055448293685913, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 852800, "episodes_total": 654, "training_iteration": 82, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-17-19", "timestamp": 1710303439, "time_this_iter_s": 105.38226366043091, "time_total_s": 10309.343727827072, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10309.343727827072, "timesteps_since_restore": 852800, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 35.346, "ram_util_percent": 32.6}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 322581.3214663279, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1434.3642871379852}, "policy_reward_mean": {"shared_policy": 1144.067674373414}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.76254963677287, "mean_processing_ms": 3.166425040888795, "mean_inference_ms": 0.8124255860177021}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39476352, "num_steps_sampled": 863200, "sample_time_ms": 98956.584, "load_time_ms": 58.887, "grad_time_ms": 6047.207, "update_time_ms": 3.743, "learner": {"shared_policy": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 30076.2578125, "policy_loss": 8.996480028145015e-05, "vf_loss": 30076.265625, "vf_explained_var": 0.1273230016231537, "kl": 0.000683088437654078, "entropy": 1.0601109266281128, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 863200, "episodes_total": 662, "training_iteration": 83, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-19-06", "timestamp": 1710303546, "time_this_iter_s": 107.43323469161987, "time_total_s": 10416.776962518692, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10416.776962518692, "timesteps_since_restore": 863200, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 35.31176470588236, "ram_util_percent": 32.600653594771245}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 322261.5010376536, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1434.3642871379852}, "policy_reward_mean": {"shared_policy": 1142.9333984879188}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.67254102328155, "mean_processing_ms": 3.162564677517816, "mean_inference_ms": 0.8122358081968865}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39902720, "num_steps_sampled": 873600, "sample_time_ms": 99243.341, "load_time_ms": 59.713, "grad_time_ms": 6070.429, "update_time_ms": 3.776, "learner": {"shared_policy": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 28897.650390625, "policy_loss": -0.00011262064072070643, "vf_loss": 28897.662109375, "vf_explained_var": 0.15204989910125732, "kl": 0.0015757891815155745, "entropy": 1.078188419342041, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 873600, "episodes_total": 670, "training_iteration": 84, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-20-58", "timestamp": 1710303658, "time_this_iter_s": 111.73925876617432, "time_total_s": 10528.516221284866, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10528.516221284866, "timesteps_since_restore": 873600, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 35.5675, "ram_util_percent": 32.600625}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 304510.8219748796, "episode_reward_mean": 322125.4841950373, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1434.3642871379852}, "policy_reward_mean": {"shared_policy": 1142.4510008335837}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.58626102995473, "mean_processing_ms": 3.15888952977351, "mean_inference_ms": 0.8120515922771241}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40319360, "num_steps_sampled": 884000, "sample_time_ms": 99329.755, "load_time_ms": 60.398, "grad_time_ms": 6081.612, "update_time_ms": 3.783, "learner": {"shared_policy": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 28698.4609375, "policy_loss": 9.620487981010228e-05, "vf_loss": 28698.474609375, "vf_explained_var": 0.13815276324748993, "kl": 0.0014058242086321115, "entropy": 1.0893136262893677, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 884000, "episodes_total": 678, "training_iteration": 85, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-22-48", "timestamp": 1710303768, "time_this_iter_s": 110.40242576599121, "time_total_s": 10638.918647050858, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10638.918647050858, "timesteps_since_restore": 884000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 35.50254777070064, "ram_util_percent": 32.60063694267516}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 322378.49422916106, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.3214738368988}, "policy_reward_mean": {"shared_policy": 1143.388878273315}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.50033129551479, "mean_processing_ms": 3.1552141658198267, "mean_inference_ms": 0.8118696301722708}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40709760, "num_steps_sampled": 894400, "sample_time_ms": 99381.867, "load_time_ms": 61.42, "grad_time_ms": 6087.055, "update_time_ms": 3.83, "learner": {"shared_policy": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 32319.65625, "policy_loss": 5.712210258934647e-05, "vf_loss": 32319.669921875, "vf_explained_var": 0.1314561516046524, "kl": 0.0011804610257968307, "entropy": 1.0659419298171997, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 894400, "episodes_total": 686, "training_iteration": 86, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-24-32", "timestamp": 1710303872, "time_this_iter_s": 103.4868323802948, "time_total_s": 10742.405479431152, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10742.405479431152, "timesteps_since_restore": 894400, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 35.358783783783785, "ram_util_percent": 32.600675675675674}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 323554.28042767936, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.3214738368988}, "policy_reward_mean": {"shared_policy": 1147.5183729170071}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.414188365428, "mean_processing_ms": 3.1515198202264254, "mean_inference_ms": 0.8116881618487861}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41093760, "num_steps_sampled": 904800, "sample_time_ms": 99327.776, "load_time_ms": 62.409, "grad_time_ms": 6073.471, "update_time_ms": 3.936, "learner": {"shared_policy": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 32718.125, "policy_loss": 3.7708282434323337e-06, "vf_loss": 32718.1328125, "vf_explained_var": 0.10274204611778259, "kl": 0.00209278822876513, "entropy": 1.0680903196334839, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 904800, "episodes_total": 694, "training_iteration": 87, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-26-15", "timestamp": 1710303975, "time_this_iter_s": 103.19408178329468, "time_total_s": 10845.599561214447, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10845.599561214447, "timesteps_since_restore": 904800, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.975, "ram_util_percent": 32.619594594594595}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 347315.5897759702, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 323538.88028512493, "episode_len_mean": 1300.0, "episodes_this_iter": 9, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.3214738368988}, "policy_reward_mean": {"shared_policy": 1147.4637547351572}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.314012639838104, "mean_processing_ms": 3.147598773688957, "mean_inference_ms": 0.8114975586235187}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41497984, "num_steps_sampled": 915200, "sample_time_ms": 99943.986, "load_time_ms": 62.527, "grad_time_ms": 6045.639, "update_time_ms": 3.958, "learner": {"shared_policy": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 30845.703125, "policy_loss": -0.0003201831423211843, "vf_loss": 30845.708984375, "vf_explained_var": 0.14082077145576477, "kl": 0.0016733655938878655, "entropy": 1.0603293180465698, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 915200, "episodes_total": 703, "training_iteration": 88, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-28-04", "timestamp": 1710304084, "time_this_iter_s": 109.07462882995605, "time_total_s": 10954.674190044403, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10954.674190044403, "timesteps_since_restore": 915200, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 34.29741935483871, "ram_util_percent": 32.6916129032258}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 346849.94034349173, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 323007.4990846506, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.3214738368988}, "policy_reward_mean": {"shared_policy": 1145.579156918182}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.23508605905112, "mean_processing_ms": 3.1443248210260175, "mean_inference_ms": 0.8113390667667454}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41908480, "num_steps_sampled": 925600, "sample_time_ms": 100467.518, "load_time_ms": 63.098, "grad_time_ms": 6060.845, "update_time_ms": 3.881, "learner": {"shared_policy": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 30158.67578125, "policy_loss": -3.202235893695615e-05, "vf_loss": 30158.6875, "vf_explained_var": 0.12816333770751953, "kl": 0.001833187765441835, "entropy": 1.0499980449676514, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 925600, "episodes_total": 711, "training_iteration": 89, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-29-51", "timestamp": 1710304191, "time_this_iter_s": 107.14285922050476, "time_total_s": 11061.817049264908, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11061.817049264908, "timesteps_since_restore": 925600, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 35.36143790849674, "ram_util_percent": 32.69999999999999}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 346849.94034349173, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 322415.67950085143, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.3214738368988}, "policy_reward_mean": {"shared_policy": 1143.399104549441}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.16026234253101, "mean_processing_ms": 3.141236303499629, "mean_inference_ms": 0.8111959123397793}, "off_policy_estimator": {}, "info": {"num_steps_trained": 42331392, "num_steps_sampled": 936000, "sample_time_ms": 100971.306, "load_time_ms": 62.986, "grad_time_ms": 6107.759, "update_time_ms": 3.943, "learner": {"shared_policy": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 29610.939453125, "policy_loss": -0.00018739498045761138, "vf_loss": 29610.94921875, "vf_explained_var": 0.13934636116027832, "kl": 0.002911236369982362, "entropy": 1.0592960119247437, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 936000, "episodes_total": 719, "training_iteration": 90, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-31-43", "timestamp": 1710304303, "time_this_iter_s": 111.32949566841125, "time_total_s": 11173.14654493332, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11173.14654493332, "timesteps_since_restore": 936000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 35.37735849056604, "ram_util_percent": 32.69999999999998}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 322778.87684999494, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.3214738368988}, "policy_reward_mean": {"shared_policy": 1144.6871297609578}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.08715245986896, "mean_processing_ms": 3.138207545899179, "mean_inference_ms": 0.8110619902839469}, "off_policy_estimator": {}, "info": {"num_steps_trained": 42723328, "num_steps_sampled": 946400, "sample_time_ms": 101153.646, "load_time_ms": 63.373, "grad_time_ms": 6117.957, "update_time_ms": 3.927, "learner": {"shared_policy": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 32225.640625, "policy_loss": 7.95589221525006e-05, "vf_loss": 32225.650390625, "vf_explained_var": 0.09971830248832703, "kl": 0.0013825243804603815, "entropy": 1.0695289373397827, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 946400, "episodes_total": 727, "training_iteration": 91, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-33-28", "timestamp": 1710304408, "time_this_iter_s": 104.77587080001831, "time_total_s": 11277.922415733337, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11277.922415733337, "timesteps_since_restore": 946400, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 35.318666666666665, "ram_util_percent": 32.700666666666656}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 322141.9042755252, "episode_len_mean": 1300.0, "episodes_this_iter": 7, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.5565135478973}, "policy_reward_mean": {"shared_policy": 1142.3876884837237}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.02499344799062, "mean_processing_ms": 3.135357027204015, "mean_inference_ms": 0.8109545818875629}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43138944, "num_steps_sampled": 956800, "sample_time_ms": 101456.452, "load_time_ms": 64.744, "grad_time_ms": 6152.225, "update_time_ms": 3.879, "learner": {"shared_policy": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 30646.763671875, "policy_loss": 4.1979514207923785e-05, "vf_loss": 30646.775390625, "vf_explained_var": 0.14347940683364868, "kl": 0.0021889053750783205, "entropy": 1.0818161964416504, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 956800, "episodes_total": 734, "training_iteration": 92, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-35-16", "timestamp": 1710304516, "time_this_iter_s": 108.77470707893372, "time_total_s": 11386.697122812271, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11386.697122812271, "timesteps_since_restore": 956800, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 35.450322580645164, "ram_util_percent": 32.70903225806451}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 301589.5555198019, "episode_reward_mean": 321141.290504807, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.5565135478973}, "policy_reward_mean": {"shared_policy": 1138.8392868711908}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.958206272006215, "mean_processing_ms": 3.1324571480510315, "mean_inference_ms": 0.810821785197684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43555584, "num_steps_sampled": 967200, "sample_time_ms": 101738.126, "load_time_ms": 64.98, "grad_time_ms": 6165.822, "update_time_ms": 3.955, "learner": {"shared_policy": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 30201.439453125, "policy_loss": -0.00021840291447006166, "vf_loss": 30201.44921875, "vf_explained_var": 0.15909293293952942, "kl": 0.0024956711567938328, "entropy": 1.0726139545440674, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 967200, "episodes_total": 742, "training_iteration": 93, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-37-07", "timestamp": 1710304627, "time_this_iter_s": 110.38935208320618, "time_total_s": 11497.086474895477, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11497.086474895477, "timesteps_since_restore": 967200, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 35.37278481012658, "ram_util_percent": 32.79177215189875}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 300421.9488913031, "episode_reward_mean": 320053.55784691236, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.5565135478973}, "policy_reward_mean": {"shared_policy": 1134.9819420791955}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.89654951097512, "mean_processing_ms": 3.129810805162979, "mean_inference_ms": 0.8106962280020491}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43997312, "num_steps_sampled": 977600, "sample_time_ms": 102207.76, "load_time_ms": 66.493, "grad_time_ms": 6189.671, "update_time_ms": 3.909, "learner": {"shared_policy": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 28637.345703125, "policy_loss": -0.000249525677645579, "vf_loss": 28637.357421875, "vf_explained_var": 0.1776488572359085, "kl": 0.0032718367874622345, "entropy": 1.0794434547424316, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 977600, "episodes_total": 750, "training_iteration": 94, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-39-04", "timestamp": 1710304744, "time_this_iter_s": 116.68969678878784, "time_total_s": 11613.776171684265, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11613.776171684265, "timesteps_since_restore": 977600, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 35.681927710843375, "ram_util_percent": 32.80000000000001}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 318889.4793255071, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.5565135478973}, "policy_reward_mean": {"shared_policy": 1130.8538576740564}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.839263413081255, "mean_processing_ms": 3.1273874665531816, "mean_inference_ms": 0.8105814835214832}, "off_policy_estimator": {}, "info": {"num_steps_trained": 44442880, "num_steps_sampled": 988000, "sample_time_ms": 102806.814, "load_time_ms": 66.35, "grad_time_ms": 6236.722, "update_time_ms": 3.986, "learner": {"shared_policy": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 28322.25390625, "policy_loss": 0.00015256289043463767, "vf_loss": 28322.265625, "vf_explained_var": 0.1910974234342575, "kl": 0.000834201870020479, "entropy": 1.0942503213882446, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 988000, "episodes_total": 758, "training_iteration": 95, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-41-01", "timestamp": 1710304861, "time_this_iter_s": 116.87263703346252, "time_total_s": 11730.648808717728, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11730.648808717728, "timesteps_since_restore": 988000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 35.59640718562874, "ram_util_percent": 32.80059880239522}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 318136.55638935545, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1441.5565135478973}, "policy_reward_mean": {"shared_policy": 1128.1838235020941}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.78459026724002, "mean_processing_ms": 3.1250761836735363, "mean_inference_ms": 0.8104670430669847}, "off_policy_estimator": {}, "info": {"num_steps_trained": 44871296, "num_steps_sampled": 998400, "sample_time_ms": 103785.761, "load_time_ms": 66.182, "grad_time_ms": 6274.139, "update_time_ms": 4.091, "learner": {"shared_policy": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 30117.380859375, "policy_loss": -0.00016929114644881338, "vf_loss": 30117.392578125, "vf_explained_var": 0.20738936960697174, "kl": 0.0017339802579954267, "entropy": 1.0727311372756958, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 998400, "episodes_total": 766, "training_iteration": 96, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-42-54", "timestamp": 1710304974, "time_this_iter_s": 113.65490531921387, "time_total_s": 11844.303714036942, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11844.303714036942, "timesteps_since_restore": 998400, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 35.303703703703704, "ram_util_percent": 32.80061728395062}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 318230.59049319854, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.47482705116272}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1128.5172895960802}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.73029484705612, "mean_processing_ms": 3.1227769071729012, "mean_inference_ms": 0.8103511563714032}, "off_policy_estimator": {}, "info": {"num_steps_trained": 45282560, "num_steps_sampled": 1008800, "sample_time_ms": 104329.672, "load_time_ms": 65.69, "grad_time_ms": 6279.038, "update_time_ms": 4.009, "learner": {"shared_policy": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 30643.123046875, "policy_loss": -5.1896295190090314e-05, "vf_loss": 30643.1328125, "vf_explained_var": 0.15429505705833435, "kl": 0.0022410890087485313, "entropy": 1.0740910768508911, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1008800, "episodes_total": 774, "training_iteration": 97, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-44-43", "timestamp": 1710305083, "time_this_iter_s": 108.68234992027283, "time_total_s": 11952.986063957214, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11952.986063957214, "timesteps_since_restore": 1008800, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 35.05096774193548, "ram_util_percent": 32.80064516129033}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 318052.6978578595, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.47482705116272}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1127.9264410875226}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.677419962175094, "mean_processing_ms": 3.1205340156255557, "mean_inference_ms": 0.8102432197503469}, "off_policy_estimator": {}, "info": {"num_steps_trained": 45691520, "num_steps_sampled": 1019200, "sample_time_ms": 104205.305, "load_time_ms": 65.836, "grad_time_ms": 6284.187, "update_time_ms": 4.058, "learner": {"shared_policy": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 31164.2734375, "policy_loss": 7.527243724325672e-05, "vf_loss": 31164.2890625, "vf_explained_var": 0.1525234878063202, "kl": 0.0014867475256323814, "entropy": 1.0856974124908447, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1019200, "episodes_total": 782, "training_iteration": 98, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-46-31", "timestamp": 1710305191, "time_this_iter_s": 107.87628722190857, "time_total_s": 12060.862351179123, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12060.862351179123, "timesteps_since_restore": 1019200, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 35.31623376623377, "ram_util_percent": 32.80779220779221}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 317617.67685355444, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1126.343759897707}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.62735657820907, "mean_processing_ms": 3.1184362317916303, "mean_inference_ms": 0.810145456807062}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46096768, "num_steps_sampled": 1029600, "sample_time_ms": 104397.11, "load_time_ms": 66.864, "grad_time_ms": 6270.13, "update_time_ms": 4.041, "learner": {"shared_policy": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 31097.642578125, "policy_loss": 1.7913247575052083e-05, "vf_loss": 31097.65234375, "vf_explained_var": 0.11998716741800308, "kl": 0.0013305777683854103, "entropy": 1.0796271562576294, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1029600, "episodes_total": 790, "training_iteration": 99, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-48-20", "timestamp": 1710305300, "time_this_iter_s": 108.93389821052551, "time_total_s": 12169.796249389648, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12169.796249389648, "timesteps_since_restore": 1029600, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 35.18525641025641, "ram_util_percent": 32.87564102564103}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 317017.7085729723, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1124.2161373558363}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.58752494676433, "mean_processing_ms": 3.116679371887567, "mean_inference_ms": 0.8100384834564109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46510080, "num_steps_sampled": 1040000, "sample_time_ms": 104253.438, "load_time_ms": 67.49, "grad_time_ms": 6244.156, "update_time_ms": 3.975, "learner": {"shared_policy": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 30906.34375, "policy_loss": 0.00012622709618881345, "vf_loss": 30906.353515625, "vf_explained_var": 0.12891170382499695, "kl": 0.001440665335394442, "entropy": 1.0847344398498535, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1040000, "episodes_total": 798, "training_iteration": 100, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-50-10", "timestamp": 1710305410, "time_this_iter_s": 109.63825488090515, "time_total_s": 12279.434504270554, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12279.434504270554, "timesteps_since_restore": 1040000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 34.917307692307695, "ram_util_percent": 32.83461538461539}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 316030.48534233455, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1120.7152216118816}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.542929005423545, "mean_processing_ms": 3.114711944072683, "mean_inference_ms": 0.8099569119260694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46953984, "num_steps_sampled": 1050400, "sample_time_ms": 105374.38, "load_time_ms": 68.126, "grad_time_ms": 6321.184, "update_time_ms": 3.96, "learner": {"shared_policy": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 29464.216796875, "policy_loss": -0.00012646896357182413, "vf_loss": 29464.228515625, "vf_explained_var": 0.19669395685195923, "kl": 0.0016348849749192595, "entropy": 1.0982774496078491, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1050400, "episodes_total": 806, "training_iteration": 101, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-52-07", "timestamp": 1710305527, "time_this_iter_s": 116.7659854888916, "time_total_s": 12396.200489759445, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12396.200489759445, "timesteps_since_restore": 1050400, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 35.25209580838324, "ram_util_percent": 32.87125748502994}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 315530.67773556744, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1118.9427913598618}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.500405876117995, "mean_processing_ms": 3.112866216311147, "mean_inference_ms": 0.8098772545016496}, "off_policy_estimator": {}, "info": {"num_steps_trained": 47385856, "num_steps_sampled": 1060800, "sample_time_ms": 105916.176, "load_time_ms": 68.393, "grad_time_ms": 6337.287, "update_time_ms": 4.019, "learner": {"shared_policy": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 29784.056640625, "policy_loss": 0.00015719971270300448, "vf_loss": 29784.0703125, "vf_explained_var": 0.17855244874954224, "kl": 0.0005886080325581133, "entropy": 1.1090091466903687, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1060800, "episodes_total": 814, "training_iteration": 102, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-54-01", "timestamp": 1710305641, "time_this_iter_s": 114.34852981567383, "time_total_s": 12510.549019575119, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12510.549019575119, "timesteps_since_restore": 1060800, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 35.24756097560975, "ram_util_percent": 32.88109756097561}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 353345.382268697, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 314572.0271935002, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1115.5432007996747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.45978611024838, "mean_processing_ms": 3.1110981005571485, "mean_inference_ms": 0.8097963544684145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 47814272, "num_steps_sampled": 1071200, "sample_time_ms": 105931.456, "load_time_ms": 68.261, "grad_time_ms": 6365.852, "update_time_ms": 3.945, "learner": {"shared_policy": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 30260.58984375, "policy_loss": -0.0002541419817134738, "vf_loss": 30260.599609375, "vf_explained_var": 0.18704693019390106, "kl": 0.001613561064004898, "entropy": 1.0938959121704102, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1071200, "episodes_total": 822, "training_iteration": 103, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-55-52", "timestamp": 1710305752, "time_this_iter_s": 110.82810068130493, "time_total_s": 12621.377120256424, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12621.377120256424, "timesteps_since_restore": 1071200, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 35.13164556962025, "ram_util_percent": 32.868987341772154}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334549.75056511513, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 313599.5312577966, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1112.0945113578377}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.422298069154515, "mean_processing_ms": 3.1095752643032197, "mean_inference_ms": 0.8097198032244315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48242432, "num_steps_sampled": 1081600, "sample_time_ms": 105554.606, "load_time_ms": 67.168, "grad_time_ms": 6344.075, "update_time_ms": 4.036, "learner": {"shared_policy": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 30784.646484375, "policy_loss": 1.0942237167910207e-05, "vf_loss": 30784.65625, "vf_explained_var": 0.1964855045080185, "kl": 0.0018170295516029, "entropy": 1.0992491245269775, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1081600, "episodes_total": 830, "training_iteration": 104, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-57-45", "timestamp": 1710305865, "time_this_iter_s": 112.67981553077698, "time_total_s": 12734.056935787201, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12734.056935787201, "timesteps_since_restore": 1081600, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 35.48944099378882, "ram_util_percent": 32.9}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334549.75056511513, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 312750.72282811766, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1109.084445647426}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.387707555012774, "mean_processing_ms": 3.1082523308308083, "mean_inference_ms": 0.8096472572471248}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48684928, "num_steps_sampled": 1092000, "sample_time_ms": 105685.873, "load_time_ms": 66.969, "grad_time_ms": 6338.797, "update_time_ms": 3.867, "learner": {"shared_policy": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 29455.623046875, "policy_loss": 0.00016150041483342648, "vf_loss": 29455.634765625, "vf_explained_var": 0.1888001561164856, "kl": 0.0014005337143316865, "entropy": 1.11480712890625, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1092000, "episodes_total": 838, "training_iteration": 105, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_00-59-43", "timestamp": 1710305983, "time_this_iter_s": 118.12111973762512, "time_total_s": 12852.178055524826, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12852.178055524826, "timesteps_since_restore": 1092000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 35.141071428571436, "ram_util_percent": 32.89999999999999}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334549.75056511513, "episode_reward_min": 292379.0213675038, "episode_reward_mean": 312254.37837207835, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1107.3635661113497}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.35351750601418, "mean_processing_ms": 3.106947713697293, "mean_inference_ms": 0.8095710363243375}, "off_policy_estimator": {}, "info": {"num_steps_trained": 49120256, "num_steps_sampled": 1102400, "sample_time_ms": 105723.684, "load_time_ms": 67.954, "grad_time_ms": 6369.043, "update_time_ms": 3.802, "learner": {"shared_policy": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 30330.326171875, "policy_loss": -7.552618626505136e-05, "vf_loss": 30330.3359375, "vf_explained_var": 0.1841406226158142, "kl": 0.001612766645848751, "entropy": 1.111548662185669, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1102400, "episodes_total": 846, "training_iteration": 106, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-01-38", "timestamp": 1710306098, "time_this_iter_s": 114.34537744522095, "time_total_s": 12966.523432970047, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12966.523432970047, "timesteps_since_restore": 1102400, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 34.869512195121956, "ram_util_percent": 32.90121951219512}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334549.75056511513, "episode_reward_min": 289742.77198344615, "episode_reward_mean": 312396.69194257766, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1107.8682599566555}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.31912068655943, "mean_processing_ms": 3.1056277600006235, "mean_inference_ms": 0.809488730638089}, "off_policy_estimator": {}, "info": {"num_steps_trained": 49553152, "num_steps_sampled": 1112800, "sample_time_ms": 106266.62, "load_time_ms": 68.757, "grad_time_ms": 6451.431, "update_time_ms": 3.797, "learner": {"shared_policy": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 30411.037109375, "policy_loss": -0.00039875941001810133, "vf_loss": 30411.046875, "vf_explained_var": 0.17980632185935974, "kl": 0.0038502211682498455, "entropy": 1.112329363822937, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1112800, "episodes_total": 854, "training_iteration": 107, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-03-33", "timestamp": 1710306213, "time_this_iter_s": 114.95089483261108, "time_total_s": 13081.474327802658, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13081.474327802658, "timesteps_since_restore": 1112800, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 35.37560975609756, "ram_util_percent": 32.9}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334549.75056511513, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 312512.5586888522, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1108.2791640855808}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.284019036242825, "mean_processing_ms": 3.1042590887963217, "mean_inference_ms": 0.8094060448638377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 49977728, "num_steps_sampled": 1123200, "sample_time_ms": 106437.169, "load_time_ms": 70.474, "grad_time_ms": 6448.274, "update_time_ms": 3.787, "learner": {"shared_policy": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 31043.111328125, "policy_loss": -0.00010211722110398114, "vf_loss": 31043.12109375, "vf_explained_var": 0.1854308396577835, "kl": 0.001505579799413681, "entropy": 1.1208833456039429, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1123200, "episodes_total": 862, "training_iteration": 108, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-05-22", "timestamp": 1710306322, "time_this_iter_s": 109.57082295417786, "time_total_s": 13191.045150756836, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13191.045150756836, "timesteps_since_restore": 1123200, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 35.328205128205134, "ram_util_percent": 32.901923076923076}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 334549.75056511513, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 312603.42196360877, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1447.2605543136597}, "policy_reward_mean": {"shared_policy": 1108.601397133161}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.249943446751956, "mean_processing_ms": 3.1029179634220285, "mean_inference_ms": 0.8093242748910053}, "off_policy_estimator": {}, "info": {"num_steps_trained": 50398080, "num_steps_sampled": 1133600, "sample_time_ms": 106648.432, "load_time_ms": 69.494, "grad_time_ms": 6474.223, "update_time_ms": 3.797, "learner": {"shared_policy": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 31046.572265625, "policy_loss": 3.445573020144366e-05, "vf_loss": 31046.58203125, "vf_explained_var": 0.13789869844913483, "kl": 0.000775427557528019, "entropy": 1.1147631406784058, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1133600, "episodes_total": 870, "training_iteration": 109, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-07-14", "timestamp": 1710306434, "time_this_iter_s": 111.30250811576843, "time_total_s": 13302.347658872604, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13302.347658872604, "timesteps_since_restore": 1133600, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 34.52955974842767, "ram_util_percent": 32.90062893081761}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 331379.7439566939, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 311676.7515437344, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1105.3150987436497}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.21789923544846, "mean_processing_ms": 3.1016802420881957, "mean_inference_ms": 0.8092400824206336}, "off_policy_estimator": {}, "info": {"num_steps_trained": 50821120, "num_steps_sampled": 1144000, "sample_time_ms": 106714.622, "load_time_ms": 69.182, "grad_time_ms": 6510.089, "update_time_ms": 3.837, "learner": {"shared_policy": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 31908.9140625, "policy_loss": -4.058353079017252e-05, "vf_loss": 31908.92578125, "vf_explained_var": 0.19275467097759247, "kl": 0.001460957806557417, "entropy": 1.1274149417877197, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1144000, "episodes_total": 878, "training_iteration": 110, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-09-04", "timestamp": 1710306544, "time_this_iter_s": 110.65878510475159, "time_total_s": 13413.006443977356, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13413.006443977356, "timesteps_since_restore": 1144000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 35.356962025316456, "ram_util_percent": 32.90126582278481}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 331379.7439566939, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 311296.1938862022, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1103.9263586871953}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.186873231949214, "mean_processing_ms": 3.1004788618207555, "mean_inference_ms": 0.8091565632079724}, "off_policy_estimator": {}, "info": {"num_steps_trained": 51241344, "num_steps_sampled": 1154400, "sample_time_ms": 106189.882, "load_time_ms": 69.932, "grad_time_ms": 6477.022, "update_time_ms": 3.871, "learner": {"shared_policy": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 32189.875, "policy_loss": -7.2643956627871376e-06, "vf_loss": 32189.884765625, "vf_explained_var": 0.17623011767864227, "kl": 0.001247668289579451, "entropy": 1.1393589973449707, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1154400, "episodes_total": 886, "training_iteration": 111, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-10-56", "timestamp": 1710306656, "time_this_iter_s": 111.19040250778198, "time_total_s": 13524.196846485138, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13524.196846485138, "timesteps_since_restore": 1154400, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 35.47735849056604, "ram_util_percent": 32.900000000000006}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 329825.7895553722, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 310042.6165828284, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.909090280532837}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1099.4808914600817}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.158504171879486, "mean_processing_ms": 3.0993971051918856, "mean_inference_ms": 0.8090686725706278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 51676032, "num_steps_sampled": 1164800, "sample_time_ms": 106233.401, "load_time_ms": 68.23, "grad_time_ms": 6471.324, "update_time_ms": 3.87, "learner": {"shared_policy": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 31026.091796875, "policy_loss": 3.757949889404699e-05, "vf_loss": 31026.10546875, "vf_explained_var": 0.1954176425933838, "kl": 0.0015656162286177278, "entropy": 1.1355717182159424, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1164800, "episodes_total": 894, "training_iteration": 112, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-12-50", "timestamp": 1710306770, "time_this_iter_s": 114.71045064926147, "time_total_s": 13638.9072971344, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13638.9072971344, "timesteps_since_restore": 1164800, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 35.38957055214724, "ram_util_percent": 32.902453987730055}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 329825.7895553722, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 309941.8674304531, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.909090280532837}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1099.1236122928228}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.129293083993495, "mean_processing_ms": 3.098243589221621, "mean_inference_ms": 0.8089741515452183}, "off_policy_estimator": {}, "info": {"num_steps_trained": 52091008, "num_steps_sampled": 1175200, "sample_time_ms": 106004.332, "load_time_ms": 67.669, "grad_time_ms": 6431.353, "update_time_ms": 3.859, "learner": {"shared_policy": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 32749.09375, "policy_loss": -0.0002484270080458373, "vf_loss": 32749.103515625, "vf_explained_var": 0.163651242852211, "kl": 0.001400364562869072, "entropy": 1.1093698740005493, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1175200, "episodes_total": 902, "training_iteration": 113, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-14-39", "timestamp": 1710306879, "time_this_iter_s": 108.1250171661377, "time_total_s": 13747.032314300537, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13747.032314300537, "timesteps_since_restore": 1175200, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 35.52903225806452, "ram_util_percent": 32.905806451612904}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 310550.8442517351, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.909090280532837}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1101.283181147328}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.09932039683457, "mean_processing_ms": 3.0970612249634963, "mean_inference_ms": 0.8088713901604287}, "off_policy_estimator": {}, "info": {"num_steps_trained": 52507520, "num_steps_sampled": 1185600, "sample_time_ms": 105525.192, "load_time_ms": 66.22, "grad_time_ms": 6393.844, "update_time_ms": 3.868, "learner": {"shared_policy": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 32554.974609375, "policy_loss": 0.00014240593009162694, "vf_loss": 32554.984375, "vf_explained_var": 0.19623340666294098, "kl": 0.000683556601870805, "entropy": 1.1174839735031128, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1185600, "episodes_total": 910, "training_iteration": 114, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-16-26", "timestamp": 1710306986, "time_this_iter_s": 107.49733686447144, "time_total_s": 13854.529651165009, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13854.529651165009, "timesteps_since_restore": 1185600, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 35.37712418300654, "ram_util_percent": 32.947712418300654}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 310846.41471445025, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.909090280532837}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1102.3313405243105}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.06880896612471, "mean_processing_ms": 3.0958560209529993, "mean_inference_ms": 0.808762252323207}, "off_policy_estimator": {}, "info": {"num_steps_trained": 52927872, "num_steps_sampled": 1196000, "sample_time_ms": 104733.845, "load_time_ms": 65.484, "grad_time_ms": 6349.739, "update_time_ms": 3.922, "learner": {"shared_policy": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 32325.81640625, "policy_loss": -1.2644497473957017e-05, "vf_loss": 32325.826171875, "vf_explained_var": 0.18222123384475708, "kl": 0.0012212087167426944, "entropy": 1.1350196599960327, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1196000, "episodes_total": 918, "training_iteration": 115, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-18-16", "timestamp": 1710307096, "time_this_iter_s": 109.75577807426453, "time_total_s": 13964.285429239273, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13964.285429239273, "timesteps_since_restore": 1196000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 35.14713375796178, "ram_util_percent": 33.0}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 310713.26645198895, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 6.757327079772949}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1101.8591668214794}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.03837403584607, "mean_processing_ms": 3.0946381927825963, "mean_inference_ms": 0.8086439692863954}, "off_policy_estimator": {}, "info": {"num_steps_trained": 53354240, "num_steps_sampled": 1206400, "sample_time_ms": 104203.642, "load_time_ms": 63.959, "grad_time_ms": 6326.356, "update_time_ms": 3.837, "learner": {"shared_policy": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 31551.08203125, "policy_loss": -9.894206596072763e-05, "vf_loss": 31551.091796875, "vf_explained_var": 0.1860702931880951, "kl": 0.0014610884245485067, "entropy": 1.1273716688156128, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1206400, "episodes_total": 926, "training_iteration": 116, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-20-05", "timestamp": 1710307205, "time_this_iter_s": 108.79086422920227, "time_total_s": 14073.076293468475, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14073.076293468475, "timesteps_since_restore": 1206400, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 35.49741935483871, "ram_util_percent": 32.99935483870968}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 289527.84328450606, "episode_reward_mean": 310769.90202787524, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 6.757327079772949}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1102.0600093190367}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.00699407223512, "mean_processing_ms": 3.093367708761365, "mean_inference_ms": 0.8085129299870902}, "off_policy_estimator": {}, "info": {"num_steps_trained": 53771648, "num_steps_sampled": 1216800, "sample_time_ms": 103746.359, "load_time_ms": 63.583, "grad_time_ms": 6292.335, "update_time_ms": 3.92, "learner": {"shared_policy": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 32979.89453125, "policy_loss": -1.8015591194853187e-05, "vf_loss": 32979.91015625, "vf_explained_var": 0.21037034690380096, "kl": 0.0022270309273153543, "entropy": 1.1487449407577515, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1216800, "episodes_total": 934, "training_iteration": 117, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-21-55", "timestamp": 1710307315, "time_this_iter_s": 110.02719688415527, "time_total_s": 14183.10349035263, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14183.10349035263, "timesteps_since_restore": 1216800, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 35.11910828025478, "ram_util_percent": 33.0}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 287624.7374978564, "episode_reward_mean": 310353.13794204366, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 6.757327079772949}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1100.5430423476726}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.97596836204326, "mean_processing_ms": 3.0920652866663216, "mean_inference_ms": 0.8083774799957972}, "off_policy_estimator": {}, "info": {"num_steps_trained": 54221568, "num_steps_sampled": 1227200, "sample_time_ms": 104535.913, "load_time_ms": 62.867, "grad_time_ms": 6402.353, "update_time_ms": 4.064, "learner": {"shared_policy": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 29659.798828125, "policy_loss": -0.0003018820134457201, "vf_loss": 29659.8125, "vf_explained_var": 0.2215837836265564, "kl": 0.00350151676684618, "entropy": 1.178003191947937, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1227200, "episodes_total": 942, "training_iteration": 118, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-23-54", "timestamp": 1710307434, "time_this_iter_s": 118.56147408485413, "time_total_s": 14301.664964437485, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14301.664964437485, "timesteps_since_restore": 1227200, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 34.80764705882353, "ram_util_percent": 33.00058823529412}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 268764.643413782, "episode_reward_mean": 308234.5301961216, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 6.757327079772949}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1093.0302489224168}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.94895422645065, "mean_processing_ms": 3.0909646940736675, "mean_inference_ms": 0.8082452808570253}, "off_policy_estimator": {}, "info": {"num_steps_trained": 54714368, "num_steps_sampled": 1237600, "sample_time_ms": 105852.731, "load_time_ms": 64.908, "grad_time_ms": 6505.435, "update_time_ms": 4.094, "learner": {"shared_policy": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 28362.947265625, "policy_loss": 9.340886754216626e-05, "vf_loss": 28362.958984375, "vf_explained_var": 0.3269372582435608, "kl": 0.0007404719945043325, "entropy": 1.1799982786178589, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1237600, "episodes_total": 950, "training_iteration": 119, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-25-59", "timestamp": 1710307559, "time_this_iter_s": 125.52346777915955, "time_total_s": 14427.188432216644, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14427.188432216644, "timesteps_since_restore": 1237600, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 35.15251396648044, "ram_util_percent": 33.014525139664805}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 258779.603716122, "episode_reward_mean": 305107.6135617758, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -73.2610227689147}, "policy_reward_max": {"shared_policy": 1437.533843278885}, "policy_reward_mean": {"shared_policy": 1081.9418920630346}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.926007844572034, "mean_processing_ms": 3.0900327094783266, "mean_inference_ms": 0.8081158409466351}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55220480, "num_steps_sampled": 1248000, "sample_time_ms": 107688.674, "load_time_ms": 65.954, "grad_time_ms": 6606.687, "update_time_ms": 4.024, "learner": {"shared_policy": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 27799.3046875, "policy_loss": -0.00041082047391682863, "vf_loss": 27799.31640625, "vf_explained_var": 0.35568374395370483, "kl": 0.0035267816856503487, "entropy": 1.1778032779693604, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1248000, "episodes_total": 958, "training_iteration": 120, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-28-09", "timestamp": 1710307689, "time_this_iter_s": 130.05262660980225, "time_total_s": 14557.241058826447, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14557.241058826447, "timesteps_since_restore": 1248000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 35.342473118279564, "ram_util_percent": 33.05268817204302}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 237553.45223652862, "episode_reward_mean": 300941.4124713255, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -73.2610227689147}, "policy_reward_max": {"shared_policy": 1428.433262348175}, "policy_reward_mean": {"shared_policy": 1067.1681293309414}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.91001291367179, "mean_processing_ms": 3.089424116807245, "mean_inference_ms": 0.8079969386328191}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55768320, "num_steps_sampled": 1258400, "sample_time_ms": 110478.983, "load_time_ms": 68.315, "grad_time_ms": 6802.074, "update_time_ms": 4.041, "learner": {"shared_policy": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 26022.015625, "policy_loss": -0.00015215361781883985, "vf_loss": 26022.02734375, "vf_explained_var": 0.3561081290245056, "kl": 0.003002986777573824, "entropy": 1.2052408456802368, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1258400, "episodes_total": 966, "training_iteration": 121, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-30-31", "timestamp": 1710307831, "time_this_iter_s": 141.0830364227295, "time_total_s": 14698.324095249176, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14698.324095249176, "timesteps_since_restore": 1258400, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 35.67064676616915, "ram_util_percent": 33.0905472636816}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 186049.01152437102, "episode_reward_mean": 293155.9198879044, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -456.3290084525943}, "policy_reward_max": {"shared_policy": 1428.433262348175}, "policy_reward_mean": {"shared_policy": 1039.5599996024978}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.90547482871431, "mean_processing_ms": 3.0893329763383908, "mean_inference_ms": 0.8078913733494738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56408960, "num_steps_sampled": 1268800, "sample_time_ms": 114776.532, "load_time_ms": 76.679, "grad_time_ms": 7118.38, "update_time_ms": 4.086, "learner": {"shared_policy": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 23692.712890625, "policy_loss": -0.0004800795577466488, "vf_loss": 23692.724609375, "vf_explained_var": 0.46773236989974976, "kl": 0.004397663753479719, "entropy": 1.2110754251480103, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1268800, "episodes_total": 974, "training_iteration": 122, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-33-12", "timestamp": 1710307992, "time_this_iter_s": 160.96448802947998, "time_total_s": 14859.288583278656, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14859.288583278656, "timesteps_since_restore": 1268800, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 34.82086956521739, "ram_util_percent": 33.12869565217391}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 135377.45428203058, "episode_reward_mean": 280420.5611146748, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1428.433262348175}, "policy_reward_mean": {"shared_policy": 994.3991528889176}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.9184749274551, "mean_processing_ms": 3.090044827027863, "mean_inference_ms": 0.8078123537919046}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57150720, "num_steps_sampled": 1279200, "sample_time_ms": 122164.402, "load_time_ms": 86.844, "grad_time_ms": 7561.676, "update_time_ms": 4.067, "learner": {"shared_policy": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 21498.44140625, "policy_loss": -0.0006102482439018786, "vf_loss": 21498.453125, "vf_explained_var": 0.5920370817184448, "kl": 0.004171997308731079, "entropy": 1.1702464818954468, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1279200, "episodes_total": 982, "training_iteration": 123, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-36-18", "timestamp": 1710308178, "time_this_iter_s": 186.5786190032959, "time_total_s": 15045.867202281952, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15045.867202281952, "timesteps_since_restore": 1279200, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 35.61616541353384, "ram_util_percent": 33.23082706766917}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 265150.0479236251, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1428.433262348175}, "policy_reward_mean": {"shared_policy": 940.2483968922875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.9518359029612, "mean_processing_ms": 3.0916318976010384, "mean_inference_ms": 0.8077616145598877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57966592, "num_steps_sampled": 1289600, "sample_time_ms": 131302.511, "load_time_ms": 96.116, "grad_time_ms": 8165.147, "update_time_ms": 4.123, "learner": {"shared_policy": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 19342.15234375, "policy_loss": -0.0001440202904632315, "vf_loss": 19342.166015625, "vf_explained_var": 0.6698996424674988, "kl": 0.002808417659252882, "entropy": 1.1605029106140137, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1289600, "episodes_total": 990, "training_iteration": 124, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-39-43", "timestamp": 1710308383, "time_this_iter_s": 205.05457592010498, "time_total_s": 15250.921778202057, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15250.921778202057, "timesteps_since_restore": 1289600, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 35.40511945392492, "ram_util_percent": 33.34607508532424}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 330847.60418924154, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 250751.9907587171, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1428.433262348175}, "policy_reward_mean": {"shared_policy": 889.1914565911953}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.005095140753994, "mean_processing_ms": 3.0941101611155957, "mean_inference_ms": 0.8077455458455103}, "off_policy_estimator": {}, "info": {"num_steps_trained": 58753920, "num_steps_sampled": 1300000, "sample_time_ms": 140232.237, "load_time_ms": 105.241, "grad_time_ms": 8705.888, "update_time_ms": 4.362, "learner": {"shared_policy": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 19841.8046875, "policy_loss": -0.00019766943296417594, "vf_loss": 19841.81640625, "vf_explained_var": 0.6477271914482117, "kl": 0.0013625759165734053, "entropy": 1.1526349782943726, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1300000, "episodes_total": 998, "training_iteration": 125, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-43-08", "timestamp": 1710308588, "time_this_iter_s": 204.6098484992981, "time_total_s": 15455.531626701355, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15455.531626701355, "timesteps_since_restore": 1300000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 35.21335616438356, "ram_util_percent": 33.34349315068493}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326571.9845411461, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 236139.45729902823, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1428.433262348175}, "policy_reward_mean": {"shared_policy": 837.3739620532916}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.078026950876136, "mean_processing_ms": 3.097437350331049, "mean_inference_ms": 0.8077598377656823}, "off_policy_estimator": {}, "info": {"num_steps_trained": 59542784, "num_steps_sampled": 1310400, "sample_time_ms": 148663.596, "load_time_ms": 113.232, "grad_time_ms": 9240.19, "update_time_ms": 4.374, "learner": {"shared_policy": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 18456.068359375, "policy_loss": -0.00040996482130140066, "vf_loss": 18456.080078125, "vf_explained_var": 0.6734931468963623, "kl": 0.002542695729061961, "entropy": 1.1256202459335327, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1310400, "episodes_total": 1006, "training_iteration": 126, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-46-27", "timestamp": 1710308787, "time_this_iter_s": 198.5793812274933, "time_total_s": 15654.111007928848, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15654.111007928848, "timesteps_since_restore": 1310400, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 35.20989399293287, "ram_util_percent": 33.53886925795053}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326571.9845411461, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 220900.4974755299, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1424.2182352542877}, "policy_reward_mean": {"shared_policy": 783.3350974309571}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.17154311693703, "mean_processing_ms": 3.1016635914319726, "mean_inference_ms": 0.8078125907494589}, "off_policy_estimator": {}, "info": {"num_steps_trained": 60361088, "num_steps_sampled": 1320800, "sample_time_ms": 157670.113, "load_time_ms": 121.115, "grad_time_ms": 9842.674, "update_time_ms": 4.389, "learner": {"shared_policy": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 17319.548828125, "policy_loss": -0.0003863090241793543, "vf_loss": 17319.560546875, "vf_explained_var": 0.6980679631233215, "kl": 0.002198777860030532, "entropy": 1.0955610275268555, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1320800, "episodes_total": 1014, "training_iteration": 127, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-49-53", "timestamp": 1710308993, "time_this_iter_s": 206.24735164642334, "time_total_s": 15860.358359575272, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15860.358359575272, "timesteps_since_restore": 1320800, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 35.355932203389834, "ram_util_percent": 33.51559322033898}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 326571.9845411461, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 207777.56136421039, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1424.2182352542877}, "policy_reward_mean": {"shared_policy": 736.7998629936541}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.28186099390889, "mean_processing_ms": 3.106614149295352, "mean_inference_ms": 0.8078982316765806}, "off_policy_estimator": {}, "info": {"num_steps_trained": 61123584, "num_steps_sampled": 1331200, "sample_time_ms": 164629.049, "load_time_ms": 127.84, "grad_time_ms": 10305.966, "update_time_ms": 4.225, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17593.4140625, "policy_loss": -0.0001533111499156803, "vf_loss": 17593.42578125, "vf_explained_var": 0.6701085567474365, "kl": 0.0014613581588491797, "entropy": 1.0985013246536255, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1331200, "episodes_total": 1022, "training_iteration": 128, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-53-06", "timestamp": 1710309186, "time_this_iter_s": 192.8903534412384, "time_total_s": 16053.24871301651, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16053.24871301651, "timesteps_since_restore": 1331200, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 35.572, "ram_util_percent": 33.59927272727273}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 317005.84013135894, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 196055.9863487948, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1424.2182352542877}, "policy_reward_mean": {"shared_policy": 695.2586487066735}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.40770496238107, "mean_processing_ms": 3.1122939464112314, "mean_inference_ms": 0.8080147368438759}, "off_policy_estimator": {}, "info": {"num_steps_trained": 61844480, "num_steps_sampled": 1341600, "sample_time_ms": 170002.853, "load_time_ms": 131.565, "grad_time_ms": 10633.802, "update_time_ms": 4.179, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17621.283203125, "policy_loss": -0.00046001627924852073, "vf_loss": 17621.294921875, "vf_explained_var": 0.6387010216712952, "kl": 0.002920823637396097, "entropy": 1.094924807548523, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1341600, "episodes_total": 1030, "training_iteration": 129, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-56-09", "timestamp": 1710309369, "time_this_iter_s": 182.5996458530426, "time_total_s": 16235.848358869553, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16235.848358869553, "timesteps_since_restore": 1341600, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 35.57586206896551, "ram_util_percent": 33.61532567049809}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 315261.09807727253, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 185788.4915561608, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 658.8711665939455}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.54714878017489, "mean_processing_ms": 3.1185963540249917, "mean_inference_ms": 0.8081582476738731}, "off_policy_estimator": {}, "info": {"num_steps_trained": 62563840, "num_steps_sampled": 1352000, "sample_time_ms": 174837.252, "load_time_ms": 135.743, "grad_time_ms": 10954.681, "update_time_ms": 4.163, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17646.5078125, "policy_loss": -0.00016280145791824907, "vf_loss": 17646.51953125, "vf_explained_var": 0.6471970081329346, "kl": 0.001597713679075241, "entropy": 1.0712971687316895, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1352000, "episodes_total": 1038, "training_iteration": 130, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_01-59-10", "timestamp": 1710309550, "time_this_iter_s": 181.66301894187927, "time_total_s": 16417.511377811432, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16417.511377811432, "timesteps_since_restore": 1352000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 34.933976833976836, "ram_util_percent": 33.61389961389961}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 293595.8570705261, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 176585.62673098885, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 626.256788775362}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.699001526854694, "mean_processing_ms": 3.125436175204629, "mean_inference_ms": 0.8083214977069797}, "off_policy_estimator": {}, "info": {"num_steps_trained": 63302272, "num_steps_sampled": 1362400, "sample_time_ms": 179586.924, "load_time_ms": 138.38, "grad_time_ms": 11225.968, "update_time_ms": 4.102, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16691.10546875, "policy_loss": -0.00038019701605662704, "vf_loss": 16691.115234375, "vf_explained_var": 0.6518481969833374, "kl": 0.0029250055085867643, "entropy": 1.077278971672058, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1362400, "episodes_total": 1046, "training_iteration": 131, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-02-22", "timestamp": 1710309742, "time_this_iter_s": 191.3441321849823, "time_total_s": 16608.855509996414, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16608.855509996414, "timesteps_since_restore": 1362400, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 34.906959706959704, "ram_util_percent": 33.648717948717945}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 290317.21450903674, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 168469.40262464443, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 597.4727901005228}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.861661193533536, "mean_processing_ms": 3.1327361266958746, "mean_inference_ms": 0.808503447681299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 64042496, "num_steps_sampled": 1372800, "sample_time_ms": 181841.126, "load_time_ms": 136.406, "grad_time_ms": 11369.222, "update_time_ms": 4.056, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16502.78125, "policy_loss": -0.00027743304963223636, "vf_loss": 16502.79296875, "vf_explained_var": 0.6519633531570435, "kl": 0.0022994542960077524, "entropy": 1.0584925413131714, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1372800, "episodes_total": 1054, "training_iteration": 132, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-05-27", "timestamp": 1710309927, "time_this_iter_s": 184.9205105304718, "time_total_s": 16793.776020526886, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16793.776020526886, "timesteps_since_restore": 1372800, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 35.31856060606061, "ram_util_percent": 33.637121212121215}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 274335.23569019494, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 159411.05343880452, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 565.3475669000409}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.03609988207486, "mean_processing_ms": 3.1405805030770386, "mean_inference_ms": 0.8087152341314373}, "off_policy_estimator": {}, "info": {"num_steps_trained": 64810240, "num_steps_sampled": 1383200, "sample_time_ms": 182741.179, "load_time_ms": 134.995, "grad_time_ms": 11395.549, "update_time_ms": 4.093, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15288.71484375, "policy_loss": -0.0005076037487015128, "vf_loss": 15288.7255859375, "vf_explained_var": 0.6846615076065063, "kl": 0.0022146424744278193, "entropy": 1.0425180196762085, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1383200, "episodes_total": 1062, "training_iteration": 133, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-08-43", "timestamp": 1710310123, "time_this_iter_s": 195.84122514724731, "time_total_s": 16989.617245674133, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16989.617245674133, "timesteps_since_restore": 1383200, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 35.39928571428571, "ram_util_percent": 33.698928571428574}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 226940.2672873977, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 153250.04358145167, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1156.3090042956173}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 543.4976897593775}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.217134380060955, "mean_processing_ms": 3.148702402777883, "mean_inference_ms": 0.8089478825906532}, "off_policy_estimator": {}, "info": {"num_steps_trained": 65569024, "num_steps_sampled": 1393600, "sample_time_ms": 181434.824, "load_time_ms": 133.301, "grad_time_ms": 11312.849, "update_time_ms": 3.998, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14217.8662109375, "policy_loss": -0.0004049137351103127, "vf_loss": 14217.87890625, "vf_explained_var": 0.6524085998535156, "kl": 0.0020864256657660007, "entropy": 1.0450574159622192, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1393600, "episodes_total": 1070, "training_iteration": 134, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-11-54", "timestamp": 1710310314, "time_this_iter_s": 191.1538951396942, "time_total_s": 17180.771140813828, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17180.771140813828, "timesteps_since_restore": 1393600, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 36.15457875457876, "ram_util_percent": 33.71318681318681}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 194521.25028297698, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 151373.3791970977, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 536.8802241429249}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.3998529514656, "mean_processing_ms": 3.1569116277880607, "mean_inference_ms": 0.8091890551342419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 66341504, "num_steps_sampled": 1404000, "sample_time_ms": 180599.921, "load_time_ms": 131.207, "grad_time_ms": 11294.223, "update_time_ms": 3.775, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12652.6220703125, "policy_loss": -0.0005965811433270574, "vf_loss": 12652.6328125, "vf_explained_var": 0.6217681169509888, "kl": 0.002518574008718133, "entropy": 1.0528327226638794, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1404000, "episodes_total": 1078, "training_iteration": 135, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-15-10", "timestamp": 1710310510, "time_this_iter_s": 196.0449573993683, "time_total_s": 17376.816098213196, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17376.816098213196, "timesteps_since_restore": 1404000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 35.1375, "ram_util_percent": 33.716428571428565}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 194521.25028297698, "episode_reward_min": 99340.54887341612, "episode_reward_mean": 151641.65557796575, "episode_len_mean": 1300.0, "episodes_this_iter": 9, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 539.1128255758168}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.59823718763043, "mean_processing_ms": 3.16616477263666, "mean_inference_ms": 0.809487266870937}, "off_policy_estimator": {}, "info": {"num_steps_trained": 67161344, "num_steps_sampled": 1414400, "sample_time_ms": 182455.191, "load_time_ms": 130.991, "grad_time_ms": 11341.89, "update_time_ms": 3.766, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 10124.9462890625, "policy_loss": -0.0007161178509704769, "vf_loss": 10124.958984375, "vf_explained_var": 0.6111425757408142, "kl": 0.002910877810791135, "entropy": 1.0677258968353271, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1414400, "episodes_total": 1087, "training_iteration": 136, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-18-48", "timestamp": 1710310728, "time_this_iter_s": 217.6219301223755, "time_total_s": 17594.43802833557, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17594.43802833557, "timesteps_since_restore": 1414400, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 34.66548387096774, "ram_util_percent": 33.75387096774194}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 194521.25028297698, "episode_reward_min": 108500.03970063622, "episode_reward_mean": 153732.97797224435, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 547.2287686336254}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.774506574016904, "mean_processing_ms": 3.1742199514915366, "mean_inference_ms": 0.8097360170254977}, "off_policy_estimator": {}, "info": {"num_steps_trained": 67959424, "num_steps_sampled": 1424800, "sample_time_ms": 181958.862, "load_time_ms": 130.167, "grad_time_ms": 11303.179, "update_time_ms": 3.667, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 9309.5009765625, "policy_loss": -0.0003694792103487998, "vf_loss": 9309.51171875, "vf_explained_var": 0.5247311592102051, "kl": 0.0024068444035947323, "entropy": 1.07071053981781, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1424800, "episodes_total": 1095, "training_iteration": 137, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-22-09", "timestamp": 1710310929, "time_this_iter_s": 200.89180541038513, "time_total_s": 17795.329833745956, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17795.329833745956, "timesteps_since_restore": 1424800, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 35.45714285714286, "ram_util_percent": 33.80104529616725}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 194521.25028297698, "episode_reward_min": 108500.03970063622, "episode_reward_mean": 153634.7759688451, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 548.5976645914839}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.949176228223635, "mean_processing_ms": 3.1822792546720597, "mean_inference_ms": 0.8099958061162511}, "off_policy_estimator": {}, "info": {"num_steps_trained": 68775424, "num_steps_sampled": 1435200, "sample_time_ms": 182935.212, "load_time_ms": 130.628, "grad_time_ms": 11322.866, "update_time_ms": 3.653, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 7923.22021484375, "policy_loss": -0.0004284964525140822, "vf_loss": 7923.2314453125, "vf_explained_var": 0.4931999742984772, "kl": 0.003030505497008562, "entropy": 1.0617871284484863, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1435200, "episodes_total": 1103, "training_iteration": 138, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-25-32", "timestamp": 1710311132, "time_this_iter_s": 202.87610912322998, "time_total_s": 17998.205942869186, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17998.205942869186, "timesteps_since_restore": 1435200, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 35.582006920415225, "ram_util_percent": 33.909688581314875}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 194521.25028297698, "episode_reward_min": 108500.03970063622, "episode_reward_mean": 155386.8799128102, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 555.7470669270751}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.12147152779607, "mean_processing_ms": 3.1902852863624935, "mean_inference_ms": 0.8102643965078209}, "off_policy_estimator": {}, "info": {"num_steps_trained": 69603328, "num_steps_sampled": 1445600, "sample_time_ms": 185160.94, "load_time_ms": 135.859, "grad_time_ms": 11497.267, "update_time_ms": 3.705, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 7906.5341796875, "policy_loss": -0.0005261320620775223, "vf_loss": 7906.54443359375, "vf_explained_var": 0.49832844734191895, "kl": 0.003197186626493931, "entropy": 1.0339761972427368, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1445600, "episodes_total": 1111, "training_iteration": 139, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-28-59", "timestamp": 1710311339, "time_this_iter_s": 206.67270040512085, "time_total_s": 18204.878643274307, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18204.878643274307, "timesteps_since_restore": 1445600, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 35.862711864406776, "ram_util_percent": 33.74915254237288}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 194521.25028297698, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 157388.4924477122, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 563.3290112305816}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.29180396136328, "mean_processing_ms": 3.1982341958513327, "mean_inference_ms": 0.8105385027030525}, "off_policy_estimator": {}, "info": {"num_steps_trained": 70406784, "num_steps_sampled": 1456000, "sample_time_ms": 186893.773, "load_time_ms": 139.136, "grad_time_ms": 11628.796, "update_time_ms": 3.694, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 8110.638671875, "policy_loss": -0.00031001309980638325, "vf_loss": 8110.64892578125, "vf_explained_var": 0.4633968472480774, "kl": 0.00262854085303843, "entropy": 1.0138050317764282, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1456000, "episodes_total": 1119, "training_iteration": 140, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-32-19", "timestamp": 1710311539, "time_this_iter_s": 200.35574555397034, "time_total_s": 18405.234388828278, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18405.234388828278, "timesteps_since_restore": 1456000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 35.33706293706294, "ram_util_percent": 33.93251748251748}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 199766.54951247916, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 159149.73407674613, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 569.6328933632061}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.46129337776048, "mean_processing_ms": 3.2061658284406733, "mean_inference_ms": 0.8108230358603631}, "off_policy_estimator": {}, "info": {"num_steps_trained": 71170944, "num_steps_sampled": 1466400, "sample_time_ms": 187098.724, "load_time_ms": 139.947, "grad_time_ms": 11657.166, "update_time_ms": 3.884, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 9220.126953125, "policy_loss": -0.0002660788013599813, "vf_loss": 9220.13671875, "vf_explained_var": 0.4427560865879059, "kl": 0.0020278189331293106, "entropy": 0.9962245225906372, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1466400, "episodes_total": 1127, "training_iteration": 141, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-35-33", "timestamp": 1710311733, "time_this_iter_s": 193.70170640945435, "time_total_s": 18598.936095237732, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18598.936095237732, "timesteps_since_restore": 1466400, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 35.579061371841156, "ram_util_percent": 33.87148014440433}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 204716.50662167926, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 160770.6090301449, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1431.1531977653503}, "policy_reward_mean": {"shared_policy": 575.4343714168184}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.63008277842414, "mean_processing_ms": 3.2140926138485315, "mean_inference_ms": 0.8111208078844018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 71917184, "num_steps_sampled": 1476800, "sample_time_ms": 187287.106, "load_time_ms": 139.909, "grad_time_ms": 11612.174, "update_time_ms": 3.815, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 9704.4111328125, "policy_loss": -0.00022748534684069455, "vf_loss": 9704.4208984375, "vf_explained_var": 0.43154069781303406, "kl": 0.0023130832705646753, "entropy": 1.0005886554718018, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1476800, "episodes_total": 1135, "training_iteration": 142, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-38-39", "timestamp": 1710311919, "time_this_iter_s": 186.35737776756287, "time_total_s": 18785.293473005295, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18785.293473005295, "timesteps_since_restore": 1476800, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 35.45, "ram_util_percent": 33.92293233082706}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 238102.4595677558, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 164448.5646231395, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1430.1053471565247}, "policy_reward_mean": {"shared_policy": 588.5564747973926}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.79492591231584, "mean_processing_ms": 3.2218508956631218, "mean_inference_ms": 0.8114266574051254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 72604544, "num_steps_sampled": 1487200, "sample_time_ms": 185510.917, "load_time_ms": 136.823, "grad_time_ms": 11449.366, "update_time_ms": 3.768, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11905.966796875, "policy_loss": -0.0001216755699715577, "vf_loss": 11905.9765625, "vf_explained_var": 0.4069369435310364, "kl": 0.001740204868838191, "entropy": 0.9976105093955994, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1487200, "episodes_total": 1143, "training_iteration": 143, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-41-36", "timestamp": 1710312096, "time_this_iter_s": 176.4127435684204, "time_total_s": 18961.706216573715, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18961.706216573715, "timesteps_since_restore": 1487200, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 34.83730158730159, "ram_util_percent": 33.975}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 238102.4595677558, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 167869.61743991464, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1409.1551394462585}, "policy_reward_mean": {"shared_policy": 600.8003201027689}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.95632711197835, "mean_processing_ms": 3.2295080329047723, "mean_inference_ms": 0.8117443894412076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 73303424, "num_steps_sampled": 1497600, "sample_time_ms": 184371.63, "load_time_ms": 135.802, "grad_time_ms": 11311.716, "update_time_ms": 3.691, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11057.767578125, "policy_loss": -9.980511822504923e-05, "vf_loss": 11057.77734375, "vf_explained_var": 0.4027337431907654, "kl": 0.002125724218785763, "entropy": 0.9757993221282959, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1497600, "episodes_total": 1151, "training_iteration": 144, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-44-34", "timestamp": 1710312274, "time_this_iter_s": 178.36196422576904, "time_total_s": 19140.068180799484, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19140.068180799484, "timesteps_since_restore": 1497600, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 36.47598425196851, "ram_util_percent": 33.91220472440944}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 238102.4595677558, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 172572.5630484391, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1409.1551394462585}, "policy_reward_mean": {"shared_policy": 617.6320212177055}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.112692889385364, "mean_processing_ms": 3.2369639018840974, "mean_inference_ms": 0.8120570129168166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 73999488, "num_steps_sampled": 1508000, "sample_time_ms": 182634.076, "load_time_ms": 134.829, "grad_time_ms": 11168.721, "update_time_ms": 3.714, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11789.3759765625, "policy_loss": -6.660831422777846e-05, "vf_loss": 11789.384765625, "vf_explained_var": 0.38929757475852966, "kl": 0.0015333454357460141, "entropy": 0.9534754753112793, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1508000, "episodes_total": 1159, "training_iteration": 145, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-47-32", "timestamp": 1710312452, "time_this_iter_s": 177.22054529190063, "time_total_s": 19317.288726091385, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19317.288726091385, "timesteps_since_restore": 1508000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 35.384189723320155, "ram_util_percent": 34.00553359683794}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 238102.4595677558, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 176639.03043219604, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1409.1551394462585}, "policy_reward_mean": {"shared_policy": 632.1857858780861}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.26571228297984, "mean_processing_ms": 3.2442958928147743, "mean_inference_ms": 0.8123689615448293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 74728832, "num_steps_sampled": 1518400, "sample_time_ms": 179721.554, "load_time_ms": 134.766, "grad_time_ms": 11013.407, "update_time_ms": 3.811, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 10711.8291015625, "policy_loss": -2.5640583771746606e-05, "vf_loss": 10711.8388671875, "vf_explained_var": 0.4039281904697418, "kl": 0.002217299537733197, "entropy": 0.9480738043785095, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1518400, "episodes_total": 1167, "training_iteration": 146, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-50-39", "timestamp": 1710312639, "time_this_iter_s": 186.92454719543457, "time_total_s": 19504.21327328682, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19504.21327328682, "timesteps_since_restore": 1518400, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 35.86082089552239, "ram_util_percent": 34.03582089552239}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 238102.4595677558, "episode_reward_min": 123413.79684387334, "episode_reward_mean": 179290.06372207895, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1255.6913381561171}, "policy_reward_max": {"shared_policy": 1409.1551394462585}, "policy_reward_mean": {"shared_policy": 641.6507899294216}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.41781390488202, "mean_processing_ms": 3.2515981592695913, "mean_inference_ms": 0.8126926456384918}, "off_policy_estimator": {}, "info": {"num_steps_trained": 75510272, "num_steps_sampled": 1528800, "sample_time_ms": 180002.388, "load_time_ms": 136.25, "grad_time_ms": 10963.415, "update_time_ms": 3.874, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 9612.310546875, "policy_loss": -0.0002223521878477186, "vf_loss": 9612.3203125, "vf_explained_var": 0.40912961959838867, "kl": 0.002526919124647975, "entropy": 0.9214172959327698, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1528800, "episodes_total": 1175, "training_iteration": 147, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-54-02", "timestamp": 1710312842, "time_this_iter_s": 203.2172393798828, "time_total_s": 19707.430512666702, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19707.430512666702, "timesteps_since_restore": 1528800, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 35.580000000000005, "ram_util_percent": 34.178275862068965}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 238102.4595677558, "episode_reward_min": 128155.12509600128, "episode_reward_mean": 184566.00398919772, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -612.8206033371389}, "policy_reward_max": {"shared_policy": 1409.1551394462585}, "policy_reward_mean": {"shared_policy": 659.4233591382249}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.570039713502894, "mean_processing_ms": 3.258576695240297, "mean_inference_ms": 0.8129969249493718}, "off_policy_estimator": {}, "info": {"num_steps_trained": 76239872, "num_steps_sampled": 1539200, "sample_time_ms": 178491.376, "load_time_ms": 135.921, "grad_time_ms": 10860.693, "update_time_ms": 3.894, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 10703.2939453125, "policy_loss": -0.00018305280536878854, "vf_loss": 10703.3037109375, "vf_explained_var": 0.3917335569858551, "kl": 0.002349200425669551, "entropy": 0.916729211807251, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1539200, "episodes_total": 1183, "training_iteration": 148, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_02-57-09", "timestamp": 1710313029, "time_this_iter_s": 186.7198941707611, "time_total_s": 19894.150406837463, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19894.150406837463, "timesteps_since_restore": 1539200, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 35.6906015037594, "ram_util_percent": 34.19285714285715}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 238102.4595677558, "episode_reward_min": 131121.40412802584, "episode_reward_mean": 191464.95045243323, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -580.3977527674288}, "policy_reward_max": {"shared_policy": 1408.8560020923615}, "policy_reward_mean": {"shared_policy": 683.2421598416773}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.71298073585338, "mean_processing_ms": 3.265388225567753, "mean_inference_ms": 0.8133128474461191}, "off_policy_estimator": {}, "info": {"num_steps_trained": 76946304, "num_steps_sampled": 1549600, "sample_time_ms": 176028.351, "load_time_ms": 130.604, "grad_time_ms": 10655.422, "update_time_ms": 3.903, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11891.857421875, "policy_loss": -6.955061689950526e-05, "vf_loss": 11891.8662109375, "vf_explained_var": 0.37711572647094727, "kl": 0.001672399346716702, "entropy": 0.9144875407218933, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1549600, "episodes_total": 1191, "training_iteration": 149, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-00-09", "timestamp": 1710313209, "time_this_iter_s": 179.93385291099548, "time_total_s": 20074.08425974846, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20074.08425974846, "timesteps_since_restore": 1549600, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 35.447081712062264, "ram_util_percent": 34.20856031128405}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257924.38827501814, "episode_reward_min": 132906.72459091572, "episode_reward_mean": 199925.869765318, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -580.3977527674288}, "policy_reward_max": {"shared_policy": 1408.8560020923615}, "policy_reward_mean": {"shared_policy": 711.6572447418147}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.84793991461199, "mean_processing_ms": 3.2718318815043745, "mean_inference_ms": 0.8136178279623998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 77606400, "num_steps_sampled": 1560000, "sample_time_ms": 173217.156, "load_time_ms": 126.511, "grad_time_ms": 10411.404, "update_time_ms": 3.878, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13290.171875, "policy_loss": 3.693701000884175e-05, "vf_loss": 13290.1806640625, "vf_explained_var": 0.3611781597137451, "kl": 0.0016450565308332443, "entropy": 0.9279929399490356, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1560000, "episodes_total": 1199, "training_iteration": 150, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-02-59", "timestamp": 1710313379, "time_this_iter_s": 169.74567699432373, "time_total_s": 20243.829936742783, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20243.829936742783, "timesteps_since_restore": 1560000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 35.82314049586776, "ram_util_percent": 34.28388429752066}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257924.38827501814, "episode_reward_min": 137746.0751295489, "episode_reward_mean": 208484.31976759338, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -579.1285919733346}, "policy_reward_max": {"shared_policy": 1421.7152755260468}, "policy_reward_mean": {"shared_policy": 740.6192531708465}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.97444019521545, "mean_processing_ms": 3.2778896216907607, "mean_inference_ms": 0.8139154986127397}, "off_policy_estimator": {}, "info": {"num_steps_trained": 78267392, "num_steps_sampled": 1570400, "sample_time_ms": 171141.51, "load_time_ms": 125.242, "grad_time_ms": 10216.518, "update_time_ms": 3.615, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13848.9423828125, "policy_loss": -0.0003587681276258081, "vf_loss": 13848.951171875, "vf_explained_var": 0.35959336161613464, "kl": 0.004152387846261263, "entropy": 0.9013124108314514, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1570400, "episodes_total": 1207, "training_iteration": 151, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-05-50", "timestamp": 1710313550, "time_this_iter_s": 170.95487356185913, "time_total_s": 20414.78481030464, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20414.78481030464, "timesteps_since_restore": 1570400, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 36.41844262295082, "ram_util_percent": 34.21762295081967}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 277808.41136321164, "episode_reward_min": 139319.57116709245, "episode_reward_mean": 217772.07164519577, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -423.0366037581116}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 772.7894664485301}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.09069629652035, "mean_processing_ms": 3.2834754988777126, "mean_inference_ms": 0.8141930807951109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 78886912, "num_steps_sampled": 1580800, "sample_time_ms": 168724.904, "load_time_ms": 123.439, "grad_time_ms": 10045.002, "update_time_ms": 3.593, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15413.8330078125, "policy_loss": -6.627689435845241e-05, "vf_loss": 15413.841796875, "vf_explained_var": 0.3386193513870239, "kl": 0.001539405551739037, "entropy": 0.8971571922302246, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1580800, "episodes_total": 1215, "training_iteration": 152, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-08-31", "timestamp": 1710313711, "time_this_iter_s": 160.4394769668579, "time_total_s": 20575.2242872715, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20575.2242872715, "timesteps_since_restore": 1580800, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 35.33711790393013, "ram_util_percent": 34.13624454148472}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 285636.7639544584, "episode_reward_min": 168068.57404272252, "episode_reward_mean": 226312.8589908743, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -414.6022528707981}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 802.641718651136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.197204794977466, "mean_processing_ms": 3.2886128717711602, "mean_inference_ms": 0.8144506713295552}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79479808, "num_steps_sampled": 1591200, "sample_time_ms": 166252.776, "load_time_ms": 121.204, "grad_time_ms": 9969.434, "update_time_ms": 3.631, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17136.486328125, "policy_loss": -4.3656360503518954e-05, "vf_loss": 17136.498046875, "vf_explained_var": 0.3333517014980316, "kl": 0.0020327444653958082, "entropy": 0.8868996500968933, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1591200, "episodes_total": 1223, "training_iteration": 153, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-11-02", "timestamp": 1710313862, "time_this_iter_s": 150.89647603034973, "time_total_s": 20726.12076330185, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20726.12076330185, "timesteps_since_restore": 1591200, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 35.6050925925926, "ram_util_percent": 34.140740740740746}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 287113.2770857753, "episode_reward_min": 179320.56198678195, "episode_reward_mean": 233950.27452106483, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -414.6022528707981}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 829.699168425949}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.294925367724574, "mean_processing_ms": 3.2933400129587125, "mean_inference_ms": 0.8146854606064123}, "off_policy_estimator": {}, "info": {"num_steps_trained": 80067584, "num_steps_sampled": 1601600, "sample_time_ms": 163506.424, "load_time_ms": 119.022, "grad_time_ms": 9803.014, "update_time_ms": 3.627, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17485.525390625, "policy_loss": 0.00010155811469303444, "vf_loss": 17485.53515625, "vf_explained_var": 0.32371681928634644, "kl": 0.0017811533762142062, "entropy": 0.890998899936676, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1601600, "episodes_total": 1231, "training_iteration": 154, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-13-31", "timestamp": 1710314011, "time_this_iter_s": 149.1915442943573, "time_total_s": 20875.312307596207, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20875.312307596207, "timesteps_since_restore": 1601600, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 35.36760563380282, "ram_util_percent": 34.18075117370891}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 179320.56198678195, "episode_reward_mean": 239981.49821397074, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -414.6022528707981}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 851.1189467086493}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.385182417236905, "mean_processing_ms": 3.297715145207127, "mean_inference_ms": 0.8149058355034949}, "off_policy_estimator": {}, "info": {"num_steps_trained": 80643968, "num_steps_sampled": 1612000, "sample_time_ms": 160735.474, "load_time_ms": 116.399, "grad_time_ms": 9578.987, "update_time_ms": 3.648, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 18745.662109375, "policy_loss": -5.15544306836091e-05, "vf_loss": 18745.671875, "vf_explained_var": 0.3329518735408783, "kl": 0.0028254801873117685, "entropy": 0.8864212036132812, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1612000, "episodes_total": 1239, "training_iteration": 155, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-15-58", "timestamp": 1710314158, "time_this_iter_s": 147.22243332862854, "time_total_s": 21022.534740924835, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21022.534740924835, "timesteps_since_restore": 1612000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 35.63047619047619, "ram_util_percent": 34.18714285714285}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 179320.56198678195, "episode_reward_mean": 244033.94501255665, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -414.6022528707981}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 865.4913640677993}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.47095178783788, "mean_processing_ms": 3.3018740705438483, "mean_inference_ms": 0.8151135358976339}, "off_policy_estimator": {}, "info": {"num_steps_trained": 81262976, "num_steps_sampled": 1622400, "sample_time_ms": 158061.804, "load_time_ms": 112.138, "grad_time_ms": 9395.775, "update_time_ms": 3.582, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17216.7421875, "policy_loss": -0.00038722381577827036, "vf_loss": 17216.751953125, "vf_explained_var": 0.35296642780303955, "kl": 0.0036169819068163633, "entropy": 0.8845937848091125, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1622400, "episodes_total": 1247, "training_iteration": 156, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-18-37", "timestamp": 1710314317, "time_this_iter_s": 158.2990517616272, "time_total_s": 21180.833792686462, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21180.833792686462, "timesteps_since_restore": 1622400, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 36.28938053097345, "ram_util_percent": 34.2212389380531}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 179320.56198678195, "episode_reward_mean": 245656.82001878065, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -414.6022528707981}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 871.2779571511993}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.55376760576148, "mean_processing_ms": 3.3058773681388653, "mean_inference_ms": 0.8153048579524829}, "off_policy_estimator": {}, "info": {"num_steps_trained": 81931904, "num_steps_sampled": 1632800, "sample_time_ms": 154809.914, "load_time_ms": 107.923, "grad_time_ms": 9209.729, "update_time_ms": 3.523, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14395.6328125, "policy_loss": -7.446342351613566e-05, "vf_loss": 14395.6416015625, "vf_explained_var": 0.34584030508995056, "kl": 0.0019973188173025846, "entropy": 0.9210243821144104, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1632800, "episodes_total": 1255, "training_iteration": 157, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-21-25", "timestamp": 1710314485, "time_this_iter_s": 168.76878547668457, "time_total_s": 21349.602578163147, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21349.602578163147, "timesteps_since_restore": 1632800, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 35.21078838174274, "ram_util_percent": 34.20912863070539}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 179320.56198678195, "episode_reward_mean": 245753.38635953126, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -414.6022528707981}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 871.6513668139718}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.63479758515896, "mean_processing_ms": 3.309788400050455, "mean_inference_ms": 0.815487093073437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 82647808, "num_steps_sampled": 1643200, "sample_time_ms": 154101.751, "load_time_ms": 106.92, "grad_time_ms": 9177.59, "update_time_ms": 3.541, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12070.87109375, "policy_loss": -1.2323423106863629e-05, "vf_loss": 12070.8818359375, "vf_explained_var": 0.3494618237018585, "kl": 0.0019230518955737352, "entropy": 0.9295313954353333, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1643200, "episodes_total": 1263, "training_iteration": 158, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-24-25", "timestamp": 1710314665, "time_this_iter_s": 179.30181002616882, "time_total_s": 21528.904388189316, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21528.904388189316, "timesteps_since_restore": 1643200, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 35.701171875, "ram_util_percent": 34.221875}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 190270.01768767694, "episode_reward_mean": 247905.34607203238, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -373.3120512133464}, "policy_reward_max": {"shared_policy": 1442.150805234909}, "policy_reward_mean": {"shared_policy": 879.2840536001715}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.71080363566191, "mean_processing_ms": 3.3134593234718612, "mean_inference_ms": 0.8156505330255825}, "off_policy_estimator": {}, "info": {"num_steps_trained": 83342208, "num_steps_sampled": 1653600, "sample_time_ms": 153597.115, "load_time_ms": 106.6, "grad_time_ms": 9150.733, "update_time_ms": 3.624, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13395.9375, "policy_loss": -0.00028014456620439887, "vf_loss": 13395.9462890625, "vf_explained_var": 0.3535776734352112, "kl": 0.002058787038549781, "entropy": 0.9166336059570312, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1653600, "episodes_total": 1271, "training_iteration": 159, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-27-20", "timestamp": 1710314840, "time_this_iter_s": 174.60397243499756, "time_total_s": 21703.508360624313, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21703.508360624313, "timesteps_since_restore": 1653600, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 35.6, "ram_util_percent": 34.256224899598394}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 190270.01768767694, "episode_reward_mean": 250269.2250029463, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -373.3120512133464}, "policy_reward_max": {"shared_policy": 1444.7348954677582}, "policy_reward_mean": {"shared_policy": 887.6683869012779}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.78214318310829, "mean_processing_ms": 3.316903718299792, "mean_inference_ms": 0.8157910372199882}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84027008, "num_steps_sampled": 1664000, "sample_time_ms": 153760.582, "load_time_ms": 106.047, "grad_time_ms": 9171.26, "update_time_ms": 3.706, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13729.564453125, "policy_loss": -2.963946280942764e-05, "vf_loss": 13729.5732421875, "vf_explained_var": 0.3727991580963135, "kl": 0.0019282079301774502, "entropy": 0.9034568667411804, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1664000, "episodes_total": 1279, "training_iteration": 160, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-30-11", "timestamp": 1710315011, "time_this_iter_s": 171.5804316997528, "time_total_s": 21875.088792324066, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21875.088792324066, "timesteps_since_restore": 1664000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 35.4334693877551, "ram_util_percent": 34.25877551020409}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 252175.7621647395, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -338.5340999737382}, "policy_reward_max": {"shared_policy": 1451.4305257797241}, "policy_reward_mean": {"shared_policy": 894.4305957463982}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.84957161632279, "mean_processing_ms": 3.3201605101252367, "mean_inference_ms": 0.8159184922193219}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84699008, "num_steps_sampled": 1674400, "sample_time_ms": 153469.397, "load_time_ms": 105.408, "grad_time_ms": 9185.347, "update_time_ms": 3.775, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14789.6806640625, "policy_loss": -9.120657341554761e-05, "vf_loss": 14789.689453125, "vf_explained_var": 0.38799047470092773, "kl": 0.0018065613694489002, "entropy": 0.8605203032493591, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1674400, "episodes_total": 1287, "training_iteration": 161, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-33-00", "timestamp": 1710315180, "time_this_iter_s": 168.20188641548157, "time_total_s": 22043.290678739548, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22043.290678739548, "timesteps_since_restore": 1674400, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 35.49791666666667, "ram_util_percent": 34.291250000000005}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 251921.11000959348, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1451.4305257797241}, "policy_reward_mean": {"shared_policy": 893.4640020201215}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.91574192391999, "mean_processing_ms": 3.3233510569398566, "mean_inference_ms": 0.8160432505894895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 85387136, "num_steps_sampled": 1684800, "sample_time_ms": 154620.848, "load_time_ms": 106.153, "grad_time_ms": 9283.147, "update_time_ms": 3.862, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12853.7958984375, "policy_loss": -2.7953647077083588e-06, "vf_loss": 12853.8046875, "vf_explained_var": 0.37885284423828125, "kl": 0.0023342992644757032, "entropy": 0.8862549662590027, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1684800, "episodes_total": 1295, "training_iteration": 162, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-35-53", "timestamp": 1710315353, "time_this_iter_s": 172.96631741523743, "time_total_s": 22216.256996154785, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22216.256996154785, "timesteps_since_restore": 1684800, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 35.43765182186234, "ram_util_percent": 34.27975708502025}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 251778.17524785458, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1452.4593749046326}, "policy_reward_mean": {"shared_policy": 892.9254007442444}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.981010598350096, "mean_processing_ms": 3.3265027297625966, "mean_inference_ms": 0.8161628237743994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 86057984, "num_steps_sampled": 1695200, "sample_time_ms": 156509.161, "load_time_ms": 107.283, "grad_time_ms": 9387.845, "update_time_ms": 3.841, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13100.8642578125, "policy_loss": -9.663363016443327e-05, "vf_loss": 13100.8720703125, "vf_explained_var": 0.38150060176849365, "kl": 0.0027381323743611574, "entropy": 0.8629460334777832, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1695200, "episodes_total": 1303, "training_iteration": 163, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-38-44", "timestamp": 1710315524, "time_this_iter_s": 170.85424637794495, "time_total_s": 22387.11124253273, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22387.11124253273, "timesteps_since_restore": 1695200, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 36.462704918032784, "ram_util_percent": 34.3110655737705}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 251241.62814162948, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1452.4593749046326}, "policy_reward_mean": {"shared_policy": 891.0225490003528}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.04634846574345, "mean_processing_ms": 3.329625299187016, "mean_inference_ms": 0.8162757172563623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 86722816, "num_steps_sampled": 1705600, "sample_time_ms": 158199.481, "load_time_ms": 107.13, "grad_time_ms": 9504.688, "update_time_ms": 4.026, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15227.6162109375, "policy_loss": -1.219228306581499e-05, "vf_loss": 15227.6259765625, "vf_explained_var": 0.3912498652935028, "kl": 0.001822909340262413, "entropy": 0.8484590649604797, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1705600, "episodes_total": 1311, "training_iteration": 164, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-41-31", "timestamp": 1710315691, "time_this_iter_s": 167.2762041091919, "time_total_s": 22554.387446641922, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22554.387446641922, "timesteps_since_restore": 1705600, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 35.13640167364017, "ram_util_percent": 34.46778242677824}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 250289.39913748662, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1452.4593749046326}, "policy_reward_mean": {"shared_policy": 887.6454911426275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.112190739319004, "mean_processing_ms": 3.3327681943540735, "mean_inference_ms": 0.816393337689093}, "off_policy_estimator": {}, "info": {"num_steps_trained": 87362560, "num_steps_sampled": 1716000, "sample_time_ms": 159590.131, "load_time_ms": 107.489, "grad_time_ms": 9632.593, "update_time_ms": 3.967, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16171.9404296875, "policy_loss": -2.739015872066375e-05, "vf_loss": 16171.9501953125, "vf_explained_var": 0.4002216160297394, "kl": 0.0018724750261753798, "entropy": 0.8466795086860657, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1716000, "episodes_total": 1319, "training_iteration": 165, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-44-14", "timestamp": 1710315854, "time_this_iter_s": 162.41901016235352, "time_total_s": 22716.806456804276, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22716.806456804276, "timesteps_since_restore": 1716000, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 35.615517241379315, "ram_util_percent": 34.43318965517241}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 288645.4128072569, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 248214.35225916828, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1452.4593749046326}, "policy_reward_mean": {"shared_policy": 880.286385995561}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.17992074813114, "mean_processing_ms": 3.336000690401909, "mean_inference_ms": 0.8165171014735761}, "off_policy_estimator": {}, "info": {"num_steps_trained": 88017280, "num_steps_sampled": 1726400, "sample_time_ms": 160379.745, "load_time_ms": 108.209, "grad_time_ms": 9692.631, "update_time_ms": 3.98, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15712.2685546875, "policy_loss": -8.311192505061626e-05, "vf_loss": 15712.2783203125, "vf_explained_var": 0.40233659744262695, "kl": 0.002483290620148182, "entropy": 0.8549333810806274, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1726400, "episodes_total": 1327, "training_iteration": 166, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-47-01", "timestamp": 1710316021, "time_this_iter_s": 166.82031106948853, "time_total_s": 22883.626767873764, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22883.626767873764, "timesteps_since_restore": 1726400, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 35.247058823529414, "ram_util_percent": 34.44537815126051}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 285153.7795888204, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 245439.10890395727, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1458.4806549549103}, "policy_reward_mean": {"shared_policy": 870.4131814453411}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.25104930981202, "mean_processing_ms": 3.3393884666061253, "mean_inference_ms": 0.8166491525445855}, "off_policy_estimator": {}, "info": {"num_steps_trained": 88697216, "num_steps_sampled": 1736800, "sample_time_ms": 160763.476, "load_time_ms": 109.453, "grad_time_ms": 9664.77, "update_time_ms": 4.009, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14583.111328125, "policy_loss": 5.0905327952932566e-05, "vf_loss": 14583.1201171875, "vf_explained_var": 0.4307129681110382, "kl": 0.002423905534669757, "entropy": 0.8615314364433289, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1736800, "episodes_total": 1335, "training_iteration": 167, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-49-53", "timestamp": 1710316193, "time_this_iter_s": 172.33810091018677, "time_total_s": 23055.96486878395, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23055.96486878395, "timesteps_since_restore": 1736800, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 35.640650406504065, "ram_util_percent": 34.608130081300814}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 282041.7855111372, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 241178.26915408022, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 855.3027489682964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.32694821942173, "mean_processing_ms": 3.343022752065565, "mean_inference_ms": 0.8167932765338324}, "off_policy_estimator": {}, "info": {"num_steps_trained": 89436544, "num_steps_sampled": 1747200, "sample_time_ms": 161310.726, "load_time_ms": 108.165, "grad_time_ms": 9682.275, "update_time_ms": 3.924, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11344.275390625, "policy_loss": -0.0002063313004327938, "vf_loss": 11344.2841796875, "vf_explained_var": 0.4502655565738678, "kl": 0.003986247815191746, "entropy": 0.8710914850234985, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1747200, "episodes_total": 1343, "training_iteration": 168, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-52-58", "timestamp": 1710316378, "time_this_iter_s": 184.9326524734497, "time_total_s": 23240.8975212574, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23240.8975212574, "timesteps_since_restore": 1747200, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 36.51856060606061, "ram_util_percent": 34.44318181818182}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 239640.77023436007, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 849.8502384366271}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.40474312594119, "mean_processing_ms": 3.3467268222716973, "mean_inference_ms": 0.8169415034915509}, "off_policy_estimator": {}, "info": {"num_steps_trained": 90139136, "num_steps_sampled": 1757600, "sample_time_ms": 161660.473, "load_time_ms": 108.449, "grad_time_ms": 9687.548, "update_time_ms": 3.796, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13552.603515625, "policy_loss": 1.975175655388739e-05, "vf_loss": 13552.6123046875, "vf_explained_var": 0.4480529725551605, "kl": 0.0015380762051790953, "entropy": 0.8648942112922668, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1757600, "episodes_total": 1351, "training_iteration": 169, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-55-56", "timestamp": 1710316556, "time_this_iter_s": 178.15534687042236, "time_total_s": 23419.052868127823, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23419.052868127823, "timesteps_since_restore": 1757600, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 35.77725490196079, "ram_util_percent": 34.68666666666665}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 205631.06249130474, "episode_reward_mean": 241282.8745467915, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 855.6737163869478}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.48162239391351, "mean_processing_ms": 3.350387030136102, "mean_inference_ms": 0.8170926769238379}, "off_policy_estimator": {}, "info": {"num_steps_trained": 90822912, "num_steps_sampled": 1768000, "sample_time_ms": 161905.42, "load_time_ms": 109.513, "grad_time_ms": 9696.786, "update_time_ms": 3.713, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15767.5400390625, "policy_loss": -0.0002536036481615156, "vf_loss": 15767.55078125, "vf_explained_var": 0.445544570684433, "kl": 0.0037058070302009583, "entropy": 0.8483477234840393, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1768000, "episodes_total": 1359, "training_iteration": 170, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_03-58-51", "timestamp": 1710316731, "time_this_iter_s": 174.1457211971283, "time_total_s": 23593.19858932495, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23593.19858932495, "timesteps_since_restore": 1768000, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 35.43911290322581, "ram_util_percent": 34.438709677419354}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 214987.4138031918, "episode_reward_mean": 242183.15660769868, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 858.8664323983924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.55813988475134, "mean_processing_ms": 3.3540221631967095, "mean_inference_ms": 0.8172406194690176}, "off_policy_estimator": {}, "info": {"num_steps_trained": 91543680, "num_steps_sampled": 1778400, "sample_time_ms": 163298.392, "load_time_ms": 109.369, "grad_time_ms": 9770.443, "update_time_ms": 3.709, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13102.435546875, "policy_loss": 7.027068932075053e-05, "vf_loss": 13102.4443359375, "vf_explained_var": 0.46152904629707336, "kl": 0.001597635680809617, "entropy": 0.8589967489242554, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1778400, "episodes_total": 1367, "training_iteration": 171, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-01-54", "timestamp": 1710316914, "time_this_iter_s": 182.85141730308533, "time_total_s": 23776.050006628036, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23776.050006628036, "timesteps_since_restore": 1778400, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 35.500383141762455, "ram_util_percent": 34.454406130268204}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 211039.1392010337, "episode_reward_mean": 241040.25857033106, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 854.8133150235161}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.63659220569937, "mean_processing_ms": 3.3577385092278518, "mean_inference_ms": 0.8173955111610124}, "off_policy_estimator": {}, "info": {"num_steps_trained": 92300032, "num_steps_sampled": 1788800, "sample_time_ms": 164863.948, "load_time_ms": 110.498, "grad_time_ms": 9866.975, "update_time_ms": 3.632, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11402.4677734375, "policy_loss": -0.00019166622951161116, "vf_loss": 11402.4765625, "vf_explained_var": 0.47255346179008484, "kl": 0.003083996707573533, "entropy": 0.8616829514503479, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1788800, "episodes_total": 1375, "training_iteration": 172, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-05-03", "timestamp": 1710317103, "time_this_iter_s": 189.60237288475037, "time_total_s": 23965.652379512787, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23965.652379512787, "timesteps_since_restore": 1788800, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 35.86974169741698, "ram_util_percent": 34.48044280442803}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 211039.1392010337, "episode_reward_mean": 239910.622081237, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 850.8072277510355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.71731732678377, "mean_processing_ms": 3.361556838262054, "mean_inference_ms": 0.8175614532055369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 93045248, "num_steps_sampled": 1799200, "sample_time_ms": 166806.749, "load_time_ms": 113.575, "grad_time_ms": 9998.291, "update_time_ms": 3.789, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11938.7431640625, "policy_loss": -0.0001961209491128102, "vf_loss": 11938.7509765625, "vf_explained_var": 0.49257680773735046, "kl": 0.0024732444435358047, "entropy": 0.8460431098937988, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1799200, "episodes_total": 1383, "training_iteration": 173, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-08-15", "timestamp": 1710317295, "time_this_iter_s": 191.63260793685913, "time_total_s": 24157.284987449646, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24157.284987449646, "timesteps_since_restore": 1799200, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 35.456569343065695, "ram_util_percent": 34.52408759124087}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 211039.1392010337, "episode_reward_mean": 239340.61927350968, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -347.56568836420774}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 848.7857978349874}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.80070716780558, "mean_processing_ms": 3.365492463738522, "mean_inference_ms": 0.8177389906979704}, "off_policy_estimator": {}, "info": {"num_steps_trained": 93796608, "num_steps_sampled": 1809600, "sample_time_ms": 169178.166, "load_time_ms": 117.061, "grad_time_ms": 10135.273, "update_time_ms": 3.674, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12599.9794921875, "policy_loss": -9.362218406749889e-05, "vf_loss": 12599.9873046875, "vf_explained_var": 0.5064324140548706, "kl": 0.0017717822920531034, "entropy": 0.8254603147506714, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1809600, "episodes_total": 1391, "training_iteration": 174, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-11-28", "timestamp": 1710317488, "time_this_iter_s": 192.40991401672363, "time_total_s": 24349.69490146637, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24349.69490146637, "timesteps_since_restore": 1809600, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 35.67919708029197, "ram_util_percent": 34.552189781021895}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 211039.1392010337, "episode_reward_mean": 238462.04064758722, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -81.86920291185379}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 845.6700498176723}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.887408488617154, "mean_processing_ms": 3.3695820351149495, "mean_inference_ms": 0.8179287041290085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 94564224, "num_steps_sampled": 1820000, "sample_time_ms": 172679.685, "load_time_ms": 120.08, "grad_time_ms": 10335.172, "update_time_ms": 3.701, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12674.671875, "policy_loss": -0.00018034975801128894, "vf_loss": 12674.681640625, "vf_explained_var": 0.5258762836456299, "kl": 0.003274529939517379, "entropy": 0.8164699077606201, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1820000, "episodes_total": 1399, "training_iteration": 175, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-14-47", "timestamp": 1710317687, "time_this_iter_s": 199.49215006828308, "time_total_s": 24549.187051534653, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24549.187051534653, "timesteps_since_restore": 1820000, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 36.43754385964912, "ram_util_percent": 34.633684210526326}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268649.186134081, "episode_reward_min": 211039.1392010337, "episode_reward_mean": 236426.44541759221, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -81.86920291185379}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 838.4511150350813}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.97829675234299, "mean_processing_ms": 3.373851961648462, "mean_inference_ms": 0.8181280633783632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 95346176, "num_steps_sampled": 1830400, "sample_time_ms": 175891.062, "load_time_ms": 124.471, "grad_time_ms": 10534.085, "update_time_ms": 3.807, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11468.275390625, "policy_loss": -4.197010184725514e-06, "vf_loss": 11468.28515625, "vf_explained_var": 0.5382595658302307, "kl": 0.0014980070991441607, "entropy": 0.8086241483688354, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1830400, "episodes_total": 1407, "training_iteration": 176, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-18-08", "timestamp": 1710317888, "time_this_iter_s": 200.97850036621094, "time_total_s": 24750.165551900864, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24750.165551900864, "timesteps_since_restore": 1830400, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 35.59233449477352, "ram_util_percent": 34.650174216027885}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 261952.31373567495, "episode_reward_min": 211039.1392010337, "episode_reward_mean": 233655.5740765334, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -81.86920291185379}, "policy_reward_max": {"shared_policy": 1469.2694976329803}, "policy_reward_mean": {"shared_policy": 828.6540202026223}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.07438087430147, "mean_processing_ms": 3.3783678020061556, "mean_inference_ms": 0.8183434240154193}, "off_policy_estimator": {}, "info": {"num_steps_trained": 96143616, "num_steps_sampled": 1840800, "sample_time_ms": 179042.32, "load_time_ms": 126.952, "grad_time_ms": 10775.321, "update_time_ms": 3.807, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12738.658203125, "policy_loss": -0.00027661354397423565, "vf_loss": 12738.666015625, "vf_explained_var": 0.5408170223236084, "kl": 0.0038265076000243425, "entropy": 0.8009139895439148, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1840800, "episodes_total": 1415, "training_iteration": 177, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-21-35", "timestamp": 1710318095, "time_this_iter_s": 206.325279712677, "time_total_s": 24956.49083161354, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24956.49083161354, "timesteps_since_restore": 1840800, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 35.518027210884355, "ram_util_percent": 34.552721088435376}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260521.81480045756, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 230403.03885665897, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -78.93665274977684}, "policy_reward_max": {"shared_policy": 1474.4869389533997}, "policy_reward_mean": {"shared_policy": 817.1479601952722}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.175915184846865, "mean_processing_ms": 3.383129397210082, "mean_inference_ms": 0.8185756401795521}, "off_policy_estimator": {}, "info": {"num_steps_trained": 96944256, "num_steps_sampled": 1851200, "sample_time_ms": 181216.313, "load_time_ms": 130.233, "grad_time_ms": 10912.122, "update_time_ms": 3.845, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11602.072265625, "policy_loss": -0.00022948910191189498, "vf_loss": 11602.080078125, "vf_explained_var": 0.5529648661613464, "kl": 0.002265534596517682, "entropy": 0.7889739274978638, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1851200, "episodes_total": 1423, "training_iteration": 178, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-25-03", "timestamp": 1710318303, "time_this_iter_s": 208.09230399131775, "time_total_s": 25164.58313560486, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25164.58313560486, "timesteps_since_restore": 1851200, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 35.75335570469799, "ram_util_percent": 34.79328859060403}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 254360.46365588723, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 229089.23050994656, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -78.93665274977684}, "policy_reward_max": {"shared_policy": 1475.9207916259766}, "policy_reward_mean": {"shared_policy": 812.4884044188769}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.280532235742214, "mean_processing_ms": 3.3880319145148583, "mean_inference_ms": 0.8188198398575324}, "off_policy_estimator": {}, "info": {"num_steps_trained": 97696128, "num_steps_sampled": 1861600, "sample_time_ms": 182705.16, "load_time_ms": 131.807, "grad_time_ms": 10995.443, "update_time_ms": 3.933, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13361.44921875, "policy_loss": -0.0001272268418688327, "vf_loss": 13361.45703125, "vf_explained_var": 0.5481861233711243, "kl": 0.0024258773773908615, "entropy": 0.7582895755767822, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1861600, "episodes_total": 1431, "training_iteration": 179, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-28-17", "timestamp": 1710318497, "time_this_iter_s": 193.90520668029785, "time_total_s": 25358.488342285156, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25358.488342285156, "timesteps_since_restore": 1861600, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 35.90507246376812, "ram_util_percent": 34.7304347826087}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 230474.43393246707, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -78.93665274977684}, "policy_reward_max": {"shared_policy": 1475.9207916259766}, "policy_reward_mean": {"shared_policy": 817.4011701392645}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.38457776005994, "mean_processing_ms": 3.39288591288234, "mean_inference_ms": 0.8190641515892616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 98408704, "num_steps_sampled": 1872000, "sample_time_ms": 183731.301, "load_time_ms": 132.794, "grad_time_ms": 11038.704, "update_time_ms": 3.995, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15011.986328125, "policy_loss": -0.0002238550514448434, "vf_loss": 15011.9951171875, "vf_explained_var": 0.5273998379707336, "kl": 0.0036480866838246584, "entropy": 0.7357960939407349, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1872000, "episodes_total": 1439, "training_iteration": 180, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-31-22", "timestamp": 1710318682, "time_this_iter_s": 184.85020518302917, "time_total_s": 25543.338547468185, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25543.338547468185, "timesteps_since_restore": 1872000, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 35.62386363636364, "ram_util_percent": 34.7844696969697}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 231614.2099614392, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -64.74731775186956}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 821.4435024877258}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.488227213639746, "mean_processing_ms": 3.3977042350034323, "mean_inference_ms": 0.8193081417898614}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99130880, "num_steps_sampled": 1882400, "sample_time_ms": 184168.342, "load_time_ms": 133.317, "grad_time_ms": 11069.309, "update_time_ms": 4.127, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15354.7197265625, "policy_loss": -0.0002142350422218442, "vf_loss": 15354.7265625, "vf_explained_var": 0.5148347020149231, "kl": 0.00288357213139534, "entropy": 0.7236796617507935, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1882400, "episodes_total": 1447, "training_iteration": 181, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-34-30", "timestamp": 1710318870, "time_this_iter_s": 187.5446708202362, "time_total_s": 25730.88321828842, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25730.88321828842, "timesteps_since_restore": 1882400, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 35.816791044776124, "ram_util_percent": 34.80485074626866}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 232344.53863362942, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -64.74731775186956}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 824.004463714684}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.59181090865378, "mean_processing_ms": 3.402520285698878, "mean_inference_ms": 0.8195566941241076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99837824, "num_steps_sampled": 1892800, "sample_time_ms": 183677.387, "load_time_ms": 132.097, "grad_time_ms": 11024.353, "update_time_ms": 4.291, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16697.787109375, "policy_loss": 7.133060717023909e-05, "vf_loss": 16697.794921875, "vf_explained_var": 0.4969515800476074, "kl": 0.00242150598205626, "entropy": 0.7227833867073059, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1892800, "episodes_total": 1455, "training_iteration": 182, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-37-34", "timestamp": 1710319054, "time_this_iter_s": 184.2304985523224, "time_total_s": 25915.113716840744, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25915.113716840744, "timesteps_since_restore": 1892800, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 35.68060836501901, "ram_util_percent": 34.807984790874535}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 232007.03219952591, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -64.74731775186956}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 822.8075050520476}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.695473105057154, "mean_processing_ms": 3.407354782117716, "mean_inference_ms": 0.8198142987419946}, "off_policy_estimator": {}, "info": {"num_steps_trained": 100560384, "num_steps_sampled": 1903200, "sample_time_ms": 183084.723, "load_time_ms": 131.313, "grad_time_ms": 10990.039, "update_time_ms": 4.186, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15323.94140625, "policy_loss": -0.00016529549611732364, "vf_loss": 15323.94921875, "vf_explained_var": 0.5059947371482849, "kl": 0.001966743730008602, "entropy": 0.7364513278007507, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1903200, "episodes_total": 1463, "training_iteration": 183, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-40-39", "timestamp": 1710319239, "time_this_iter_s": 185.36970114707947, "time_total_s": 26100.483417987823, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26100.483417987823, "timesteps_since_restore": 1903200, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 35.82603773584906, "ram_util_percent": 34.82150943396227}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 231358.3665945651, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -149.2322102934122}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 820.4779296211262}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.799437034754135, "mean_processing_ms": 3.4121939968585364, "mean_inference_ms": 0.8200799819874142}, "off_policy_estimator": {}, "info": {"num_steps_trained": 101320320, "num_steps_sampled": 1913600, "sample_time_ms": 183291.046, "load_time_ms": 132.088, "grad_time_ms": 11015.099, "update_time_ms": 4.171, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12983.1201171875, "policy_loss": -8.087357127806172e-05, "vf_loss": 12983.1279296875, "vf_explained_var": 0.5093522667884827, "kl": 0.0026075090281665325, "entropy": 0.7499028444290161, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1913600, "episodes_total": 1471, "training_iteration": 184, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-43-54", "timestamp": 1710319434, "time_this_iter_s": 194.74547290802002, "time_total_s": 26295.228890895844, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26295.228890895844, "timesteps_since_restore": 1913600, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 35.8226618705036, "ram_util_percent": 34.82589928057555}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 230638.97812853643, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 817.9557333352359}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.90323490902585, "mean_processing_ms": 3.4170286630778417, "mean_inference_ms": 0.8203496600273976}, "off_policy_estimator": {}, "info": {"num_steps_trained": 102095104, "num_steps_sampled": 1924000, "sample_time_ms": 183045.661, "load_time_ms": 133.058, "grad_time_ms": 11039.266, "update_time_ms": 4.32, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11853.5537109375, "policy_loss": 3.138420288451016e-05, "vf_loss": 11853.560546875, "vf_explained_var": 0.5183670520782471, "kl": 0.002817405154928565, "entropy": 0.7535327672958374, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1924000, "episodes_total": 1479, "training_iteration": 185, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-47-12", "timestamp": 1710319632, "time_this_iter_s": 197.29562258720398, "time_total_s": 26492.524513483047, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26492.524513483047, "timesteps_since_restore": 1924000, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 35.92064056939502, "ram_util_percent": 34.80569395017793}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 229412.941515217, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 813.607623205366}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.007782903552304, "mean_processing_ms": 3.421897158003073, "mean_inference_ms": 0.8206201438494154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 102891136, "num_steps_sampled": 1934400, "sample_time_ms": 183311.881, "load_time_ms": 131.634, "grad_time_ms": 11074.402, "update_time_ms": 4.282, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11220.1767578125, "policy_loss": -0.00024212880816776305, "vf_loss": 11220.18359375, "vf_explained_var": 0.5383335947990417, "kl": 0.003981254994869232, "entropy": 0.744086742401123, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1934400, "episodes_total": 1487, "training_iteration": 186, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-50-36", "timestamp": 1710319836, "time_this_iter_s": 203.9784939289093, "time_total_s": 26696.503007411957, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26696.503007411957, "timesteps_since_restore": 1934400, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 35.77147766323024, "ram_util_percent": 34.92336769759451}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 228127.48807014967, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 809.0487926735102}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.1132618827345, "mean_processing_ms": 3.4268085990737642, "mean_inference_ms": 0.8208914639587477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 103705600, "num_steps_sampled": 1944800, "sample_time_ms": 183503.05, "load_time_ms": 131.439, "grad_time_ms": 11117.237, "update_time_ms": 4.215, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11640.298828125, "policy_loss": -6.276144972616748e-07, "vf_loss": 11640.3056640625, "vf_explained_var": 0.5469292402267456, "kl": 0.001734588062390685, "entropy": 0.7479770183563232, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1944800, "episodes_total": 1495, "training_iteration": 187, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-54-05", "timestamp": 1710320045, "time_this_iter_s": 208.65909075737, "time_total_s": 26905.162098169327, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26905.162098169327, "timesteps_since_restore": 1944800, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 35.87516778523489, "ram_util_percent": 34.86946308724832}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 228638.3816294078, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1480.4790153503418}, "policy_reward_mean": {"shared_policy": 810.8606647140044}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.217070600352464, "mean_processing_ms": 3.4316313879460125, "mean_inference_ms": 0.8211591696485724}, "off_policy_estimator": {}, "info": {"num_steps_trained": 104471936, "num_steps_sampled": 1955200, "sample_time_ms": 182672.622, "load_time_ms": 130.4, "grad_time_ms": 11092.071, "update_time_ms": 4.276, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13668.8154296875, "policy_loss": -0.00015350389003288, "vf_loss": 13668.82421875, "vf_explained_var": 0.5431003570556641, "kl": 0.002460059244185686, "entropy": 0.7495768070220947, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1955200, "episodes_total": 1503, "training_iteration": 188, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_04-57-24", "timestamp": 1710320244, "time_this_iter_s": 199.519757270813, "time_total_s": 27104.68185544014, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27104.68185544014, "timesteps_since_restore": 1955200, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 35.80561403508772, "ram_util_percent": 34.93859649122807}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257355.90361573873, "episode_reward_min": 206182.24836218264, "episode_reward_mean": 229740.67636814524, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 814.7410325843865}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.31822783652403, "mean_processing_ms": 3.4363350106713755, "mean_inference_ms": 0.8214248723795623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 105216896, "num_steps_sampled": 1965600, "sample_time_ms": 182582.14, "load_time_ms": 129.677, "grad_time_ms": 11100.616, "update_time_ms": 4.413, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13592.5302734375, "policy_loss": -6.419490819098428e-05, "vf_loss": 13592.5390625, "vf_explained_var": 0.5413313508033752, "kl": 0.002396264346316457, "entropy": 0.755999743938446, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1965600, "episodes_total": 1511, "training_iteration": 189, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-00-37", "timestamp": 1710320437, "time_this_iter_s": 193.07782745361328, "time_total_s": 27297.759682893753, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27297.759682893753, "timesteps_since_restore": 1965600, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 35.89021739130435, "ram_util_percent": 34.83985507246377}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 259632.04131705334, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 232537.36341834304, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 824.6590659562488}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.41482811781421, "mean_processing_ms": 3.440830682803623, "mean_inference_ms": 0.8216817084816422}, "off_policy_estimator": {}, "info": {"num_steps_trained": 105929472, "num_steps_sampled": 1976000, "sample_time_ms": 182559.612, "load_time_ms": 130.581, "grad_time_ms": 11112.481, "update_time_ms": 4.412, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15757.5537109375, "policy_loss": -8.305071241920814e-05, "vf_loss": 15757.5615234375, "vf_explained_var": 0.5209231376647949, "kl": 0.0027776090428233147, "entropy": 0.7472357153892517, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1976000, "episodes_total": 1519, "training_iteration": 190, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-03-42", "timestamp": 1710320622, "time_this_iter_s": 184.75211787223816, "time_total_s": 27482.51180076599, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27482.51180076599, "timesteps_since_restore": 1976000, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 35.32537878787879, "ram_util_percent": 34.9560606060606}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 262831.0294072079, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 234709.88190264298, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 832.3340611462924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.507488664461334, "mean_processing_ms": 3.4451539315753883, "mean_inference_ms": 0.8219297506554242}, "off_policy_estimator": {}, "info": {"num_steps_trained": 106629248, "num_steps_sampled": 1986400, "sample_time_ms": 181929.346, "load_time_ms": 130.12, "grad_time_ms": 11035.718, "update_time_ms": 4.279, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15684.4736328125, "policy_loss": -5.2996434533270076e-05, "vf_loss": 15684.48046875, "vf_explained_var": 0.5133453607559204, "kl": 0.0020039849914610386, "entropy": 0.7499783635139465, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1986400, "episodes_total": 1527, "training_iteration": 191, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-06-43", "timestamp": 1710320803, "time_this_iter_s": 180.45651412010193, "time_total_s": 27662.968314886093, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27662.968314886093, "timesteps_since_restore": 1986400, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 35.414007782101166, "ram_util_percent": 35.01011673151751}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 271382.3774992052, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 236332.48941074085, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 838.0881925271847}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.59618264416813, "mean_processing_ms": 3.4493149269818106, "mean_inference_ms": 0.822168451419133}, "off_policy_estimator": {}, "info": {"num_steps_trained": 107300352, "num_steps_sampled": 1996800, "sample_time_ms": 180470.246, "load_time_ms": 130.032, "grad_time_ms": 10945.355, "update_time_ms": 4.158, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16141.0234375, "policy_loss": 0.0001117074498324655, "vf_loss": 16141.0302734375, "vf_explained_var": 0.5078339576721191, "kl": 0.0016621893737465143, "entropy": 0.7292458415031433, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1996800, "episodes_total": 1535, "training_iteration": 192, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-09-32", "timestamp": 1710320972, "time_this_iter_s": 168.71080660820007, "time_total_s": 27831.679121494293, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27831.679121494293, "timesteps_since_restore": 1996800, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 36.44896265560166, "ram_util_percent": 34.88838174273858}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272489.02466534777, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 238015.04268516228, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 844.0549050858624}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.6815432002164, "mean_processing_ms": 3.4533127894672013, "mean_inference_ms": 0.8223956593136953}, "off_policy_estimator": {}, "info": {"num_steps_trained": 107963904, "num_steps_sampled": 2007200, "sample_time_ms": 178708.306, "load_time_ms": 127.612, "grad_time_ms": 10849.093, "update_time_ms": 4.152, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17235.888671875, "policy_loss": 0.0001291831285925582, "vf_loss": 17235.896484375, "vf_explained_var": 0.49160030484199524, "kl": 0.0016021588817238808, "entropy": 0.7506026029586792, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2007200, "episodes_total": 1543, "training_iteration": 193, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-12-19", "timestamp": 1710321139, "time_this_iter_s": 166.7261040210724, "time_total_s": 27998.405225515366, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27998.405225515366, "timesteps_since_restore": 2007200, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 35.80756302521009, "ram_util_percent": 34.928991596638646}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272489.02466534777, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 239128.06393459864, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 848.0019289144956}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.76401863229077, "mean_processing_ms": 3.457178825145709, "mean_inference_ms": 0.8226132685928466}, "off_policy_estimator": {}, "info": {"num_steps_trained": 108648192, "num_steps_sampled": 2017600, "sample_time_ms": 176470.901, "load_time_ms": 124.437, "grad_time_ms": 10718.957, "update_time_ms": 4.118, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15189.1181640625, "policy_loss": 2.2150004951981828e-05, "vf_loss": 15189.1240234375, "vf_explained_var": 0.4955544173717499, "kl": 0.0026129395700991154, "entropy": 0.7582789659500122, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2017600, "episodes_total": 1551, "training_iteration": 194, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-15-10", "timestamp": 1710321310, "time_this_iter_s": 171.0052890777588, "time_total_s": 28169.410514593124, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28169.410514593124, "timesteps_since_restore": 2017600, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 35.6110655737705, "ram_util_percent": 34.97254098360656}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 241515.5153150175, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 856.4683687897353}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.84277109150909, "mean_processing_ms": 3.460866295151192, "mean_inference_ms": 0.8228179977262349}, "off_policy_estimator": {}, "info": {"num_steps_trained": 109299456, "num_steps_sampled": 2028000, "sample_time_ms": 173369.825, "load_time_ms": 120.513, "grad_time_ms": 10501.652, "update_time_ms": 4.002, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17779.421875, "policy_loss": -1.4976089005358517e-05, "vf_loss": 17779.4296875, "vf_explained_var": 0.48075738549232483, "kl": 0.002426826860755682, "entropy": 0.7336081266403198, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2028000, "episodes_total": 1559, "training_iteration": 195, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-17-54", "timestamp": 1710321474, "time_this_iter_s": 164.04115414619446, "time_total_s": 28333.45166873932, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28333.45166873932, "timesteps_since_restore": 2028000, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 35.49148936170213, "ram_util_percent": 35.02255319148936}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 244533.5045057715, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -197.4804733991623}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 867.201590558804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.918059036562774, "mean_processing_ms": 3.4643771513084882, "mean_inference_ms": 0.8230081565401022}, "off_policy_estimator": {}, "info": {"num_steps_trained": 109979648, "num_steps_sampled": 2038400, "sample_time_ms": 170479.314, "load_time_ms": 118.177, "grad_time_ms": 10301.846, "update_time_ms": 3.934, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16019.3154296875, "policy_loss": 0.00019156142661813647, "vf_loss": 16019.3193359375, "vf_explained_var": 0.48986271023750305, "kl": 0.0019993281457573175, "entropy": 0.7362642884254456, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2038400, "episodes_total": 1567, "training_iteration": 196, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-20-47", "timestamp": 1710321647, "time_this_iter_s": 173.01700854301453, "time_total_s": 28506.468677282333, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28506.468677282333, "timesteps_since_restore": 2038400, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 35.434817813765186, "ram_util_percent": 35.04129554655872}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 248156.30287061457, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -119.93002913147211}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 880.049304456396}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.98905083079322, "mean_processing_ms": 3.4676793376482804, "mean_inference_ms": 0.8231823585121919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 110664832, "num_steps_sampled": 2048800, "sample_time_ms": 167259.868, "load_time_ms": 114.936, "grad_time_ms": 10077.591, "update_time_ms": 3.968, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17036.353515625, "policy_loss": -0.00011872461618622765, "vf_loss": 17036.361328125, "vf_explained_var": 0.4812837541103363, "kl": 0.0031361663714051247, "entropy": 0.7397798299789429, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2048800, "episodes_total": 1575, "training_iteration": 197, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-23-41", "timestamp": 1710321821, "time_this_iter_s": 174.15807628631592, "time_total_s": 28680.62675356865, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28680.62675356865, "timesteps_since_restore": 2048800, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 35.5758064516129, "ram_util_percent": 35.08991935483872}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 251613.975287257, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -53.09668402560055}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 892.2797804434803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.055308045489674, "mean_processing_ms": 3.470761762898599, "mean_inference_ms": 0.8233415916389373}, "off_policy_estimator": {}, "info": {"num_steps_trained": 111353856, "num_steps_sampled": 2059200, "sample_time_ms": 165071.16, "load_time_ms": 111.992, "grad_time_ms": 9913.543, "update_time_ms": 3.993, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15382.509765625, "policy_loss": 4.6857665438437834e-05, "vf_loss": 15382.5166015625, "vf_explained_var": 0.49771207571029663, "kl": 0.0025709555484354496, "entropy": 0.7513217926025391, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2059200, "episodes_total": 1583, "training_iteration": 198, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-26-37", "timestamp": 1710321997, "time_this_iter_s": 175.96167159080505, "time_total_s": 28856.588425159454, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28856.588425159454, "timesteps_since_restore": 2059200, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 35.23690476190477, "ram_util_percent": 35.12380952380952}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 206462.7877963858, "episode_reward_mean": 253357.15273342028, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 898.4614799582265}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.11774691294993, "mean_processing_ms": 3.4736633643934067, "mean_inference_ms": 0.8234882971179002}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112092160, "num_steps_sampled": 2069600, "sample_time_ms": 164175.737, "load_time_ms": 111.706, "grad_time_ms": 9879.896, "update_time_ms": 3.797, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13822.23046875, "policy_loss": -5.741208588005975e-05, "vf_loss": 13822.23828125, "vf_explained_var": 0.4916647672653198, "kl": 0.002303501358255744, "entropy": 0.7863642573356628, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2069600, "episodes_total": 1591, "training_iteration": 199, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-29-41", "timestamp": 1710322181, "time_this_iter_s": 183.77225756645203, "time_total_s": 29040.360682725906, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29040.360682725906, "timesteps_since_restore": 2069600, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 35.67251908396947, "ram_util_percent": 35.14961832061069}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 216487.39404269482, "episode_reward_mean": 253763.97762029342, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 899.9041725603512}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.177424581718135, "mean_processing_ms": 3.4764412322247966, "mean_inference_ms": 0.8236285139414686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112850944, "num_steps_sampled": 2080000, "sample_time_ms": 164700.017, "load_time_ms": 111.959, "grad_time_ms": 9876.856, "update_time_ms": 3.827, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12857.283203125, "policy_loss": -4.366060238680802e-06, "vf_loss": 12857.291015625, "vf_explained_var": 0.49176907539367676, "kl": 0.0023262756876647472, "entropy": 0.789499044418335, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2080000, "episodes_total": 1599, "training_iteration": 200, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-32-51", "timestamp": 1710322371, "time_this_iter_s": 189.95962572097778, "time_total_s": 29230.320308446884, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29230.320308446884, "timesteps_since_restore": 2080000, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 35.8889298892989, "ram_util_percent": 35.13099630996311}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 219678.59370655267, "episode_reward_mean": 253910.62790159718, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1494.1337554454803}, "policy_reward_mean": {"shared_policy": 900.4242274605385}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.23521087762831, "mean_processing_ms": 3.479132691312807, "mean_inference_ms": 0.823761288436756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113590784, "num_steps_sampled": 2090400, "sample_time_ms": 165667.736, "load_time_ms": 112.754, "grad_time_ms": 9967.162, "update_time_ms": 3.787, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14649.490234375, "policy_loss": 9.639024210628122e-05, "vf_loss": 14649.498046875, "vf_explained_var": 0.49921491742134094, "kl": 0.0019798739813268185, "entropy": 0.7824510931968689, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2090400, "episodes_total": 1607, "training_iteration": 201, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-36-03", "timestamp": 1710322563, "time_this_iter_s": 191.05651950836182, "time_total_s": 29421.376827955246, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29421.376827955246, "timesteps_since_restore": 2090400, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 35.94249084249084, "ram_util_percent": 35.22673992673992}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 219678.59370655267, "episode_reward_mean": 254360.6216128377, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1488.2520761489868}, "policy_reward_mean": {"shared_policy": 902.0200064287304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.290896198730536, "mean_processing_ms": 3.481733781916294, "mean_inference_ms": 0.8238829858213933}, "off_policy_estimator": {}, "info": {"num_steps_trained": 114298752, "num_steps_sampled": 2100800, "sample_time_ms": 166449.292, "load_time_ms": 113.826, "grad_time_ms": 10046.144, "update_time_ms": 3.826, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15706.01171875, "policy_loss": 0.00014979566913098097, "vf_loss": 15706.017578125, "vf_explained_var": 0.4918776750564575, "kl": 0.0020250699017196894, "entropy": 0.7670153379440308, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2100800, "episodes_total": 1615, "training_iteration": 202, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-39-00", "timestamp": 1710322740, "time_this_iter_s": 177.33264589309692, "time_total_s": 29598.709473848343, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29598.709473848343, "timesteps_since_restore": 2100800, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 35.69841897233202, "ram_util_percent": 35.108695652173914}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 219678.59370655267, "episode_reward_mean": 254169.28673863318, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1488.7026064395905}, "policy_reward_mean": {"shared_policy": 901.3414899061428}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.345323054933885, "mean_processing_ms": 3.484269008690847, "mean_inference_ms": 0.8239967007529211}, "off_policy_estimator": {}, "info": {"num_steps_trained": 114999168, "num_steps_sampled": 2111200, "sample_time_ms": 167605.416, "load_time_ms": 115.38, "grad_time_ms": 10105.464, "update_time_ms": 3.775, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16867.3828125, "policy_loss": -7.060296411509626e-06, "vf_loss": 16867.392578125, "vf_explained_var": 0.48681262135505676, "kl": 0.0017081559635698795, "entropy": 0.7721964716911316, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2111200, "episodes_total": 1623, "training_iteration": 203, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-41-59", "timestamp": 1710322919, "time_this_iter_s": 178.92089366912842, "time_total_s": 29777.63036751747, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29777.63036751747, "timesteps_since_restore": 2111200, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 35.292578125, "ram_util_percent": 35.0203125}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 219678.59370655267, "episode_reward_mean": 253401.51421875902, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 898.6187957684989}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.39952476201925, "mean_processing_ms": 3.486778627610327, "mean_inference_ms": 0.8241023724613563}, "off_policy_estimator": {}, "info": {"num_steps_trained": 115699584, "num_steps_sampled": 2121600, "sample_time_ms": 168169.907, "load_time_ms": 115.843, "grad_time_ms": 10139.134, "update_time_ms": 3.819, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17585.76953125, "policy_loss": 9.222337212122511e-06, "vf_loss": 17585.77734375, "vf_explained_var": 0.4936041533946991, "kl": 0.0022051469422876835, "entropy": 0.7467295527458191, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2121600, "episodes_total": 1631, "training_iteration": 204, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-44-56", "timestamp": 1710323096, "time_this_iter_s": 176.99162483215332, "time_total_s": 29954.621992349625, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29954.621992349625, "timesteps_since_restore": 2121600, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 35.336507936507935, "ram_util_percent": 35.07103174603175}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 219678.59370655267, "episode_reward_mean": 252136.8346577497, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 894.1339574373195}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.454557824353714, "mean_processing_ms": 3.489322989846529, "mean_inference_ms": 0.8242093011129756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 116413568, "num_steps_sampled": 2132000, "sample_time_ms": 169674.302, "load_time_ms": 117.891, "grad_time_ms": 10252.776, "update_time_ms": 3.748, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16503.9765625, "policy_loss": 0.0002554950478952378, "vf_loss": 16503.982421875, "vf_explained_var": 0.49037033319473267, "kl": 0.0011977384565398097, "entropy": 0.7485039830207825, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2132000, "episodes_total": 1639, "training_iteration": 205, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-47-57", "timestamp": 1710323277, "time_this_iter_s": 180.26033449172974, "time_total_s": 30134.882326841354, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30134.882326841354, "timesteps_since_restore": 2132000, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 35.31937984496125, "ram_util_percent": 35.13100775193798}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 219678.59370655267, "episode_reward_mean": 249772.72705923847, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -65.73192954063416}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 885.750299866089}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.51110668871192, "mean_processing_ms": 3.49194163547077, "mean_inference_ms": 0.8243236585959031}, "off_policy_estimator": {}, "info": {"num_steps_trained": 117146368, "num_steps_sampled": 2142400, "sample_time_ms": 170823.551, "load_time_ms": 119.916, "grad_time_ms": 10289.735, "update_time_ms": 3.896, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15126.580078125, "policy_loss": 7.627258310094476e-05, "vf_loss": 15126.5888671875, "vf_explained_var": 0.49978557229042053, "kl": 0.0024419885594397783, "entropy": 0.7722119092941284, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2142400, "episodes_total": 1647, "training_iteration": 206, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-51-02", "timestamp": 1710323462, "time_this_iter_s": 184.90322875976562, "time_total_s": 30319.78555560112, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30319.78555560112, "timesteps_since_restore": 2142400, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 35.634469696969695, "ram_util_percent": 35.14090909090909}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275636.60463099607, "episode_reward_min": 212837.18458652106, "episode_reward_mean": 246240.16042554184, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -275.08387564122677}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 873.2230236020491}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.57006793800227, "mean_processing_ms": 3.4946786279819513, "mean_inference_ms": 0.8244452299452288}, "off_policy_estimator": {}, "info": {"num_steps_trained": 117898880, "num_steps_sampled": 2152800, "sample_time_ms": 172183.097, "load_time_ms": 121.745, "grad_time_ms": 10342.855, "update_time_ms": 3.841, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14139.0517578125, "policy_loss": 5.59199252165854e-05, "vf_loss": 14139.060546875, "vf_explained_var": 0.5104888677597046, "kl": 0.0024488666094839573, "entropy": 0.7971502542495728, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2152800, "episodes_total": 1655, "training_iteration": 207, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-54-10", "timestamp": 1710323650, "time_this_iter_s": 188.30960249900818, "time_total_s": 30508.095158100128, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30508.095158100128, "timesteps_since_restore": 2152800, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 36.25410447761193, "ram_util_percent": 35.317537313432844}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 274254.5196720897, "episode_reward_min": 201258.73109513804, "episode_reward_mean": 242006.9668141698, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 858.1807333835808}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.631790891282186, "mean_processing_ms": 3.497560461278282, "mean_inference_ms": 0.8245720831198338}, "off_policy_estimator": {}, "info": {"num_steps_trained": 118672896, "num_steps_sampled": 2163200, "sample_time_ms": 173859.033, "load_time_ms": 124.168, "grad_time_ms": 10388.535, "update_time_ms": 3.765, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13321.7744140625, "policy_loss": -0.0001919723436003551, "vf_loss": 13321.783203125, "vf_explained_var": 0.509949266910553, "kl": 0.003525144886225462, "entropy": 0.8425102233886719, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2163200, "episodes_total": 1663, "training_iteration": 208, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_05-57-23", "timestamp": 1710323843, "time_this_iter_s": 193.19315886497498, "time_total_s": 30701.288316965103, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30701.288316965103, "timesteps_since_restore": 2163200, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 35.47717391304348, "ram_util_percent": 35.35036231884058}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 264761.9419981254, "episode_reward_min": 201258.73109513804, "episode_reward_mean": 239895.45966342583, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 850.6931193738504}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.694126274012945, "mean_processing_ms": 3.5004668212825316, "mean_inference_ms": 0.8247018178343763}, "off_policy_estimator": {}, "info": {"num_steps_trained": 119381632, "num_steps_sampled": 2173600, "sample_time_ms": 173499.065, "load_time_ms": 123.214, "grad_time_ms": 10299.419, "update_time_ms": 3.739, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16604.15625, "policy_loss": 7.645502773812041e-05, "vf_loss": 16604.162109375, "vf_explained_var": 0.5092554092407227, "kl": 0.0017488454468548298, "entropy": 0.8086565136909485, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2173600, "episodes_total": 1671, "training_iteration": 209, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-00-23", "timestamp": 1710324023, "time_this_iter_s": 179.26693272590637, "time_total_s": 30880.55524969101, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30880.55524969101, "timesteps_since_restore": 2173600, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 35.890234375, "ram_util_percent": 35.22734375}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260100.16005301822, "episode_reward_min": 201258.73109513804, "episode_reward_mean": 239404.12385534524, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 848.9507938132813}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.756105495123535, "mean_processing_ms": 3.5033542614184148, "mean_inference_ms": 0.824831094326751}, "off_policy_estimator": {}, "info": {"num_steps_trained": 120074368, "num_steps_sampled": 2184000, "sample_time_ms": 171997.708, "load_time_ms": 120.935, "grad_time_ms": 10260.963, "update_time_ms": 3.611, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17720.19140625, "policy_loss": -0.0001654501975281164, "vf_loss": 17720.19921875, "vf_explained_var": 0.5030375719070435, "kl": 0.003026773687452078, "entropy": 0.8099022507667542, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2184000, "episodes_total": 1679, "training_iteration": 210, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-03-17", "timestamp": 1710324197, "time_this_iter_s": 174.53703236579895, "time_total_s": 31055.09228205681, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31055.09228205681, "timesteps_since_restore": 2184000, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 35.807630522088346, "ram_util_percent": 35.106425702811244}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 258206.5989757809, "episode_reward_min": 201258.73109513804, "episode_reward_mean": 239317.32676522605, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 848.6430027135673}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.81738453409118, "mean_processing_ms": 3.506199725093791, "mean_inference_ms": 0.8249575050448528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 120777472, "num_steps_sampled": 2194400, "sample_time_ms": 170805.416, "load_time_ms": 120.36, "grad_time_ms": 10202.044, "update_time_ms": 3.631, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17660.845703125, "policy_loss": 1.109573076973902e-05, "vf_loss": 17660.853515625, "vf_explained_var": 0.507577121257782, "kl": 0.0028000662568956614, "entropy": 0.8150262832641602, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2194400, "episodes_total": 1687, "training_iteration": 211, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-06-16", "timestamp": 1710324376, "time_this_iter_s": 178.53026604652405, "time_total_s": 31233.622548103333, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31233.622548103333, "timesteps_since_restore": 2194400, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 35.62470588235294, "ram_util_percent": 35.16274509803922}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257636.13551278692, "episode_reward_min": 201258.73109513804, "episode_reward_mean": 239395.03957351352, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 848.9185800479202}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.877295003685795, "mean_processing_ms": 3.5089880601330714, "mean_inference_ms": 0.8250809034769125}, "off_policy_estimator": {}, "info": {"num_steps_trained": 121494912, "num_steps_sampled": 2204800, "sample_time_ms": 171339.67, "load_time_ms": 119.838, "grad_time_ms": 10232.95, "update_time_ms": 3.592, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16441.244140625, "policy_loss": 6.810325430706143e-05, "vf_loss": 16441.25390625, "vf_explained_var": 0.5214593410491943, "kl": 0.0016971135046333075, "entropy": 0.8151218891143799, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2204800, "episodes_total": 1695, "training_iteration": 212, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-09-19", "timestamp": 1710324559, "time_this_iter_s": 182.99405479431152, "time_total_s": 31416.616602897644, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31416.616602897644, "timesteps_since_restore": 2204800, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 35.68429118773946, "ram_util_percent": 35.19655172413792}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257636.13551278692, "episode_reward_min": 201258.73109513804, "episode_reward_mean": 239225.91603563662, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 848.34893448575}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.93591003276847, "mean_processing_ms": 3.511706752567042, "mean_inference_ms": 0.8252024688051328}, "off_policy_estimator": {}, "info": {"num_steps_trained": 122222720, "num_steps_sampled": 2215200, "sample_time_ms": 172039.666, "load_time_ms": 120.315, "grad_time_ms": 10301.775, "update_time_ms": 3.635, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15983.240234375, "policy_loss": -7.966512202983722e-05, "vf_loss": 15983.2490234375, "vf_explained_var": 0.5308141708374023, "kl": 0.0020670443773269653, "entropy": 0.8459389209747314, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2215200, "episodes_total": 1703, "training_iteration": 213, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-12-26", "timestamp": 1710324746, "time_this_iter_s": 186.61398649215698, "time_total_s": 31603.2305893898, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31603.2305893898, "timesteps_since_restore": 2215200, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 35.68089887640449, "ram_util_percent": 35.2063670411985}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257636.13551278692, "episode_reward_min": 201258.73109513804, "episode_reward_mean": 236480.5142324816, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 838.6131218570927}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.99550117428712, "mean_processing_ms": 3.5144663273815215, "mean_inference_ms": 0.8253283456780508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 122977024, "num_steps_sampled": 2225600, "sample_time_ms": 173650.545, "load_time_ms": 121.17, "grad_time_ms": 10393.081, "update_time_ms": 3.641, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14276.6943359375, "policy_loss": 0.00014457645011134446, "vf_loss": 14276.7021484375, "vf_explained_var": 0.5350956320762634, "kl": 0.0020059896633028984, "entropy": 0.8685160279273987, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2225600, "episodes_total": 1711, "training_iteration": 214, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-15-40", "timestamp": 1710324940, "time_this_iter_s": 194.04515743255615, "time_total_s": 31797.275746822357, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31797.275746822357, "timesteps_since_restore": 2225600, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 35.75595667870036, "ram_util_percent": 35.27436823104693}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 256559.64748296863, "episode_reward_min": 188321.79591376072, "episode_reward_mean": 232349.97992431076, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 823.9653176506641}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.05759446422559, "mean_processing_ms": 3.517326413364782, "mean_inference_ms": 0.8254571567879578}, "off_policy_estimator": {}, "info": {"num_steps_trained": 123771904, "num_steps_sampled": 2236000, "sample_time_ms": 175571.498, "load_time_ms": 123.081, "grad_time_ms": 10535.998, "update_time_ms": 3.761, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12532.650390625, "policy_loss": -7.005214865785092e-05, "vf_loss": 12532.6591796875, "vf_explained_var": 0.5562193989753723, "kl": 0.0022802846506237984, "entropy": 0.8890345692634583, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2236000, "episodes_total": 1719, "training_iteration": 215, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-19-01", "timestamp": 1710325141, "time_this_iter_s": 200.92154216766357, "time_total_s": 31998.19728899002, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31998.19728899002, "timesteps_since_restore": 2236000, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 35.056794425087105, "ram_util_percent": 35.162717770034845}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 256559.64748296863, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 228486.07581703927, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1501.9514129161835}, "policy_reward_mean": {"shared_policy": 810.2630441400023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.12204904413531, "mean_processing_ms": 3.5203005269874383, "mean_inference_ms": 0.825592387442332}, "off_policy_estimator": {}, "info": {"num_steps_trained": 124557824, "num_steps_sampled": 2246400, "sample_time_ms": 177002.463, "load_time_ms": 124.317, "grad_time_ms": 10635.182, "update_time_ms": 3.614, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12548.46875, "policy_loss": -0.00012805580627173185, "vf_loss": 12548.478515625, "vf_explained_var": 0.5764923691749573, "kl": 0.0030567666981369257, "entropy": 0.8827706575393677, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2246400, "episodes_total": 1727, "training_iteration": 216, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-22-22", "timestamp": 1710325342, "time_this_iter_s": 200.227192401886, "time_total_s": 32198.424481391907, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32198.424481391907, "timesteps_since_restore": 2246400, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 35.39895104895105, "ram_util_percent": 35.32937062937063}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 256559.64748296863, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 226198.77191722448, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1498.878511428833}, "policy_reward_mean": {"shared_policy": 802.1517497685182}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.18857441757709, "mean_processing_ms": 3.523374041038383, "mean_inference_ms": 0.8257374656277168}, "off_policy_estimator": {}, "info": {"num_steps_trained": 125326080, "num_steps_sampled": 2256800, "sample_time_ms": 177924.233, "load_time_ms": 125.722, "grad_time_ms": 10771.679, "update_time_ms": 3.636, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13346.4072265625, "policy_loss": 3.037964961549733e-05, "vf_loss": 13346.41796875, "vf_explained_var": 0.5881941318511963, "kl": 0.0019262724090367556, "entropy": 0.8494306206703186, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2256800, "episodes_total": 1735, "training_iteration": 217, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-25-41", "timestamp": 1710325541, "time_this_iter_s": 198.92048573493958, "time_total_s": 32397.344967126846, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32397.344967126846, "timesteps_since_restore": 2256800, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 35.939436619718315, "ram_util_percent": 35.13415492957747}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 256559.64748296863, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 225275.27592165268, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1498.878511428833}, "policy_reward_mean": {"shared_policy": 798.8768251415039}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.25558811445375, "mean_processing_ms": 3.526468515669517, "mean_inference_ms": 0.8258877920673673}, "off_policy_estimator": {}, "info": {"num_steps_trained": 126062336, "num_steps_sampled": 2267200, "sample_time_ms": 177691.951, "load_time_ms": 126.296, "grad_time_ms": 10827.707, "update_time_ms": 3.586, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13764.7900390625, "policy_loss": -0.0001162677290267311, "vf_loss": 13764.796875, "vf_explained_var": 0.5838088393211365, "kl": 0.0029714161064475775, "entropy": 0.8243941068649292, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2267200, "episodes_total": 1743, "training_iteration": 218, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-28-52", "timestamp": 1710325732, "time_this_iter_s": 191.44767045974731, "time_total_s": 32588.792637586594, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32588.792637586594, "timesteps_since_restore": 2267200, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 36.31794871794872, "ram_util_percent": 35.21831501831501}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257757.47005762765, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 227133.43220141987, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -354.52614260837436}, "policy_reward_max": {"shared_policy": 1498.878511428833}, "policy_reward_mean": {"shared_policy": 805.4662654754421}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.32126005470234, "mean_processing_ms": 3.5294899011567806, "mean_inference_ms": 0.8260356142276702}, "off_policy_estimator": {}, "info": {"num_steps_trained": 126766336, "num_steps_sampled": 2277600, "sample_time_ms": 177757.331, "load_time_ms": 126.611, "grad_time_ms": 10909.715, "update_time_ms": 3.671, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15440.1103515625, "policy_loss": 2.770467290247325e-05, "vf_loss": 15440.1181640625, "vf_explained_var": 0.5842202305793762, "kl": 0.002867296105250716, "entropy": 0.7812337279319763, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2277600, "episodes_total": 1751, "training_iteration": 219, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-31-53", "timestamp": 1710325913, "time_this_iter_s": 180.7524962425232, "time_total_s": 32769.54513382912, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32769.54513382912, "timesteps_since_restore": 2277600, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 35.76472868217055, "ram_util_percent": 35.39728682170543}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269668.5478815611, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 230033.7546718457, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 815.7803910626487}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.38495764477929, "mean_processing_ms": 3.5324052154294656, "mean_inference_ms": 0.826183421563116}, "off_policy_estimator": {}, "info": {"num_steps_trained": 127456000, "num_steps_sampled": 2288000, "sample_time_ms": 178683.506, "load_time_ms": 127.318, "grad_time_ms": 10931.294, "update_time_ms": 3.834, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15794.921875, "policy_loss": 0.00025116061442531645, "vf_loss": 15794.9296875, "vf_explained_var": 0.5734640955924988, "kl": 0.0015395588707178831, "entropy": 0.7810394167900085, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2288000, "episodes_total": 1759, "training_iteration": 220, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-34-57", "timestamp": 1710326097, "time_this_iter_s": 184.03400373458862, "time_total_s": 32953.579137563705, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32953.579137563705, "timesteps_since_restore": 2288000, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 35.034980988593155, "ram_util_percent": 35.16121673003802}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269668.5478815611, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 232854.15711459142, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 825.782527535965}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.44624719962949, "mean_processing_ms": 3.535204889796757, "mean_inference_ms": 0.8263347215053299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 128118016, "num_steps_sampled": 2298400, "sample_time_ms": 178148.422, "load_time_ms": 127.729, "grad_time_ms": 10896.353, "update_time_ms": 3.83, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17159.376953125, "policy_loss": 0.0002202008618041873, "vf_loss": 17159.384765625, "vf_explained_var": 0.567478358745575, "kl": 0.0022270758636295795, "entropy": 0.7605612277984619, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2298400, "episodes_total": 1767, "training_iteration": 221, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-37-50", "timestamp": 1710326270, "time_this_iter_s": 172.83624386787415, "time_total_s": 33126.41538143158, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33126.41538143158, "timesteps_since_restore": 2298400, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 35.89149797570849, "ram_util_percent": 35.29757085020241}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 234493.60348045084, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 831.5965794753204}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.50617683444509, "mean_processing_ms": 3.537946198511081, "mean_inference_ms": 0.8264875746905134}, "off_policy_estimator": {}, "info": {"num_steps_trained": 128767104, "num_steps_sampled": 2308800, "sample_time_ms": 176779.136, "load_time_ms": 127.927, "grad_time_ms": 10803.861, "update_time_ms": 3.867, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17296.50390625, "policy_loss": 6.405048770830035e-05, "vf_loss": 17296.513671875, "vf_explained_var": 0.5623095631599426, "kl": 0.0025893973652273417, "entropy": 0.7804876565933228, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2308800, "episodes_total": 1775, "training_iteration": 222, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-40-39", "timestamp": 1710326439, "time_this_iter_s": 168.40277647972107, "time_total_s": 33294.8181579113, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33294.8181579113, "timesteps_since_restore": 2308800, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 35.6792531120332, "ram_util_percent": 35.38008298755185}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 234357.0467398241, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 831.1123013682674}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.56602341936013, "mean_processing_ms": 3.5406874655378124, "mean_inference_ms": 0.8266477857728609}, "off_policy_estimator": {}, "info": {"num_steps_trained": 129465216, "num_steps_sampled": 2319200, "sample_time_ms": 176120.497, "load_time_ms": 128.741, "grad_time_ms": 10752.734, "update_time_ms": 3.848, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15113.9716796875, "policy_loss": 0.00014744936197530478, "vf_loss": 15113.98046875, "vf_explained_var": 0.5704215168952942, "kl": 0.0018932200036942959, "entropy": 0.836567223072052, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2319200, "episodes_total": 1783, "training_iteration": 223, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-43-39", "timestamp": 1710326619, "time_this_iter_s": 179.52227091789246, "time_total_s": 33474.34042882919, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33474.34042882919, "timesteps_since_restore": 2319200, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 35.839453125, "ram_util_percent": 35.41562499999999}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 233360.3367407805, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 827.5776180607864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.626953651597994, "mean_processing_ms": 3.543478859613192, "mean_inference_ms": 0.8268179555219132}, "off_policy_estimator": {}, "info": {"num_steps_trained": 130210944, "num_steps_sampled": 2329600, "sample_time_ms": 175993.803, "load_time_ms": 129.001, "grad_time_ms": 10658.12, "update_time_ms": 3.801, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13166.0146484375, "policy_loss": 0.0001491311122663319, "vf_loss": 13166.0224609375, "vf_explained_var": 0.581261932849884, "kl": 0.002052725525572896, "entropy": 0.8409730195999146, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2329600, "episodes_total": 1791, "training_iteration": 224, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-46-51", "timestamp": 1710326811, "time_this_iter_s": 191.82162857055664, "time_total_s": 33666.16205739975, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33666.16205739975, "timesteps_since_restore": 2329600, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 36.03357664233577, "ram_util_percent": 35.23576642335766}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 233428.87034255543, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 827.8206622546116}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.68819500350255, "mean_processing_ms": 3.5462839451866, "mean_inference_ms": 0.826991261620872}, "off_policy_estimator": {}, "info": {"num_steps_trained": 130952704, "num_steps_sampled": 2340000, "sample_time_ms": 175155.005, "load_time_ms": 128.765, "grad_time_ms": 10573.662, "update_time_ms": 3.738, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13454.21875, "policy_loss": 6.40695943729952e-05, "vf_loss": 13454.2275390625, "vf_explained_var": 0.598526120185852, "kl": 0.0022331159561872482, "entropy": 0.8231452703475952, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2340000, "episodes_total": 1799, "training_iteration": 225, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-50-03", "timestamp": 1710327003, "time_this_iter_s": 191.68443036079407, "time_total_s": 33857.846487760544, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33857.846487760544, "timesteps_since_restore": 2340000, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 36.18205128205128, "ram_util_percent": 35.24652014652014}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 234192.4459284104, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 830.4991167360912}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.749655403274225, "mean_processing_ms": 3.549097353009466, "mean_inference_ms": 0.8271634581569199}, "off_policy_estimator": {}, "info": {"num_steps_trained": 131711744, "num_steps_sampled": 2350400, "sample_time_ms": 174705.684, "load_time_ms": 129.564, "grad_time_ms": 10590.109, "update_time_ms": 3.695, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12738.552734375, "policy_loss": 0.00016668031457811594, "vf_loss": 12738.560546875, "vf_explained_var": 0.6132270097732544, "kl": 0.0018124454654753208, "entropy": 0.7969404458999634, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2350400, "episodes_total": 1807, "training_iteration": 226, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-53-19", "timestamp": 1710327199, "time_this_iter_s": 195.91447734832764, "time_total_s": 34053.76096510887, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34053.76096510887, "timesteps_since_restore": 2350400, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 35.738571428571426, "ram_util_percent": 35.42928571428572}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 236935.4691749578, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 840.2264944677393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.80958912159153, "mean_processing_ms": 3.551842001405441, "mean_inference_ms": 0.8273360131234448}, "off_policy_estimator": {}, "info": {"num_steps_trained": 132458240, "num_steps_sampled": 2360800, "sample_time_ms": 173885.599, "load_time_ms": 130.732, "grad_time_ms": 10531.875, "update_time_ms": 3.745, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13091.009765625, "policy_loss": 0.00021043966989964247, "vf_loss": 13091.0166015625, "vf_explained_var": 0.6146560311317444, "kl": 0.0017394545720890164, "entropy": 0.7883497476577759, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2360800, "episodes_total": 1815, "training_iteration": 227, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-56-29", "timestamp": 1710327389, "time_this_iter_s": 190.15405774116516, "time_total_s": 34243.91502285004, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34243.91502285004, "timesteps_since_restore": 2360800, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 35.8625, "ram_util_percent": 35.36911764705883}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 183804.80503243912, "episode_reward_mean": 240657.98973680913, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -196.66782101988792}, "policy_reward_max": {"shared_policy": 1501.3938767910004}, "policy_reward_mean": {"shared_policy": 853.4273901089016}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.86662220737262, "mean_processing_ms": 3.5544399431240414, "mean_inference_ms": 0.8275053089582154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 133161984, "num_steps_sampled": 2371200, "sample_time_ms": 172886.071, "load_time_ms": 129.936, "grad_time_ms": 10488.758, "update_time_ms": 3.845, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14700.0810546875, "policy_loss": 0.0001464903907617554, "vf_loss": 14700.0888671875, "vf_explained_var": 0.613349437713623, "kl": 0.002004572656005621, "entropy": 0.7634791731834412, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2371200, "episodes_total": 1823, "training_iteration": 228, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_06-59-30", "timestamp": 1710327570, "time_this_iter_s": 181.01196908950806, "time_total_s": 34424.926991939545, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34424.926991939545, "timesteps_since_restore": 2371200, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 35.315891472868216, "ram_util_percent": 35.23100775193799}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 212870.82667563605, "episode_reward_mean": 244355.1261654171, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1504.1343021392822}, "policy_reward_mean": {"shared_policy": 866.5382679010503}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.92055282850272, "mean_processing_ms": 3.556894171065116, "mean_inference_ms": 0.8276719336663817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 133856640, "num_steps_sampled": 2381600, "sample_time_ms": 173040.116, "load_time_ms": 130.947, "grad_time_ms": 10469.61, "update_time_ms": 3.823, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15407.3544921875, "policy_loss": 0.00028740501147694886, "vf_loss": 15407.361328125, "vf_explained_var": 0.6115928292274475, "kl": 0.001940016052685678, "entropy": 0.7167262434959412, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2381600, "episodes_total": 1831, "training_iteration": 229, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-02-32", "timestamp": 1710327752, "time_this_iter_s": 182.1257905960083, "time_total_s": 34607.05278253555, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34607.05278253555, "timesteps_since_restore": 2381600, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 35.56346153846154, "ram_util_percent": 35.35192307692308}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 217292.2387172276, "episode_reward_mean": 246464.91676406268, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1505.220768213272}, "policy_reward_mean": {"shared_policy": 874.020060158384}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.97187022698878, "mean_processing_ms": 3.559234205602129, "mean_inference_ms": 0.8278323917268432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 134545408, "num_steps_sampled": 2392000, "sample_time_ms": 172297.571, "load_time_ms": 128.94, "grad_time_ms": 10449.984, "update_time_ms": 3.692, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16032.966796875, "policy_loss": 0.00033876311499625444, "vf_loss": 16032.9736328125, "vf_explained_var": 0.6038370132446289, "kl": 0.0017964980797842145, "entropy": 0.70607990026474, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2392000, "episodes_total": 1839, "training_iteration": 230, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-05-29", "timestamp": 1710327929, "time_this_iter_s": 176.38142371177673, "time_total_s": 34783.43420624733, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34783.43420624733, "timesteps_since_restore": 2392000, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 35.81111111111112, "ram_util_percent": 35.39365079365079}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272175.3194385704, "episode_reward_min": 217292.2387172276, "episode_reward_mean": 248182.13208602, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1505.220768213272}, "policy_reward_mean": {"shared_policy": 880.1409039152423}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.02090083705576, "mean_processing_ms": 3.561475559233711, "mean_inference_ms": 0.827983156742877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 135212032, "num_steps_sampled": 2402400, "sample_time_ms": 172107.4, "load_time_ms": 128.275, "grad_time_ms": 10439.808, "update_time_ms": 3.722, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16561.908203125, "policy_loss": 0.00023039575899019837, "vf_loss": 16561.9140625, "vf_explained_var": 0.598598301410675, "kl": 0.0020635772962123156, "entropy": 0.6965633034706116, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2402400, "episodes_total": 1847, "training_iteration": 231, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-08-20", "timestamp": 1710328100, "time_this_iter_s": 170.81716632843018, "time_total_s": 34954.25137257576, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34954.25137257576, "timesteps_since_restore": 2402400, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 35.70737704918032, "ram_util_percent": 35.308196721311475}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275205.8734835638, "episode_reward_min": 217292.2387172276, "episode_reward_mean": 249256.3535650595, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1507.7133040428162}, "policy_reward_mean": {"shared_policy": 883.9191232492623}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.067821404358234, "mean_processing_ms": 3.563624676053179, "mean_inference_ms": 0.8281251484489077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 135863040, "num_steps_sampled": 2412800, "sample_time_ms": 172083.088, "load_time_ms": 129.295, "grad_time_ms": 10413.34, "update_time_ms": 3.738, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17478.046875, "policy_loss": 0.00029281203751452267, "vf_loss": 17478.052734375, "vf_explained_var": 0.5927644968032837, "kl": 0.0023303329944610596, "entropy": 0.6817446947097778, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2412800, "episodes_total": 1855, "training_iteration": 232, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-11-08", "timestamp": 1710328268, "time_this_iter_s": 167.8594172000885, "time_total_s": 35122.11078977585, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35122.11078977585, "timesteps_since_restore": 2412800, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 35.18541666666667, "ram_util_percent": 35.341249999999995}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 217292.2387172276, "episode_reward_mean": 249796.8406720732, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1507.7133040428162}, "policy_reward_mean": {"shared_policy": 885.8358121638114}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.11302404757554, "mean_processing_ms": 3.56571178777987, "mean_inference_ms": 0.8282598906497798}, "off_policy_estimator": {}, "info": {"num_steps_trained": 136520832, "num_steps_sampled": 2423200, "sample_time_ms": 171187.945, "load_time_ms": 126.062, "grad_time_ms": 10283.262, "update_time_ms": 3.701, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17351.583984375, "policy_loss": 0.00036282785004004836, "vf_loss": 17351.58984375, "vf_explained_var": 0.5812350511550903, "kl": 0.0022038850001990795, "entropy": 0.7222753167152405, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2423200, "episodes_total": 1863, "training_iteration": 233, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-13-57", "timestamp": 1710328437, "time_this_iter_s": 169.2133982181549, "time_total_s": 35291.324187994, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35291.324187994, "timesteps_since_restore": 2423200, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 35.509504132231406, "ram_util_percent": 35.46900826446281}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 217292.2387172276, "episode_reward_mean": 249771.3826132056, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1512.3952889442444}, "policy_reward_mean": {"shared_policy": 885.7769438017078}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.15742366769395, "mean_processing_ms": 3.5677757337670846, "mean_inference_ms": 0.8283878329584105}, "off_policy_estimator": {}, "info": {"num_steps_trained": 137177856, "num_steps_sampled": 2433600, "sample_time_ms": 168993.435, "load_time_ms": 123.94, "grad_time_ms": 10229.459, "update_time_ms": 3.77, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17370.345703125, "policy_loss": 0.00037281023105606437, "vf_loss": 17370.3515625, "vf_explained_var": 0.5830600261688232, "kl": 0.0019331446383148432, "entropy": 0.7090643048286438, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2433600, "episodes_total": 1871, "training_iteration": 234, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-16-47", "timestamp": 1710328607, "time_this_iter_s": 169.31547474861145, "time_total_s": 35460.639662742615, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35460.639662742615, "timesteps_since_restore": 2433600, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 36.128630705394194, "ram_util_percent": 35.516597510373444}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 217292.2387172276, "episode_reward_mean": 250372.3336632133, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1512.3952889442444}, "policy_reward_mean": {"shared_policy": 887.9081270416812}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.20083485953994, "mean_processing_ms": 3.5697851038875887, "mean_inference_ms": 0.8285059991635996}, "off_policy_estimator": {}, "info": {"num_steps_trained": 137843584, "num_steps_sampled": 2444000, "sample_time_ms": 166754.092, "load_time_ms": 120.722, "grad_time_ms": 10101.503, "update_time_ms": 3.849, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17272.349609375, "policy_loss": 0.00018205402011517435, "vf_loss": 17272.35546875, "vf_explained_var": 0.5847546458244324, "kl": 0.002324445638805628, "entropy": 0.6899539828300476, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2444000, "episodes_total": 1879, "training_iteration": 235, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-19-35", "timestamp": 1710328775, "time_this_iter_s": 167.9603407382965, "time_total_s": 35628.60000348091, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35628.60000348091, "timesteps_since_restore": 2444000, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 35.65708333333334, "ram_util_percent": 35.428749999999994}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 221081.67960407923, "episode_reward_mean": 252206.506071015, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -84.84667992591858}, "policy_reward_max": {"shared_policy": 1513.6146621704102}, "policy_reward_mean": {"shared_policy": 894.4127458366372}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.24187289422697, "mean_processing_ms": 3.5716859038670306, "mean_inference_ms": 0.8286096227731687}, "off_policy_estimator": {}, "info": {"num_steps_trained": 138514176, "num_steps_sampled": 2454400, "sample_time_ms": 164460.967, "load_time_ms": 116.227, "grad_time_ms": 9950.771, "update_time_ms": 3.929, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16927.439453125, "policy_loss": 0.00035042318631894886, "vf_loss": 16927.4453125, "vf_explained_var": 0.5858034491539001, "kl": 0.0021161518525332212, "entropy": 0.6748374104499817, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2454400, "episodes_total": 1887, "training_iteration": 236, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-22-27", "timestamp": 1710328947, "time_this_iter_s": 171.4069197177887, "time_total_s": 35800.0069231987, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35800.0069231987, "timesteps_since_restore": 2454400, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 35.431836734693874, "ram_util_percent": 35.42244897959183}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 226631.20060570558, "episode_reward_mean": 254480.53518373083, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.480074644088745}, "policy_reward_max": {"shared_policy": 1519.7609651088715}, "policy_reward_mean": {"shared_policy": 902.4772508111596}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.27951877249526, "mean_processing_ms": 3.573431318967531, "mean_inference_ms": 0.8286982746504756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139169536, "num_steps_sampled": 2464800, "sample_time_ms": 162536.6, "load_time_ms": 111.559, "grad_time_ms": 9791.874, "update_time_ms": 3.967, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17610.205078125, "policy_loss": 0.0004296652914490551, "vf_loss": 17610.208984375, "vf_explained_var": 0.5870610475540161, "kl": 0.002507396973669529, "entropy": 0.6764056086540222, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2464800, "episodes_total": 1895, "training_iteration": 237, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-25-16", "timestamp": 1710329116, "time_this_iter_s": 169.2601261138916, "time_total_s": 35969.26704931259, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35969.26704931259, "timesteps_since_restore": 2464800, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 35.299586776859506, "ram_util_percent": 35.383471074380154}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 229483.3001492106, "episode_reward_mean": 257045.71069624234, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.480074644088745}, "policy_reward_max": {"shared_policy": 1519.7609651088715}, "policy_reward_mean": {"shared_policy": 911.5742630549769}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.313661499080425, "mean_processing_ms": 3.5750146556588476, "mean_inference_ms": 0.8287755647991293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139827072, "num_steps_sampled": 2475200, "sample_time_ms": 161284.775, "load_time_ms": 108.639, "grad_time_ms": 9689.452, "update_time_ms": 4.122, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17100.146484375, "policy_loss": 0.0002715353621169925, "vf_loss": 17100.154296875, "vf_explained_var": 0.5849129557609558, "kl": 0.0024806163273751736, "entropy": 0.645248532295227, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2475200, "episodes_total": 1903, "training_iteration": 238, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-28-04", "timestamp": 1710329284, "time_this_iter_s": 167.42453742027283, "time_total_s": 36136.691586732864, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36136.691586732864, "timesteps_since_restore": 2475200, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 35.22301255230125, "ram_util_percent": 35.434728033472794}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 231245.80355957252, "episode_reward_mean": 258350.77190913536, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.480074644088745}, "policy_reward_max": {"shared_policy": 1519.7609651088715}, "policy_reward_mean": {"shared_policy": 916.2349608438321}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.34517588525583, "mean_processing_ms": 3.5764837434754577, "mean_inference_ms": 0.8288461975474545}, "off_policy_estimator": {}, "info": {"num_steps_trained": 140508416, "num_steps_sampled": 2485600, "sample_time_ms": 160386.078, "load_time_ms": 107.281, "grad_time_ms": 9637.07, "update_time_ms": 4.105, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16148.3115234375, "policy_loss": 0.00053253403166309, "vf_loss": 16148.3193359375, "vf_explained_var": 0.5888010263442993, "kl": 0.002301743719726801, "entropy": 0.7197739481925964, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2485600, "episodes_total": 1911, "training_iteration": 239, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-30-56", "timestamp": 1710329456, "time_this_iter_s": 172.5796513557434, "time_total_s": 36309.27123808861, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36309.27123808861, "timesteps_since_restore": 2485600, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 35.708130081300816, "ram_util_percent": 35.41991869918697}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 240312.9696941428, "episode_reward_mean": 258976.57986318268, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 3.480074644088745}, "policy_reward_max": {"shared_policy": 1519.7609651088715}, "policy_reward_mean": {"shared_policy": 918.4543740936365}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.374666940287504, "mean_processing_ms": 3.577860957481718, "mean_inference_ms": 0.8289112020905756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141178496, "num_steps_sampled": 2496000, "sample_time_ms": 159983.845, "load_time_ms": 107.09, "grad_time_ms": 9594.574, "update_time_ms": 4.191, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16476.76953125, "policy_loss": 0.00043682774412445724, "vf_loss": 16476.775390625, "vf_explained_var": 0.585079550743103, "kl": 0.0020619798451662064, "entropy": 0.7193370461463928, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2496000, "episodes_total": 1919, "training_iteration": 240, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-33-48", "timestamp": 1710329628, "time_this_iter_s": 171.92892980575562, "time_total_s": 36481.20016789436, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36481.20016789436, "timesteps_since_restore": 2496000, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 35.73943089430894, "ram_util_percent": 35.337804878048786}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 240312.9696941428, "episode_reward_mean": 259071.7426218319, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.604814291000366}, "policy_reward_max": {"shared_policy": 1519.7609651088715}, "policy_reward_mean": {"shared_policy": 918.791866588048}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.40282756625942, "mean_processing_ms": 3.5791776058590195, "mean_inference_ms": 0.8289681207374856}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141852288, "num_steps_sampled": 2506400, "sample_time_ms": 160032.9, "load_time_ms": 106.038, "grad_time_ms": 9594.656, "update_time_ms": 4.15, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16084.0439453125, "policy_loss": 0.0003992620622739196, "vf_loss": 16084.0517578125, "vf_explained_var": 0.5892229676246643, "kl": 0.00222880020737648, "entropy": 0.7158235311508179, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2506400, "episodes_total": 1927, "training_iteration": 241, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-36-40", "timestamp": 1710329800, "time_this_iter_s": 171.2994885444641, "time_total_s": 36652.49965643883, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36652.49965643883, "timesteps_since_restore": 2506400, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 35.625, "ram_util_percent": 35.35983606557377}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 233273.19153159272, "episode_reward_mean": 258761.96795235373, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.604814291000366}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 917.6932579790538}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.430273216384215, "mean_processing_ms": 3.5804606805859356, "mean_inference_ms": 0.8290179240694516}, "off_policy_estimator": {}, "info": {"num_steps_trained": 142535808, "num_steps_sampled": 2516800, "sample_time_ms": 161091.849, "load_time_ms": 104.496, "grad_time_ms": 9647.04, "update_time_ms": 4.159, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15813.1298828125, "policy_loss": 0.0004058660997543484, "vf_loss": 15813.1357421875, "vf_explained_var": 0.6006006598472595, "kl": 0.0026183868758380413, "entropy": 0.6972888708114624, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2516800, "episodes_total": 1935, "training_iteration": 242, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-39-39", "timestamp": 1710329979, "time_this_iter_s": 178.97161960601807, "time_total_s": 36831.471276044846, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36831.471276044846, "timesteps_since_restore": 2516800, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 35.260546875, "ram_util_percent": 35.432031249999994}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 233273.19153159272, "episode_reward_mean": 257721.5522718034, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.604814291000366}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 913.9710343705348}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.457905859821004, "mean_processing_ms": 3.5817416256013996, "mean_inference_ms": 0.8290655943663257}, "off_policy_estimator": {}, "info": {"num_steps_trained": 143233536, "num_steps_sampled": 2527200, "sample_time_ms": 161851.598, "load_time_ms": 105.686, "grad_time_ms": 9764.908, "update_time_ms": 4.229, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15167.640625, "policy_loss": 0.0004454769950825721, "vf_loss": 15167.646484375, "vf_explained_var": 0.6156551241874695, "kl": 0.0028399352449923754, "entropy": 0.6912144422531128, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2527200, "episodes_total": 1943, "training_iteration": 243, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-42-37", "timestamp": 1710330157, "time_this_iter_s": 178.01695156097412, "time_total_s": 37009.48822760582, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37009.48822760582, "timesteps_since_restore": 2527200, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 35.50236220472442, "ram_util_percent": 35.43503937007874}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 225283.00604011302, "episode_reward_mean": 255501.41575081184, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.604814291000366}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 906.0976514320583}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.487168907426764, "mean_processing_ms": 3.5831022130255077, "mean_inference_ms": 0.8291193985292636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 143954432, "num_steps_sampled": 2537600, "sample_time_ms": 163479.102, "load_time_ms": 106.272, "grad_time_ms": 9782.429, "update_time_ms": 4.2, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14244.5, "policy_loss": 0.00041131945909000933, "vf_loss": 14244.5068359375, "vf_explained_var": 0.6254062056541443, "kl": 0.002561350353062153, "entropy": 0.7392534613609314, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2537600, "episodes_total": 1951, "training_iteration": 244, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-45-43", "timestamp": 1710330343, "time_this_iter_s": 185.77452445030212, "time_total_s": 37195.26275205612, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37195.26275205612, "timesteps_since_restore": 2537600, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 35.53849056603774, "ram_util_percent": 35.41962264150943}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276698.8386681599, "episode_reward_min": 225283.00604011302, "episode_reward_mean": 252979.2765121166, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.604814291000366}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 897.1850782427797}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.51794784245354, "mean_processing_ms": 3.584531100638825, "mean_inference_ms": 0.8291784812066614}, "off_policy_estimator": {}, "info": {"num_steps_trained": 144667904, "num_steps_sampled": 2548000, "sample_time_ms": 164814.425, "load_time_ms": 107.611, "grad_time_ms": 9844.366, "update_time_ms": 4.104, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14686.09375, "policy_loss": 0.0003843900631181896, "vf_loss": 14686.1015625, "vf_explained_var": 0.6309187412261963, "kl": 0.002953043906018138, "entropy": 0.7368775606155396, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2548000, "episodes_total": 1959, "training_iteration": 245, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-48-45", "timestamp": 1710330525, "time_this_iter_s": 181.96569728851318, "time_total_s": 37377.228449344635, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37377.228449344635, "timesteps_since_restore": 2548000, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 36.34653846153846, "ram_util_percent": 35.51730769230769}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 270951.2802445172, "episode_reward_min": 225283.00604011302, "episode_reward_mean": 251021.77657195798, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.604814291000366}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 890.2112794239235}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.549963192573266, "mean_processing_ms": 3.5860066059917575, "mean_inference_ms": 0.8292378538781926}, "off_policy_estimator": {}, "info": {"num_steps_trained": 145387264, "num_steps_sampled": 2558400, "sample_time_ms": 165818.66, "load_time_ms": 109.943, "grad_time_ms": 9919.285, "update_time_ms": 4.229, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14501.8310546875, "policy_loss": 0.00033476739190518856, "vf_loss": 14501.8359375, "vf_explained_var": 0.6330175995826721, "kl": 0.0030475473031401634, "entropy": 0.7126734852790833, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2558400, "episodes_total": 1967, "training_iteration": 246, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-51-48", "timestamp": 1710330708, "time_this_iter_s": 182.23239541053772, "time_total_s": 37559.46084475517, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37559.46084475517, "timesteps_since_restore": 2558400, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 35.620384615384616, "ram_util_percent": 35.60269230769231}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269120.808338917, "episode_reward_min": 225283.00604011302, "episode_reward_mean": 248628.85235262715, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.6502242255955935}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 881.7251306923438}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.58392650186998, "mean_processing_ms": 3.587552941186792, "mean_inference_ms": 0.8293013950603574}, "off_policy_estimator": {}, "info": {"num_steps_trained": 146118656, "num_steps_sampled": 2568800, "sample_time_ms": 167213.917, "load_time_ms": 111.782, "grad_time_ms": 10031.676, "update_time_ms": 4.203, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13800.9169921875, "policy_loss": 0.004117089323699474, "vf_loss": 13800.9208984375, "vf_explained_var": 0.6444535851478577, "kl": 1.5680913925170898, "entropy": 0.7237877249717712, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2568800, "episodes_total": 1975, "training_iteration": 247, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-54-52", "timestamp": 1710330892, "time_this_iter_s": 184.35864210128784, "time_total_s": 37743.81948685646, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37743.81948685646, "timesteps_since_restore": 2568800, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 35.83992395437263, "ram_util_percent": 35.53155893536121}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269120.808338917, "episode_reward_min": 225283.00604011302, "episode_reward_mean": 246709.73166459988, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.6502242255955935}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 874.9192554954246}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.61915309858904, "mean_processing_ms": 3.589168372210887, "mean_inference_ms": 0.8293703386006076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 146837504, "num_steps_sampled": 2579200, "sample_time_ms": 168863.227, "load_time_ms": 113.642, "grad_time_ms": 10132.251, "update_time_ms": 4.006, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14340.310546875, "policy_loss": 0.004375206306576729, "vf_loss": 14340.3134765625, "vf_explained_var": 0.6494750380516052, "kl": 2.240151882171631, "entropy": 0.6684475541114807, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2579200, "episodes_total": 1983, "training_iteration": 248, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_07-57-57", "timestamp": 1710331077, "time_this_iter_s": 184.94654989242554, "time_total_s": 37928.766036748886, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37928.766036748886, "timesteps_since_restore": 2579200, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 35.53962264150943, "ram_util_percent": 35.46339622641509}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 269120.808338917, "episode_reward_min": 224467.198661424, "episode_reward_mean": 245014.1444973949, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.6502242255955935}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 868.9061085800229}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.65577990200729, "mean_processing_ms": 3.5908407431332456, "mean_inference_ms": 0.8294431749917117}, "off_policy_estimator": {}, "info": {"num_steps_trained": 147569280, "num_steps_sampled": 2589600, "sample_time_ms": 170137.872, "load_time_ms": 115.227, "grad_time_ms": 10200.305, "update_time_ms": 4.047, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14080.6240234375, "policy_loss": 0.0033123469911515713, "vf_loss": 14080.626953125, "vf_explained_var": 0.6538606882095337, "kl": 1.8430417776107788, "entropy": 0.6564601063728333, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2589600, "episodes_total": 1991, "training_iteration": 249, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-01-03", "timestamp": 1710331263, "time_this_iter_s": 186.04063177108765, "time_total_s": 38114.806668519974, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38114.806668519974, "timesteps_since_restore": 2589600, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 35.573584905660375, "ram_util_percent": 35.44641509433962}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 268842.4245085929, "episode_reward_min": 224467.198661424, "episode_reward_mean": 243426.44181993083, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 5.6502242255955935}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 863.2755579116634}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.693788965618324, "mean_processing_ms": 3.5925610539210764, "mean_inference_ms": 0.8295168594674586}, "off_policy_estimator": {}, "info": {"num_steps_trained": 148281728, "num_steps_sampled": 2600000, "sample_time_ms": 171271.156, "load_time_ms": 117.175, "grad_time_ms": 10274.765, "update_time_ms": 3.983, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14821.3759765625, "policy_loss": 0.0022643166594207287, "vf_loss": 14821.3779296875, "vf_explained_var": 0.6539274454116821, "kl": 0.7257833480834961, "entropy": 0.6399926543235779, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2600000, "episodes_total": 1999, "training_iteration": 250, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-04-08", "timestamp": 1710331448, "time_this_iter_s": 184.03746271133423, "time_total_s": 38298.84413123131, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38298.84413123131, "timesteps_since_restore": 2600000, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 35.14676806083649, "ram_util_percent": 35.47984790874524}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 261619.15566802735, "episode_reward_min": 222067.32678803158, "episode_reward_mean": 241333.10904529828, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 4.270024061203003}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 855.8518655411671}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.73344108190628, "mean_processing_ms": 3.594342773492099, "mean_inference_ms": 0.8295930726942874}, "off_policy_estimator": {}, "info": {"num_steps_trained": 149014144, "num_steps_sampled": 2610400, "sample_time_ms": 172750.711, "load_time_ms": 118.928, "grad_time_ms": 10397.669, "update_time_ms": 3.994, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14253.595703125, "policy_loss": 0.0032811223063617945, "vf_loss": 14253.59765625, "vf_explained_var": 0.6627607345581055, "kl": 3.3251099586486816, "entropy": 0.6786800026893616, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2610400, "episodes_total": 2007, "training_iteration": 251, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-07-15", "timestamp": 1710331635, "time_this_iter_s": 187.3587727546692, "time_total_s": 38486.20290398598, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38486.20290398598, "timesteps_since_restore": 2610400, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 35.58651685393259, "ram_util_percent": 35.5378277153558}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 261619.15566802735, "episode_reward_min": 222067.32678803158, "episode_reward_mean": 240045.0208811827, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 4.270024061203003}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 851.2536646022295}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.77408954062341, "mean_processing_ms": 3.5961618250611527, "mean_inference_ms": 0.8296723373697479}, "off_policy_estimator": {}, "info": {"num_steps_trained": 149732736, "num_steps_sampled": 2620800, "sample_time_ms": 173260.552, "load_time_ms": 122.161, "grad_time_ms": 10468.67, "update_time_ms": 3.931, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14574.0166015625, "policy_loss": 0.001820773002691567, "vf_loss": 14574.0224609375, "vf_explained_var": 0.655846357345581, "kl": 1.7561547756195068, "entropy": 0.7225364446640015, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2620800, "episodes_total": 2015, "training_iteration": 252, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-10-20", "timestamp": 1710331820, "time_this_iter_s": 184.8142910003662, "time_total_s": 38671.01719498634, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38671.01719498634, "timesteps_since_restore": 2620800, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 35.5564393939394, "ram_util_percent": 35.57386363636363}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 261619.15566802735, "episode_reward_min": 222067.32678803158, "episode_reward_mean": 238569.43433138743, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1522.9736177921295}, "policy_reward_mean": {"shared_policy": 846.0209026255803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.81592445217576, "mean_processing_ms": 3.5980423434092246, "mean_inference_ms": 0.8297564058809576}, "off_policy_estimator": {}, "info": {"num_steps_trained": 150452224, "num_steps_sampled": 2631200, "sample_time_ms": 174078.414, "load_time_ms": 122.554, "grad_time_ms": 10519.292, "update_time_ms": 3.939, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14740.73046875, "policy_loss": 0.0023768760729581118, "vf_loss": 14740.7353515625, "vf_explained_var": 0.6584363579750061, "kl": 1.3454183340072632, "entropy": 0.6890646815299988, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2631200, "episodes_total": 2023, "training_iteration": 253, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-13-27", "timestamp": 1710332007, "time_this_iter_s": 186.7183187007904, "time_total_s": 38857.735513687134, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38857.735513687134, "timesteps_since_restore": 2631200, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 35.554307116104866, "ram_util_percent": 35.5749063670412}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 257023.4069529695, "episode_reward_min": 222067.32678803158, "episode_reward_mean": 237733.5902657696, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1515.1876559257507}, "policy_reward_mean": {"shared_policy": 843.0568114676744}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.858323127858014, "mean_processing_ms": 3.5999409888486986, "mean_inference_ms": 0.8298446616740991}, "off_policy_estimator": {}, "info": {"num_steps_trained": 151153280, "num_steps_sampled": 2641600, "sample_time_ms": 173447.895, "load_time_ms": 122.539, "grad_time_ms": 10587.606, "update_time_ms": 3.912, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15381.2353515625, "policy_loss": 0.00040026826900430024, "vf_loss": 15381.2421875, "vf_explained_var": 0.6520333290100098, "kl": 0.003941837232559919, "entropy": 0.6533935070037842, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2641600, "episodes_total": 2031, "training_iteration": 254, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-16-27", "timestamp": 1710332187, "time_this_iter_s": 180.15377068519592, "time_total_s": 39037.88928437233, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39037.88928437233, "timesteps_since_restore": 2641600, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 35.900389105058366, "ram_util_percent": 35.54280155642024}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 222067.32678803158, "episode_reward_mean": 237936.04343238112, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 843.7747559572364}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.900380820427834, "mean_processing_ms": 3.6018262415725393, "mean_inference_ms": 0.8299336697826187}, "off_policy_estimator": {}, "info": {"num_steps_trained": 151833984, "num_steps_sampled": 2652000, "sample_time_ms": 172939.193, "load_time_ms": 122.025, "grad_time_ms": 10571.77, "update_time_ms": 3.942, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15800.2802734375, "policy_loss": 0.0024496151600033045, "vf_loss": 15800.283203125, "vf_explained_var": 0.6475090384483337, "kl": 1.1692194938659668, "entropy": 0.6440274119377136, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2652000, "episodes_total": 2039, "training_iteration": 255, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-19-24", "timestamp": 1710332364, "time_this_iter_s": 176.7040491104126, "time_total_s": 39214.59333348274, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39214.59333348274, "timesteps_since_restore": 2652000, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 35.67391304347826, "ram_util_percent": 35.60079051383399}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 222067.32678803158, "episode_reward_mean": 238833.31868608188, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 846.9566959327701}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.94136443651666, "mean_processing_ms": 3.6036446293177478, "mean_inference_ms": 0.8300220125730212}, "off_policy_estimator": {}, "info": {"num_steps_trained": 152508032, "num_steps_sampled": 2662400, "sample_time_ms": 172248.434, "load_time_ms": 121.511, "grad_time_ms": 10532.653, "update_time_ms": 3.731, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16627.751953125, "policy_loss": 0.0017575249075889587, "vf_loss": 16627.755859375, "vf_explained_var": 0.6466211676597595, "kl": 2.646709442138672, "entropy": 0.5684565305709839, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2662400, "episodes_total": 2047, "training_iteration": 256, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-22-19", "timestamp": 1710332539, "time_this_iter_s": 174.93084621429443, "time_total_s": 39389.52417969704, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39389.52417969704, "timesteps_since_restore": 2662400, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 35.522400000000005, "ram_util_percent": 35.52960000000001}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 222067.32678803158, "episode_reward_mean": 239252.96037552052, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 848.4147531046826}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.98201364748334, "mean_processing_ms": 3.605432490067804, "mean_inference_ms": 0.8301116632162596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 153208576, "num_steps_sampled": 2672800, "sample_time_ms": 172118.302, "load_time_ms": 120.291, "grad_time_ms": 10499.461, "update_time_ms": 3.701, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15653.1220703125, "policy_loss": 0.00020917851361446083, "vf_loss": 15653.1279296875, "vf_explained_var": 0.6571446657180786, "kl": 0.003610866377130151, "entropy": 0.5848054885864258, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2672800, "episodes_total": 2055, "training_iteration": 257, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-25-22", "timestamp": 1710332722, "time_this_iter_s": 182.71063017845154, "time_total_s": 39572.23480987549, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39572.23480987549, "timesteps_since_restore": 2672800, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 35.67307692307692, "ram_util_percent": 35.53961538461538}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 221987.52105258024, "episode_reward_mean": 239455.2720197419, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 849.1321702827727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.023129145963225, "mean_processing_ms": 3.607244884876111, "mean_inference_ms": 0.8302049282390999}, "off_policy_estimator": {}, "info": {"num_steps_trained": 153946368, "num_steps_sampled": 2683200, "sample_time_ms": 172696.748, "load_time_ms": 121.258, "grad_time_ms": 10547.26, "update_time_ms": 3.686, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14437.9736328125, "policy_loss": 0.00019915660959668458, "vf_loss": 14437.98046875, "vf_explained_var": 0.6636250615119934, "kl": 0.0032357187010347843, "entropy": 0.5975552797317505, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2683200, "episodes_total": 2063, "training_iteration": 258, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-28-34", "timestamp": 1710332914, "time_this_iter_s": 191.23243165016174, "time_total_s": 39763.46724152565, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39763.46724152565, "timesteps_since_restore": 2683200, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 35.69560439560439, "ram_util_percent": 35.57179487179487}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 219786.0112023156, "episode_reward_mean": 238831.48721331553, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 846.9201674231048}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.064965677689976, "mean_processing_ms": 3.6090885416247986, "mean_inference_ms": 0.8303039032103537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 154696576, "num_steps_sampled": 2693600, "sample_time_ms": 173390.318, "load_time_ms": 122.535, "grad_time_ms": 10615.974, "update_time_ms": 3.624, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13806.5478515625, "policy_loss": 0.0002454022760502994, "vf_loss": 13806.5546875, "vf_explained_var": 0.6724923849105835, "kl": 0.0033150825183838606, "entropy": 0.6405355930328369, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2693600, "episodes_total": 2071, "training_iteration": 259, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-31-47", "timestamp": 1710333107, "time_this_iter_s": 193.67842364311218, "time_total_s": 39957.14566516876, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39957.14566516876, "timesteps_since_restore": 2693600, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 35.85740072202166, "ram_util_percent": 35.55018050541516}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 237196.7370235632, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 841.1231809346214}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.10832827003716, "mean_processing_ms": 3.6110065708212233, "mean_inference_ms": 0.8304097576066729}, "off_policy_estimator": {}, "info": {"num_steps_trained": 155478656, "num_steps_sampled": 2704000, "sample_time_ms": 175305.697, "load_time_ms": 125.282, "grad_time_ms": 10737.097, "update_time_ms": 3.63, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13039.9736328125, "policy_loss": 0.0002464597928337753, "vf_loss": 13039.9794921875, "vf_explained_var": 0.6781432032585144, "kl": 0.0032072856556624174, "entropy": 0.6353469491004944, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2704000, "episodes_total": 2079, "training_iteration": 260, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-35-12", "timestamp": 1710333312, "time_this_iter_s": 204.44941687583923, "time_total_s": 40161.5950820446, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40161.5950820446, "timesteps_since_restore": 2704000, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 35.60308219178082, "ram_util_percent": 35.46849315068493}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 236672.47081969198, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 839.2640809208935}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.15234195323211, "mean_processing_ms": 3.6129579053878205, "mean_inference_ms": 0.8305238168249042}, "off_policy_estimator": {}, "info": {"num_steps_trained": 156223872, "num_steps_sampled": 2714400, "sample_time_ms": 175984.431, "load_time_ms": 127.36, "grad_time_ms": 10690.166, "update_time_ms": 3.629, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13857.1484375, "policy_loss": 4.3704392737708986e-05, "vf_loss": 13857.1552734375, "vf_explained_var": 0.6759851574897766, "kl": 0.0032183958683162928, "entropy": 0.6159369945526123, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2714400, "episodes_total": 2087, "training_iteration": 261, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-38-26", "timestamp": 1710333506, "time_this_iter_s": 193.71577763557434, "time_total_s": 40355.310859680176, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40355.310859680176, "timesteps_since_restore": 2714400, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 35.64693140794223, "ram_util_percent": 35.536462093862816}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 236430.5941222943, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 838.4063621357952}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.196659362935634, "mean_processing_ms": 3.6149355257742912, "mean_inference_ms": 0.8306463231645088}, "off_policy_estimator": {}, "info": {"num_steps_trained": 156958592, "num_steps_sampled": 2724800, "sample_time_ms": 176573.486, "load_time_ms": 125.787, "grad_time_ms": 10677.117, "update_time_ms": 3.733, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14365.3876953125, "policy_loss": 0.00024120685702655464, "vf_loss": 14365.3955078125, "vf_explained_var": 0.6705549955368042, "kl": 0.0031741741113364697, "entropy": 0.5468542575836182, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2724800, "episodes_total": 2095, "training_iteration": 262, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-41-37", "timestamp": 1710333697, "time_this_iter_s": 190.55947041511536, "time_total_s": 40545.87033009529, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40545.87033009529, "timesteps_since_restore": 2724800, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 36.23933823529412, "ram_util_percent": 35.73529411764706}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 236291.67679806502, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 837.9137475108688}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.24131992476924, "mean_processing_ms": 3.6169293865292436, "mean_inference_ms": 0.830772599295434}, "off_policy_estimator": {}, "info": {"num_steps_trained": 157701376, "num_steps_sampled": 2735200, "sample_time_ms": 176982.259, "load_time_ms": 127.71, "grad_time_ms": 10706.318, "update_time_ms": 3.72, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13956.1298828125, "policy_loss": 0.00019115253235213459, "vf_loss": 13956.134765625, "vf_explained_var": 0.6736463308334351, "kl": 0.003196773584932089, "entropy": 0.5537348389625549, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2735200, "episodes_total": 2103, "training_iteration": 263, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-44-48", "timestamp": 1710333888, "time_this_iter_s": 191.12511658668518, "time_total_s": 40736.995446681976, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40736.995446681976, "timesteps_since_restore": 2735200, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 35.936029411764714, "ram_util_percent": 35.63198529411765}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 236248.10551261198, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 837.7592394064254}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.286355252632276, "mean_processing_ms": 3.618936402067325, "mean_inference_ms": 0.8309024880985169}, "off_policy_estimator": {}, "info": {"num_steps_trained": 158436864, "num_steps_sampled": 2745600, "sample_time_ms": 178025.532, "load_time_ms": 128.206, "grad_time_ms": 10745.208, "update_time_ms": 3.763, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14232.9326171875, "policy_loss": 0.00014803411613684148, "vf_loss": 14232.9365234375, "vf_explained_var": 0.6705935597419739, "kl": 0.003539138939231634, "entropy": 0.5451202392578125, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2745600, "episodes_total": 2111, "training_iteration": 264, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-47-59", "timestamp": 1710334079, "time_this_iter_s": 190.98097920417786, "time_total_s": 40927.976425886154, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40927.976425886154, "timesteps_since_restore": 2745600, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 35.735897435897435, "ram_util_percent": 35.7029304029304}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 236360.92228135696, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 838.15929887006}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.33140494379611, "mean_processing_ms": 3.6209444824869372, "mean_inference_ms": 0.831033049753731}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159170688, "num_steps_sampled": 2756000, "sample_time_ms": 179330.001, "load_time_ms": 129.115, "grad_time_ms": 10825.703, "update_time_ms": 3.782, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14005.7294921875, "policy_loss": 0.0002578464336693287, "vf_loss": 14005.7353515625, "vf_explained_var": 0.663966953754425, "kl": 0.002882552333176136, "entropy": 0.5524572134017944, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2756000, "episodes_total": 2119, "training_iteration": 265, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-51-10", "timestamp": 1710334270, "time_this_iter_s": 190.57292008399963, "time_total_s": 41118.549345970154, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41118.549345970154, "timesteps_since_restore": 2756000, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 35.55091575091575, "ram_util_percent": 35.72234432234433}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260734.33562159087, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 236233.1251698788, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1520.3925528526306}, "policy_reward_mean": {"shared_policy": 837.7061176236836}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.37717918595463, "mean_processing_ms": 3.6229732670893604, "mean_inference_ms": 0.8311667934826411}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159909120, "num_steps_sampled": 2766400, "sample_time_ms": 181028.701, "load_time_ms": 130.276, "grad_time_ms": 10928.968, "update_time_ms": 3.823, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13985.390625, "policy_loss": 0.00032287868089042604, "vf_loss": 13985.3955078125, "vf_explained_var": 0.6679790019989014, "kl": 0.002926345681771636, "entropy": 0.4632146954536438, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2766400, "episodes_total": 2127, "training_iteration": 266, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-54-23", "timestamp": 1710334463, "time_this_iter_s": 192.96843671798706, "time_total_s": 41311.51778268814, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41311.51778268814, "timesteps_since_restore": 2766400, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 35.79600000000001, "ram_util_percent": 35.7389090909091}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260043.44716691296, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 236225.64436631702, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1517.585699558258}, "policy_reward_mean": {"shared_policy": 837.7092959548813}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.42356305723445, "mean_processing_ms": 3.6250328928690205, "mean_inference_ms": 0.8313026004018854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 160636032, "num_steps_sampled": 2776800, "sample_time_ms": 181479.125, "load_time_ms": 132.418, "grad_time_ms": 10965.668, "update_time_ms": 3.892, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14362.6513671875, "policy_loss": 0.00019076869648415595, "vf_loss": 14362.6552734375, "vf_explained_var": 0.6617220640182495, "kl": 0.0035317742731422186, "entropy": 0.44596585631370544, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2776800, "episodes_total": 2135, "training_iteration": 267, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_08-57-31", "timestamp": 1710334651, "time_this_iter_s": 187.60221195220947, "time_total_s": 41499.11999464035, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41499.11999464035, "timesteps_since_restore": 2776800, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 35.710447761194025, "ram_util_percent": 35.67201492537313}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260043.44716691296, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 235509.9744635034, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1517.585699558258}, "policy_reward_mean": {"shared_policy": 835.2009875292695}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.47113976482703, "mean_processing_ms": 3.6271498906354815, "mean_inference_ms": 0.831440083211233}, "off_policy_estimator": {}, "info": {"num_steps_trained": 161371264, "num_steps_sampled": 2787200, "sample_time_ms": 181560.365, "load_time_ms": 132.93, "grad_time_ms": 10976.259, "update_time_ms": 3.913, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14163.8564453125, "policy_loss": 0.00014738344179932028, "vf_loss": 14163.8603515625, "vf_explained_var": 0.6712771654129028, "kl": 0.0033105704933404922, "entropy": 0.44252073764801025, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2787200, "episodes_total": 2143, "training_iteration": 268, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-00-43", "timestamp": 1710334843, "time_this_iter_s": 192.14662551879883, "time_total_s": 41691.26662015915, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41691.26662015915, "timesteps_since_restore": 2787200, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 35.360948905109495, "ram_util_percent": 35.72226277372263}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 260043.44716691296, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 234526.27399973772, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 831.7124405976941}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.52009805625912, "mean_processing_ms": 3.62934010125565, "mean_inference_ms": 0.8315782848310094}, "off_policy_estimator": {}, "info": {"num_steps_trained": 162124544, "num_steps_sampled": 2797600, "sample_time_ms": 182020.778, "load_time_ms": 132.064, "grad_time_ms": 10978.525, "update_time_ms": 4.02, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13629.3544921875, "policy_loss": 0.0001738814898999408, "vf_loss": 13629.3583984375, "vf_explained_var": 0.6727768182754517, "kl": 0.003243945073336363, "entropy": 0.46803897619247437, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2797600, "episodes_total": 2151, "training_iteration": 269, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-04-02", "timestamp": 1710335042, "time_this_iter_s": 198.29828691482544, "time_total_s": 41889.564907073975, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41889.564907073975, "timesteps_since_restore": 2797600, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 35.40845070422535, "ram_util_percent": 35.62042253521127}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 254973.09461488412, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 233654.38627546522, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 828.6204208648315}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.56983125441196, "mean_processing_ms": 3.631569513081702, "mean_inference_ms": 0.8317157939916329}, "off_policy_estimator": {}, "info": {"num_steps_trained": 162892800, "num_steps_sampled": 2808000, "sample_time_ms": 181748.962, "load_time_ms": 130.388, "grad_time_ms": 10931.753, "update_time_ms": 4.037, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13207.0419921875, "policy_loss": 0.00016789446817710996, "vf_loss": 13207.0458984375, "vf_explained_var": 0.6731369495391846, "kl": 0.002706302097067237, "entropy": 0.5054426193237305, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2808000, "episodes_total": 2159, "training_iteration": 270, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-07-23", "timestamp": 1710335243, "time_this_iter_s": 201.22736525535583, "time_total_s": 42090.79227232933, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42090.79227232933, "timesteps_since_restore": 2808000, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 35.58118466898954, "ram_util_percent": 35.723693379790944}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 254973.09461488412, "episode_reward_min": 208419.07902736223, "episode_reward_mean": 233209.4648377737, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -101.90119275450706}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 827.042573366103}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.61965065306982, "mean_processing_ms": 3.6337916365794003, "mean_inference_ms": 0.8318481061481393}, "off_policy_estimator": {}, "info": {"num_steps_trained": 163662208, "num_steps_sampled": 2818400, "sample_time_ms": 181908.8, "load_time_ms": 128.66, "grad_time_ms": 10991.793, "update_time_ms": 4.047, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13120.939453125, "policy_loss": 0.00020676956046372652, "vf_loss": 13120.943359375, "vf_explained_var": 0.6725625991821289, "kl": 0.0031901285983622074, "entropy": 0.5062695145606995, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2818400, "episodes_total": 2167, "training_iteration": 271, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-10-39", "timestamp": 1710335439, "time_this_iter_s": 195.86877608299255, "time_total_s": 42286.66104841232, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42286.66104841232, "timesteps_since_restore": 2818400, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 35.65642857142857, "ram_util_percent": 35.70357142857143}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 254973.09461488412, "episode_reward_min": 213311.03227326914, "episode_reward_mean": 233236.07395985053, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -6.279947455972433}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 827.1369386476011}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.669025593200686, "mean_processing_ms": 3.635987616237947, "mean_inference_ms": 0.8319738410640377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 164448000, "num_steps_sampled": 2828800, "sample_time_ms": 182478.866, "load_time_ms": 129.352, "grad_time_ms": 11074.363, "update_time_ms": 3.919, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12567.75, "policy_loss": 9.155389852821827e-05, "vf_loss": 12567.75390625, "vf_explained_var": 0.6679073572158813, "kl": 0.0030710892751812935, "entropy": 0.5324093103408813, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2828800, "episodes_total": 2175, "training_iteration": 272, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-13-57", "timestamp": 1710335637, "time_this_iter_s": 197.0946068763733, "time_total_s": 42483.755655288696, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42483.755655288696, "timesteps_since_restore": 2828800, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 35.89644128113879, "ram_util_percent": 35.72811387900355}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 254973.09461488412, "episode_reward_min": 213311.03227326914, "episode_reward_mean": 233050.70290212307, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -6.279947455972433}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 826.4795478478014}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.718054454178976, "mean_processing_ms": 3.6381680563330927, "mean_inference_ms": 0.8320897548644547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 165226496, "num_steps_sampled": 2839200, "sample_time_ms": 183128.156, "load_time_ms": 128.227, "grad_time_ms": 11019.453, "update_time_ms": 3.864, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12637.5849609375, "policy_loss": 9.871634392766282e-05, "vf_loss": 12637.58984375, "vf_explained_var": 0.6625880599021912, "kl": 0.0026158469263464212, "entropy": 0.5820643305778503, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2839200, "episodes_total": 2183, "training_iteration": 273, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-17-14", "timestamp": 1710335834, "time_this_iter_s": 197.04275822639465, "time_total_s": 42680.79841351509, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42680.79841351509, "timesteps_since_restore": 2839200, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 34.994680851063826, "ram_util_percent": 35.803546099290784}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 249312.50421965285, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 233392.64857191473, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 827.6922071491406}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.766545646163685, "mean_processing_ms": 3.640315875064226, "mean_inference_ms": 0.8321994268053291}, "off_policy_estimator": {}, "info": {"num_steps_trained": 165968384, "num_steps_sampled": 2849600, "sample_time_ms": 183115.494, "load_time_ms": 128.112, "grad_time_ms": 10952.017, "update_time_ms": 3.779, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13850.5751953125, "policy_loss": 3.211135481251404e-05, "vf_loss": 13850.5810546875, "vf_explained_var": 0.6619197130203247, "kl": 0.003612247761338949, "entropy": 0.5103594064712524, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2849600, "episodes_total": 2191, "training_iteration": 274, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-20-24", "timestamp": 1710336024, "time_this_iter_s": 190.171528339386, "time_total_s": 42870.96994185448, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42870.96994185448, "timesteps_since_restore": 2849600, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 35.360516605166055, "ram_util_percent": 35.541328413284134}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 262781.3102017429, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 234810.41098067895, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 832.7200900087912}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.81390950647525, "mean_processing_ms": 3.642415229029743, "mean_inference_ms": 0.8323043587536455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 166689280, "num_steps_sampled": 2860000, "sample_time_ms": 182663.058, "load_time_ms": 127.859, "grad_time_ms": 10857.151, "update_time_ms": 3.73, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14465.80859375, "policy_loss": 0.000263493275269866, "vf_loss": 14465.8125, "vf_explained_var": 0.659788191318512, "kl": 0.00290091335773468, "entropy": 0.40848302841186523, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2860000, "episodes_total": 2199, "training_iteration": 275, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-23-29", "timestamp": 1710336209, "time_this_iter_s": 185.0923240184784, "time_total_s": 43056.062265872955, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43056.062265872955, "timesteps_since_restore": 2860000, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 36.07045454545454, "ram_util_percent": 35.7215909090909}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 262781.3102017429, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 236631.85235538104, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 839.1795600942655}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.85996704687764, "mean_processing_ms": 3.644460414502735, "mean_inference_ms": 0.8324036250413736}, "off_policy_estimator": {}, "info": {"num_steps_trained": 167393664, "num_steps_sampled": 2870400, "sample_time_ms": 181739.786, "load_time_ms": 125.698, "grad_time_ms": 10762.16, "update_time_ms": 3.703, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15006.0751953125, "policy_loss": 8.098418038571253e-05, "vf_loss": 15006.078125, "vf_explained_var": 0.651323676109314, "kl": 0.0031124637462198734, "entropy": 0.45265671610832214, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2870400, "episodes_total": 2207, "training_iteration": 276, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-26-32", "timestamp": 1710336392, "time_this_iter_s": 182.7537772655487, "time_total_s": 43238.816043138504, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43238.816043138504, "timesteps_since_restore": 2870400, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 35.94980842911878, "ram_util_percent": 35.65977011494253}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275476.01260461804, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 239086.200755032, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 847.8835405171714}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.90385105277411, "mean_processing_ms": 3.646421146344811, "mean_inference_ms": 0.8324953735326104}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168073344, "num_steps_sampled": 2880800, "sample_time_ms": 180371.949, "load_time_ms": 123.956, "grad_time_ms": 10683.442, "update_time_ms": 3.61, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15866.193359375, "policy_loss": 0.00025645046844147146, "vf_loss": 15866.1982421875, "vf_explained_var": 0.6510677933692932, "kl": 0.0023597499821335077, "entropy": 0.4407649636268616, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2880800, "episodes_total": 2215, "training_iteration": 277, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-29-26", "timestamp": 1710336566, "time_this_iter_s": 173.11812829971313, "time_total_s": 43411.93417143822, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43411.93417143822, "timesteps_since_restore": 2880800, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 35.75766129032258, "ram_util_percent": 35.80524193548387}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 240527.8119284475, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 852.9959994625417}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.946525014400166, "mean_processing_ms": 3.6483329959410495, "mean_inference_ms": 0.8325803410767548}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168785920, "num_steps_sampled": 2891200, "sample_time_ms": 179561.488, "load_time_ms": 121.428, "grad_time_ms": 10614.391, "update_time_ms": 3.619, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14870.0771484375, "policy_loss": 9.898662392515689e-05, "vf_loss": 14870.08203125, "vf_explained_var": 0.6455757021903992, "kl": 0.0031429799273610115, "entropy": 0.48106685280799866, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2891200, "episodes_total": 2223, "training_iteration": 278, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-32-29", "timestamp": 1710336749, "time_this_iter_s": 183.32227754592896, "time_total_s": 43595.256448984146, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43595.256448984146, "timesteps_since_restore": 2891200, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 35.58275862068965, "ram_util_percent": 35.901532567049806}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 241241.43774663217, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 855.496428052882}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.98852986200927, "mean_processing_ms": 3.650222550732336, "mean_inference_ms": 0.8326613175278692}, "off_policy_estimator": {}, "info": {"num_steps_trained": 169505408, "num_steps_sampled": 2901600, "sample_time_ms": 178073.79, "load_time_ms": 119.866, "grad_time_ms": 10537.447, "update_time_ms": 3.536, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14647.330078125, "policy_loss": 0.00021260343783069402, "vf_loss": 14647.33203125, "vf_explained_var": 0.6558089852333069, "kl": 0.0023436574265360832, "entropy": 0.446511447429657, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2901600, "episodes_total": 2231, "training_iteration": 279, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-35-32", "timestamp": 1710336932, "time_this_iter_s": 182.6272599697113, "time_total_s": 43777.88370895386, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43777.88370895386, "timesteps_since_restore": 2901600, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 35.92911877394636, "ram_util_percent": 35.92567049808429}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 241695.84325663283, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.8924851417542}, "policy_reward_mean": {"shared_policy": 857.0774583568539}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.029979373095955, "mean_processing_ms": 3.652090018190263, "mean_inference_ms": 0.8327378595617807}, "off_policy_estimator": {}, "info": {"num_steps_trained": 170235520, "num_steps_sampled": 2912000, "sample_time_ms": 176843.429, "load_time_ms": 118.729, "grad_time_ms": 10479.803, "update_time_ms": 3.566, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14474.67578125, "policy_loss": 4.293427991797216e-05, "vf_loss": 14474.681640625, "vf_explained_var": 0.6606923937797546, "kl": 0.003553919494152069, "entropy": 0.44873613119125366, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2912000, "episodes_total": 2239, "training_iteration": 280, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-38-40", "timestamp": 1710337120, "time_this_iter_s": 188.32665395736694, "time_total_s": 43966.210362911224, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43966.210362911224, "timesteps_since_restore": 2912000, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 35.59591078066914, "ram_util_percent": 35.73271375464684}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 241509.09487166163, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 856.4152300413533}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.07160473537352, "mean_processing_ms": 3.6539568658978174, "mean_inference_ms": 0.8328091035599604}, "off_policy_estimator": {}, "info": {"num_steps_trained": 171000320, "num_steps_sampled": 2922400, "sample_time_ms": 177214.908, "load_time_ms": 119.851, "grad_time_ms": 10483.118, "update_time_ms": 3.612, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13438.0693359375, "policy_loss": 0.00025318775442428887, "vf_loss": 13438.0732421875, "vf_explained_var": 0.6637392044067383, "kl": 0.0023947206791490316, "entropy": 0.46925413608551025, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2922400, "episodes_total": 2247, "training_iteration": 281, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-42-00", "timestamp": 1710337320, "time_this_iter_s": 199.640944480896, "time_total_s": 44165.85130739212, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44165.85130739212, "timesteps_since_restore": 2922400, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 35.384561403508776, "ram_util_percent": 35.68631578947369}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 241829.98235011395, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 857.5531289011132}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.11294736400707, "mean_processing_ms": 3.6558096265883306, "mean_inference_ms": 0.8328773213016888}, "off_policy_estimator": {}, "info": {"num_steps_trained": 171762816, "num_steps_sampled": 2932800, "sample_time_ms": 177321.571, "load_time_ms": 119.496, "grad_time_ms": 10457.923, "update_time_ms": 3.66, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13501.3623046875, "policy_loss": 0.0001431613345630467, "vf_loss": 13501.3681640625, "vf_explained_var": 0.6676837205886841, "kl": 0.003112344304099679, "entropy": 0.4556558430194855, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2932800, "episodes_total": 2255, "training_iteration": 282, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-45-18", "timestamp": 1710337518, "time_this_iter_s": 197.90052437782288, "time_total_s": 44363.75183176994, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44363.75183176994, "timesteps_since_restore": 2932800, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 35.62190812720848, "ram_util_percent": 35.7964664310954}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 213145.00127362792, "episode_reward_mean": 242400.6149455278, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 859.5766487430062}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.15389015839759, "mean_processing_ms": 3.657644264494186, "mean_inference_ms": 0.8329441156425534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 172534528, "num_steps_sampled": 2943200, "sample_time_ms": 177117.367, "load_time_ms": 120.306, "grad_time_ms": 10534.22, "update_time_ms": 3.695, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13451.4833984375, "policy_loss": 0.00015099029405973852, "vf_loss": 13451.4853515625, "vf_explained_var": 0.6719504594802856, "kl": 0.002578987739980221, "entropy": 0.4444487690925598, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2943200, "episodes_total": 2263, "training_iteration": 283, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-48-34", "timestamp": 1710337714, "time_this_iter_s": 195.77251887321472, "time_total_s": 44559.52435064316, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44559.52435064316, "timesteps_since_restore": 2943200, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 35.839068100358425, "ram_util_percent": 35.784229390681006}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 242470.63917908137, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 859.8249616279483}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.19521642507028, "mean_processing_ms": 3.65949609321547, "mean_inference_ms": 0.8330126769316237}, "off_policy_estimator": {}, "info": {"num_steps_trained": 173335552, "num_steps_sampled": 2953600, "sample_time_ms": 178645.412, "load_time_ms": 121.659, "grad_time_ms": 10692.188, "update_time_ms": 3.8, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12492.9609375, "policy_loss": 0.00010868869867408648, "vf_loss": 12492.966796875, "vf_explained_var": 0.6797776222229004, "kl": 0.0027774954214692116, "entropy": 0.48480936884880066, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2953600, "episodes_total": 2271, "training_iteration": 284, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-52-01", "timestamp": 1710337921, "time_this_iter_s": 207.05405926704407, "time_total_s": 44766.5784099102, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44766.5784099102, "timesteps_since_restore": 2953600, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 35.52804054054054, "ram_util_percent": 35.80844594594594}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 242486.23191498953, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.718636222183704}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 859.8802550176933}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.2368773277259, "mean_processing_ms": 3.66135090448209, "mean_inference_ms": 0.8330831829889346}, "off_policy_estimator": {}, "info": {"num_steps_trained": 174132096, "num_steps_sampled": 2964000, "sample_time_ms": 180204.552, "load_time_ms": 123.641, "grad_time_ms": 10851.575, "update_time_ms": 3.84, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12524.8193359375, "policy_loss": 0.0001905416138470173, "vf_loss": 12524.82421875, "vf_explained_var": 0.6804879903793335, "kl": 0.003175289835780859, "entropy": 0.456147164106369, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2964000, "episodes_total": 2279, "training_iteration": 285, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-55-24", "timestamp": 1710338124, "time_this_iter_s": 202.30906987190247, "time_total_s": 44968.887479782104, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44968.887479782104, "timesteps_since_restore": 2964000, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 35.69342560553634, "ram_util_percent": 35.83494809688582}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 241957.7395003991, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 858.0061684411315}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.27962405434213, "mean_processing_ms": 3.6632617014011246, "mean_inference_ms": 0.8331557252309122}, "off_policy_estimator": {}, "info": {"num_steps_trained": 174946432, "num_steps_sampled": 2974400, "sample_time_ms": 182470.44, "load_time_ms": 125.715, "grad_time_ms": 11017.309, "update_time_ms": 3.866, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12078.6494140625, "policy_loss": 0.00014906306751072407, "vf_loss": 12078.654296875, "vf_explained_var": 0.686367928981781, "kl": 0.0028875672724097967, "entropy": 0.40382927656173706, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2974400, "episodes_total": 2287, "training_iteration": 286, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_09-58-51", "timestamp": 1710338331, "time_this_iter_s": 207.09894323349, "time_total_s": 45175.986423015594, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45175.986423015594, "timesteps_since_restore": 2974400, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 35.69121621621622, "ram_util_percent": 35.79189189189189}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 240690.915721557, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 853.5138855374362}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.323854966169414, "mean_processing_ms": 3.665240272314597, "mean_inference_ms": 0.8332307129311249}, "off_policy_estimator": {}, "info": {"num_steps_trained": 175753344, "num_steps_sampled": 2984800, "sample_time_ms": 185360.593, "load_time_ms": 128.025, "grad_time_ms": 11202.646, "update_time_ms": 3.851, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12025.9013671875, "policy_loss": 0.00016605494602117687, "vf_loss": 12025.90625, "vf_explained_var": 0.6792610287666321, "kl": 0.0024273169692605734, "entropy": 0.46375370025634766, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2984800, "episodes_total": 2295, "training_iteration": 287, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-02-15", "timestamp": 1710338535, "time_this_iter_s": 203.90475940704346, "time_total_s": 45379.89118242264, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45379.89118242264, "timesteps_since_restore": 2984800, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 35.8553264604811, "ram_util_percent": 35.901374570446734}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 239962.93105799833, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 850.9323796382916}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.36918316465271, "mean_processing_ms": 3.667266054145829, "mean_inference_ms": 0.8333065083824893}, "off_policy_estimator": {}, "info": {"num_steps_trained": 176523264, "num_steps_sampled": 2995200, "sample_time_ms": 186717.339, "load_time_ms": 130.317, "grad_time_ms": 11280.993, "update_time_ms": 3.856, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12903.5517578125, "policy_loss": 0.00013752769154962152, "vf_loss": 12903.556640625, "vf_explained_var": 0.6765879988670349, "kl": 0.00273806881159544, "entropy": 0.4489098787307739, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 2995200, "episodes_total": 2303, "training_iteration": 288, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-05-33", "timestamp": 1710338733, "time_this_iter_s": 197.70220637321472, "time_total_s": 45577.59338879585, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45577.59338879585, "timesteps_since_restore": 2995200, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 35.751773049645394, "ram_util_percent": 35.73723404255318}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 278794.2874492933, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 239234.89674632184, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 848.3807821068898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.41568474562655, "mean_processing_ms": 3.6693517762760193, "mean_inference_ms": 0.833388226200085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 177263616, "num_steps_sampled": 3005600, "sample_time_ms": 187829.839, "load_time_ms": 132.014, "grad_time_ms": 11371.076, "update_time_ms": 3.922, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14199.3251953125, "policy_loss": 6.976352597121149e-05, "vf_loss": 14199.3310546875, "vf_explained_var": 0.6694900393486023, "kl": 0.00249880226328969, "entropy": 0.38859590888023376, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3005600, "episodes_total": 2311, "training_iteration": 289, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-08-48", "timestamp": 1710338928, "time_this_iter_s": 194.68701934814453, "time_total_s": 45772.280408144, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45772.280408144, "timesteps_since_restore": 3005600, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 35.752877697841726, "ram_util_percent": 35.80395683453237}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 270944.0278368405, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 239277.19294205573, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 848.5307739354437}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.46318097802786, "mean_processing_ms": 3.671485173244306, "mean_inference_ms": 0.8334801544796087}, "off_policy_estimator": {}, "info": {"num_steps_trained": 177982080, "num_steps_sampled": 3016000, "sample_time_ms": 188098.072, "load_time_ms": 131.631, "grad_time_ms": 11390.438, "update_time_ms": 3.89, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15123.349609375, "policy_loss": 0.00024220964405685663, "vf_loss": 15123.3525390625, "vf_explained_var": 0.664306640625, "kl": 0.002540327375754714, "entropy": 0.36812034249305725, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3016000, "episodes_total": 2319, "training_iteration": 290, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-11-59", "timestamp": 1710339119, "time_this_iter_s": 191.2077293395996, "time_total_s": 45963.4881374836, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45963.4881374836, "timesteps_since_restore": 3016000, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 35.676923076923075, "ram_util_percent": 35.9051282051282}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 270944.0278368405, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 239933.69082778078, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 850.8588631787679}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.510733414416045, "mean_processing_ms": 3.673621324732045, "mean_inference_ms": 0.8335750039485341}, "off_policy_estimator": {}, "info": {"num_steps_trained": 178702720, "num_steps_sampled": 3026400, "sample_time_ms": 186885.07, "load_time_ms": 130.372, "grad_time_ms": 11349.618, "update_time_ms": 3.903, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15086.7783203125, "policy_loss": 0.00019826141942758113, "vf_loss": 15086.78125, "vf_explained_var": 0.6614609956741333, "kl": 0.002400527708232403, "entropy": 0.36390143632888794, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3026400, "episodes_total": 2327, "training_iteration": 291, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-15-07", "timestamp": 1710339307, "time_this_iter_s": 187.08721113204956, "time_total_s": 46150.57534861565, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46150.57534861565, "timesteps_since_restore": 3026400, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 35.74981273408239, "ram_util_percent": 35.82546816479401}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 270944.0278368405, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 240798.08466578356, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 853.9544814021689}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.558427475095115, "mean_processing_ms": 3.675756289389193, "mean_inference_ms": 0.8336710174761418}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179424384, "num_steps_sampled": 3036800, "sample_time_ms": 186079.933, "load_time_ms": 129.09, "grad_time_ms": 11321.981, "update_time_ms": 4.021, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15125.5439453125, "policy_loss": 8.541648276150227e-05, "vf_loss": 15125.5478515625, "vf_explained_var": 0.6551850438117981, "kl": 0.002436908660456538, "entropy": 0.35439959168434143, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3036800, "episodes_total": 2335, "training_iteration": 292, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-18-16", "timestamp": 1710339496, "time_this_iter_s": 189.56990242004395, "time_total_s": 46340.14525103569, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46340.14525103569, "timesteps_since_restore": 3036800, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 35.80442804428044, "ram_util_percent": 35.90553505535055}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 242508.72211500115, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1522.1871075630188}, "policy_reward_mean": {"shared_policy": 860.0210018973015}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.605617423799934, "mean_processing_ms": 3.677869538123807, "mean_inference_ms": 0.8337705366524198}, "off_policy_estimator": {}, "info": {"num_steps_trained": 180140544, "num_steps_sampled": 3047200, "sample_time_ms": 185828.918, "load_time_ms": 132.059, "grad_time_ms": 11267.549, "update_time_ms": 4.089, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15339.755859375, "policy_loss": 0.00014978072431404144, "vf_loss": 15339.7607421875, "vf_explained_var": 0.6504513621330261, "kl": 0.0024509031791239977, "entropy": 0.35939475893974304, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3047200, "episodes_total": 2343, "training_iteration": 293, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-21-29", "timestamp": 1710339689, "time_this_iter_s": 192.76152300834656, "time_total_s": 46532.90677404404, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46532.90677404404, "timesteps_since_restore": 3047200, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 35.32971014492754, "ram_util_percent": 35.904710144927535}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 244616.66048826106, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -25.485631316900253}, "policy_reward_max": {"shared_policy": 1519.4743247032166}, "policy_reward_mean": {"shared_policy": 867.4964908442483}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.65172646890649, "mean_processing_ms": 3.679942914656063, "mean_inference_ms": 0.833869280766487}, "off_policy_estimator": {}, "info": {"num_steps_trained": 180874496, "num_steps_sampled": 3057600, "sample_time_ms": 184243.831, "load_time_ms": 133.096, "grad_time_ms": 11167.862, "update_time_ms": 4.104, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14755.1240234375, "policy_loss": 0.00019251905905548483, "vf_loss": 14755.1279296875, "vf_explained_var": 0.6499106884002686, "kl": 0.002332068746909499, "entropy": 0.36228683590888977, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3057600, "episodes_total": 2351, "training_iteration": 294, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-24-40", "timestamp": 1710339880, "time_this_iter_s": 190.22709465026855, "time_total_s": 46723.133868694305, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46723.133868694305, "timesteps_since_restore": 3057600, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 35.91660516605167, "ram_util_percent": 35.83025830258303}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 208713.32336578832, "episode_reward_mean": 245665.75189572337, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -6.33623830974102}, "policy_reward_max": {"shared_policy": 1519.4743247032166}, "policy_reward_mean": {"shared_policy": 871.2169370016435}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.697464791901176, "mean_processing_ms": 3.681998682309229, "mean_inference_ms": 0.8339659250886328}, "off_policy_estimator": {}, "info": {"num_steps_trained": 181625344, "num_steps_sampled": 3068000, "sample_time_ms": 183592.715, "load_time_ms": 132.948, "grad_time_ms": 11116.883, "update_time_ms": 4.07, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14149.287109375, "policy_loss": 5.327454346115701e-05, "vf_loss": 14149.29296875, "vf_explained_var": 0.6492031812667847, "kl": 0.002844808856025338, "entropy": 0.40991517901420593, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3068000, "episodes_total": 2359, "training_iteration": 295, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-27-55", "timestamp": 1710340075, "time_this_iter_s": 195.27742767333984, "time_total_s": 46918.411296367645, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46918.411296367645, "timesteps_since_restore": 3068000, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 35.18566308243727, "ram_util_percent": 35.869534050179205}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 217098.705225985, "episode_reward_mean": 246364.96881240862, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -6.33623830974102}, "policy_reward_max": {"shared_policy": 1519.4743247032166}, "policy_reward_mean": {"shared_policy": 873.6966054770147}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.74308372614581, "mean_processing_ms": 3.6840523339502567, "mean_inference_ms": 0.8340635171528047}, "off_policy_estimator": {}, "info": {"num_steps_trained": 182407936, "num_steps_sampled": 3078400, "sample_time_ms": 183477.628, "load_time_ms": 134.223, "grad_time_ms": 11106.332, "update_time_ms": 4.247, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12964.5556640625, "policy_loss": 0.0001101412926800549, "vf_loss": 12964.5615234375, "vf_explained_var": 0.6475636959075928, "kl": 0.002098234836012125, "entropy": 0.4631180465221405, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3078400, "episodes_total": 2367, "training_iteration": 296, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-31-21", "timestamp": 1710340281, "time_this_iter_s": 205.85981106758118, "time_total_s": 47124.27110743523, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47124.27110743523, "timesteps_since_restore": 3078400, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 35.625850340136054, "ram_util_percent": 35.942857142857136}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 217098.705225985, "episode_reward_mean": 246989.2846325472, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -17.416713438928127}, "policy_reward_max": {"shared_policy": 1519.4743247032166}, "policy_reward_mean": {"shared_policy": 875.9106483883511}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.78838595718025, "mean_processing_ms": 3.686103510822173, "mean_inference_ms": 0.8341616559017132}, "off_policy_estimator": {}, "info": {"num_steps_trained": 183196288, "num_steps_sampled": 3088800, "sample_time_ms": 183757.527, "load_time_ms": 135.142, "grad_time_ms": 11105.287, "update_time_ms": 4.389, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12696.5625, "policy_loss": 0.0002286190865561366, "vf_loss": 12696.5673828125, "vf_explained_var": 0.6556978821754456, "kl": 0.002149568172171712, "entropy": 0.45272883772850037, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3088800, "episodes_total": 2375, "training_iteration": 297, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-34-48", "timestamp": 1710340488, "time_this_iter_s": 206.70506286621094, "time_total_s": 47330.97617030144, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47330.97617030144, "timesteps_since_restore": 3088800, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 35.72338983050848, "ram_util_percent": 35.91762711864406}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 220982.8526590832, "episode_reward_mean": 247593.01805562605, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -17.416713438928127}, "policy_reward_max": {"shared_policy": 1520.7251644134521}, "policy_reward_mean": {"shared_policy": 878.0516988993052}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.83335853814488, "mean_processing_ms": 3.688149632620003, "mean_inference_ms": 0.8342606144720475}, "off_policy_estimator": {}, "info": {"num_steps_trained": 183991552, "num_steps_sampled": 3099200, "sample_time_ms": 184518.78, "load_time_ms": 136.314, "grad_time_ms": 11162.6, "update_time_ms": 4.379, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12541.05859375, "policy_loss": 0.0003290254680905491, "vf_loss": 12541.064453125, "vf_explained_var": 0.6540329456329346, "kl": 0.0020210607908666134, "entropy": 0.46070432662963867, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3099200, "episodes_total": 2383, "training_iteration": 298, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-38-14", "timestamp": 1710340694, "time_this_iter_s": 205.9045536518097, "time_total_s": 47536.88072395325, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47536.88072395325, "timesteps_since_restore": 3099200, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 35.74081632653061, "ram_util_percent": 35.9608843537415}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 221127.87847784153, "episode_reward_mean": 248226.9078165406, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 880.2996943632193}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.87797199422508, "mean_processing_ms": 3.6901729854959155, "mean_inference_ms": 0.8343611949215654}, "off_policy_estimator": {}, "info": {"num_steps_trained": 184785920, "num_steps_sampled": 3109600, "sample_time_ms": 185567.378, "load_time_ms": 137.174, "grad_time_ms": 11206.173, "update_time_ms": 4.509, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12474.59375, "policy_loss": 0.00017144247249234468, "vf_loss": 12474.5986328125, "vf_explained_var": 0.6556214094161987, "kl": 0.002466068137437105, "entropy": 0.46519729495048523, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3109600, "episodes_total": 2391, "training_iteration": 299, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-41-40", "timestamp": 1710340900, "time_this_iter_s": 205.61315774917603, "time_total_s": 47742.49388170242, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47742.49388170242, "timesteps_since_restore": 3109600, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 35.749319727891155, "ram_util_percent": 36.01768707482994}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 223545.2554334551, "episode_reward_mean": 248517.4384044461, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 881.3300177475214}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.92280310109218, "mean_processing_ms": 3.6922078779803122, "mean_inference_ms": 0.834464050628603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 185585024, "num_steps_sampled": 3120000, "sample_time_ms": 187516.953, "load_time_ms": 140.403, "grad_time_ms": 11314.238, "update_time_ms": 4.582, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12644.3046875, "policy_loss": 5.5981086916290224e-05, "vf_loss": 12644.30859375, "vf_explained_var": 0.6596401929855347, "kl": 0.003078406909480691, "entropy": 0.4073306918144226, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3120000, "episodes_total": 2399, "training_iteration": 300, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-45-12", "timestamp": 1710341112, "time_this_iter_s": 211.84088969230652, "time_total_s": 47954.33477139473, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 47954.33477139473, "timesteps_since_restore": 3120000, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 35.57062706270627, "ram_util_percent": 35.88778877887789}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 247645.79620177526, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 878.2077243936852}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.968266763892935, "mean_processing_ms": 3.694272672170917, "mean_inference_ms": 0.8345678059511445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 186375552, "num_steps_sampled": 3130400, "sample_time_ms": 189439.922, "load_time_ms": 142.234, "grad_time_ms": 11416.68, "update_time_ms": 4.524, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12770.51171875, "policy_loss": 3.6170829844195396e-05, "vf_loss": 12770.5146484375, "vf_explained_var": 0.6679170727729797, "kl": 0.00271292170509696, "entropy": 0.41038092970848083, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3130400, "episodes_total": 2407, "training_iteration": 301, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-48-40", "timestamp": 1710341320, "time_this_iter_s": 207.37151885032654, "time_total_s": 48161.706290245056, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48161.706290245056, "timesteps_since_restore": 3130400, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 35.64797297297297, "ram_util_percent": 35.869256756756755}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 245884.28475519124, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 871.9610083875003}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.01485946036888, "mean_processing_ms": 3.696385842672691, "mean_inference_ms": 0.8346706116015125}, "off_policy_estimator": {}, "info": {"num_steps_trained": 187176960, "num_steps_sampled": 3140800, "sample_time_ms": 191179.267, "load_time_ms": 145.416, "grad_time_ms": 11532.435, "update_time_ms": 4.393, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12366.3310546875, "policy_loss": 0.00012800020340364426, "vf_loss": 12366.333984375, "vf_explained_var": 0.6659387350082397, "kl": 0.002436436014249921, "entropy": 0.44487717747688293, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3140800, "episodes_total": 2415, "training_iteration": 302, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-52-08", "timestamp": 1710341528, "time_this_iter_s": 208.15594744682312, "time_total_s": 48369.86223769188, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48369.86223769188, "timesteps_since_restore": 3140800, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 35.63838383838384, "ram_util_percent": 35.82996632996633}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 243928.33903819867, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 865.0247847022897}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.062674231072826, "mean_processing_ms": 3.6985493178703286, "mean_inference_ms": 0.8347738097749118}, "off_policy_estimator": {}, "info": {"num_steps_trained": 187963520, "num_steps_sampled": 3151200, "sample_time_ms": 192413.004, "load_time_ms": 143.766, "grad_time_ms": 11635.312, "update_time_ms": 4.397, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12706.50390625, "policy_loss": 0.00020052371837664396, "vf_loss": 12706.5087890625, "vf_explained_var": 0.6646859645843506, "kl": 0.0023681854363530874, "entropy": 0.4656640887260437, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3151200, "episodes_total": 2423, "training_iteration": 303, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-55-34", "timestamp": 1710341734, "time_this_iter_s": 206.116459608078, "time_total_s": 48575.97869729996, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48575.97869729996, "timesteps_since_restore": 3151200, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 35.855782312925164, "ram_util_percent": 35.94183673469388}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 241926.87397681008, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 857.9271391780206}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.111872237979604, "mean_processing_ms": 3.7007763850296294, "mean_inference_ms": 0.8348800793203668}, "off_policy_estimator": {}, "info": {"num_steps_trained": 188752640, "num_steps_sampled": 3161600, "sample_time_ms": 193836.518, "load_time_ms": 144.103, "grad_time_ms": 11739.03, "update_time_ms": 4.396, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12753.18359375, "policy_loss": 0.00015208710101433098, "vf_loss": 12753.1875, "vf_explained_var": 0.6717863082885742, "kl": 0.002349438611418009, "entropy": 0.43707722425460815, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3161600, "episodes_total": 2431, "training_iteration": 304, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_10-59-00", "timestamp": 1710341940, "time_this_iter_s": 205.52318716049194, "time_total_s": 48781.50188446045, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48781.50188446045, "timesteps_since_restore": 3161600, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 35.97244897959184, "ram_util_percent": 36.02959183673469}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 276087.38171881903, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 240525.03651145272, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 852.9559080515363}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.161583513727344, "mean_processing_ms": 3.7030363912550945, "mean_inference_ms": 0.8349888332229102}, "off_policy_estimator": {}, "info": {"num_steps_trained": 189527168, "num_steps_sampled": 3172000, "sample_time_ms": 194294.58, "load_time_ms": 146.014, "grad_time_ms": 11780.425, "update_time_ms": 4.414, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13151.3232421875, "policy_loss": 0.00022072839783504605, "vf_loss": 13151.326171875, "vf_explained_var": 0.6686905026435852, "kl": 0.0023512239567935467, "entropy": 0.42407479882240295, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3172000, "episodes_total": 2439, "training_iteration": 305, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-02-21", "timestamp": 1710342141, "time_this_iter_s": 200.31038069725037, "time_total_s": 48981.8122651577, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48981.8122651577, "timesteps_since_restore": 3172000, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 35.76993006993007, "ram_util_percent": 35.94615384615384}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 267823.1780113287, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 239701.2998080831, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 850.0347523248454}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.21169148290463, "mean_processing_ms": 3.7053192334616836, "mean_inference_ms": 0.8350980487440981}, "off_policy_estimator": {}, "info": {"num_steps_trained": 190285952, "num_steps_sampled": 3182400, "sample_time_ms": 193541.909, "load_time_ms": 146.161, "grad_time_ms": 11729.38, "update_time_ms": 4.233, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14001.712890625, "policy_loss": 0.0001925304823089391, "vf_loss": 14001.716796875, "vf_explained_var": 0.6686405539512634, "kl": 0.002197922905907035, "entropy": 0.4111916124820709, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3182400, "episodes_total": 2447, "training_iteration": 306, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-05-39", "timestamp": 1710342339, "time_this_iter_s": 197.84486389160156, "time_total_s": 49179.6571290493, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49179.6571290493, "timesteps_since_restore": 3182400, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 35.6113475177305, "ram_util_percent": 35.933687943262406}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 266379.5603973991, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 239946.45100887492, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 850.9041136525228}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.26095549150236, "mean_processing_ms": 3.707568729233989, "mean_inference_ms": 0.8352053710686416}, "off_policy_estimator": {}, "info": {"num_steps_trained": 191008000, "num_steps_sampled": 3192800, "sample_time_ms": 191470.93, "load_time_ms": 143.825, "grad_time_ms": 11608.006, "update_time_ms": 4.16, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15357.1640625, "policy_loss": 4.87705874547828e-05, "vf_loss": 15357.16796875, "vf_explained_var": 0.6630748510360718, "kl": 0.002328245434910059, "entropy": 0.40970346331596375, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3192800, "episodes_total": 2455, "training_iteration": 307, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-08-44", "timestamp": 1710342524, "time_this_iter_s": 184.74730229377747, "time_total_s": 49364.40443134308, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49364.40443134308, "timesteps_since_restore": 3192800, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 35.6530303030303, "ram_util_percent": 35.94772727272727}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 241616.6837086503, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 856.8271346808409}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.30809352042207, "mean_processing_ms": 3.709730652635681, "mean_inference_ms": 0.8353077727718285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 191711360, "num_steps_sampled": 3203200, "sample_time_ms": 189176.895, "load_time_ms": 142.883, "grad_time_ms": 11453.447, "update_time_ms": 4.15, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15941.2998046875, "policy_loss": 0.0003105594078078866, "vf_loss": 15941.3037109375, "vf_explained_var": 0.6577579379081726, "kl": 0.0020391694270074368, "entropy": 0.4268195629119873, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3203200, "episodes_total": 2463, "training_iteration": 308, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-11-45", "timestamp": 1710342705, "time_this_iter_s": 181.39079999923706, "time_total_s": 49545.795231342316, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49545.795231342316, "timesteps_since_restore": 3203200, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 35.70424710424711, "ram_util_percent": 35.98069498069498}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 243858.83497349746, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 864.7783076474253}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.35301597406308, "mean_processing_ms": 3.711797012295128, "mean_inference_ms": 0.8354022000790294}, "off_policy_estimator": {}, "info": {"num_steps_trained": 192419200, "num_steps_sampled": 3213600, "sample_time_ms": 186796.24, "load_time_ms": 139.658, "grad_time_ms": 11314.535, "update_time_ms": 3.958, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15876.9970703125, "policy_loss": 6.523235788336024e-05, "vf_loss": 15877.0009765625, "vf_explained_var": 0.6542211771011353, "kl": 0.002160650445148349, "entropy": 0.41704508662223816, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3213600, "episodes_total": 2471, "training_iteration": 309, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-14-46", "timestamp": 1710342886, "time_this_iter_s": 180.36306977272034, "time_total_s": 49726.158301115036, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49726.158301115036, "timesteps_since_restore": 3213600, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 35.712015503875975, "ram_util_percent": 36.012403100775195}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 246073.5102727776, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1521.7126631736755}, "policy_reward_mean": {"shared_policy": 872.6320446568232}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.39580278693327, "mean_processing_ms": 3.7137676925543754, "mean_inference_ms": 0.8354914404649949}, "off_policy_estimator": {}, "info": {"num_steps_trained": 193144320, "num_steps_sampled": 3224000, "sample_time_ms": 184387.21, "load_time_ms": 138.567, "grad_time_ms": 11190.46, "update_time_ms": 3.935, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15396.1513671875, "policy_loss": 8.655979036120698e-05, "vf_loss": 15396.154296875, "vf_explained_var": 0.6622363328933716, "kl": 0.002693125046789646, "entropy": 0.3802412152290344, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3224000, "episodes_total": 2479, "training_iteration": 310, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-17-53", "timestamp": 1710343073, "time_this_iter_s": 186.47362184524536, "time_total_s": 49912.63192296028, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 49912.63192296028, "timesteps_since_restore": 3224000, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 35.422180451127815, "ram_util_percent": 36.02781954887218}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 247204.8207901243, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -50.03418821841478}, "policy_reward_max": {"shared_policy": 1519.350445985794}, "policy_reward_mean": {"shared_policy": 876.6750152142858}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.43739363011052, "mean_processing_ms": 3.7156812837784177, "mean_inference_ms": 0.8355749336442687}, "off_policy_estimator": {}, "info": {"num_steps_trained": 193909376, "num_steps_sampled": 3234400, "sample_time_ms": 183252.033, "load_time_ms": 137.678, "grad_time_ms": 11130.855, "update_time_ms": 3.934, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14223.09375, "policy_loss": 0.00019074510782957077, "vf_loss": 14223.09765625, "vf_explained_var": 0.6674326062202454, "kl": 0.0028326220344752073, "entropy": 0.3839378356933594, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3234400, "episodes_total": 2487, "training_iteration": 311, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-21-08", "timestamp": 1710343268, "time_this_iter_s": 195.4024486541748, "time_total_s": 50108.034371614456, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50108.034371614456, "timesteps_since_restore": 3234400, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 35.59283154121864, "ram_util_percent": 35.97240143369175}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 247876.993114709, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -32.30484713241458}, "policy_reward_max": {"shared_policy": 1519.350445985794}, "policy_reward_mean": {"shared_policy": 879.0587740786901}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.47782258859697, "mean_processing_ms": 3.7175488791295908, "mean_inference_ms": 0.8356543717744419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 194680832, "num_steps_sampled": 3244800, "sample_time_ms": 182421.348, "load_time_ms": 136.094, "grad_time_ms": 11054.852, "update_time_ms": 3.959, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14014.515625, "policy_loss": 0.00017657445278018713, "vf_loss": 14014.51953125, "vf_explained_var": 0.6720659136772156, "kl": 0.0022855561692267656, "entropy": 0.3894785940647125, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3244800, "episodes_total": 2495, "training_iteration": 312, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-24-27", "timestamp": 1710343467, "time_this_iter_s": 199.06058597564697, "time_total_s": 50307.0949575901, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50307.0949575901, "timesteps_since_restore": 3244800, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 35.600352112676056, "ram_util_percent": 36.14542253521127}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 222454.78644844855, "episode_reward_mean": 247719.1605394408, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 2.9999828338623047}, "policy_reward_max": {"shared_policy": 1519.350445985794}, "policy_reward_mean": {"shared_policy": 878.499044398329}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.51764827214756, "mean_processing_ms": 3.7193880133292567, "mean_inference_ms": 0.8357310886622388}, "off_policy_estimator": {}, "info": {"num_steps_trained": 195473664, "num_steps_sampled": 3255200, "sample_time_ms": 182478.891, "load_time_ms": 135.694, "grad_time_ms": 11053.13, "update_time_ms": 3.818, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13447.4404296875, "policy_loss": 0.0002334388846065849, "vf_loss": 13447.4443359375, "vf_explained_var": 0.66963791847229, "kl": 0.0022492720745503902, "entropy": 0.37955495715141296, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3255200, "episodes_total": 2503, "training_iteration": 313, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-27-54", "timestamp": 1710343674, "time_this_iter_s": 206.65724277496338, "time_total_s": 50513.75220036507, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50513.75220036507, "timesteps_since_restore": 3255200, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 35.43559322033898, "ram_util_percent": 36.09152542372881}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 216156.33605171338, "episode_reward_mean": 246777.14048356883, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": 2.9999828338623047}, "policy_reward_max": {"shared_policy": 1519.350445985794}, "policy_reward_mean": {"shared_policy": 875.1583108148408}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.55754539396455, "mean_processing_ms": 3.721230298808207, "mean_inference_ms": 0.8358038147972064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 196295808, "num_steps_sampled": 3265600, "sample_time_ms": 182822.136, "load_time_ms": 135.422, "grad_time_ms": 11075.046, "update_time_ms": 3.709, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12375.064453125, "policy_loss": 8.498273382429034e-05, "vf_loss": 12375.0693359375, "vf_explained_var": 0.6740604639053345, "kl": 0.002588884672150016, "entropy": 0.4383368492126465, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3265600, "episodes_total": 2511, "training_iteration": 314, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-31-24", "timestamp": 1710343884, "time_this_iter_s": 209.14936780929565, "time_total_s": 50722.90156817436, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50722.90156817436, "timesteps_since_restore": 3265600, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 35.972240802675586, "ram_util_percent": 36.18896321070233}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 211000.54353541182, "episode_reward_mean": 245429.32264483505, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1520.2019019126892}, "policy_reward_mean": {"shared_policy": 870.3784759374247}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.59739186502604, "mean_processing_ms": 3.7230698090427565, "mean_inference_ms": 0.8358725153194371}, "off_policy_estimator": {}, "info": {"num_steps_trained": 197121280, "num_steps_sampled": 3276000, "sample_time_ms": 183555.232, "load_time_ms": 134.418, "grad_time_ms": 11127.111, "update_time_ms": 3.662, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12087.560546875, "policy_loss": -1.4461645150731783e-05, "vf_loss": 12087.5654296875, "vf_explained_var": 0.6839917302131653, "kl": 0.0022024977952241898, "entropy": 0.4961538016796112, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3276000, "episodes_total": 2519, "training_iteration": 315, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-34-52", "timestamp": 1710344092, "time_this_iter_s": 208.13449096679688, "time_total_s": 50931.03605914116, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 50931.03605914116, "timesteps_since_restore": 3276000, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 36.02626262626262, "ram_util_percent": 36.065993265993264}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 243634.4787710604, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1520.2019019126892}, "policy_reward_mean": {"shared_policy": 864.013329920776}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.63762334780749, "mean_processing_ms": 3.724915192554057, "mean_inference_ms": 0.8359358697967756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 197959296, "num_steps_sampled": 3286400, "sample_time_ms": 185223.977, "load_time_ms": 134.161, "grad_time_ms": 11207.944, "update_time_ms": 3.681, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 11760.681640625, "policy_loss": 7.857896707719192e-05, "vf_loss": 11760.6875, "vf_explained_var": 0.6793692111968994, "kl": 0.0021086670458316803, "entropy": 0.5428016185760498, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3286400, "episodes_total": 2527, "training_iteration": 316, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-38-27", "timestamp": 1710344307, "time_this_iter_s": 215.31654620170593, "time_total_s": 51146.352605342865, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51146.352605342865, "timesteps_since_restore": 3286400, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 35.51818181818182, "ram_util_percent": 36.15844155844156}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 242116.6179605249, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1520.2019019126892}, "policy_reward_mean": {"shared_policy": 858.6000140449124}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.67795850409655, "mean_processing_ms": 3.726770468699084, "mean_inference_ms": 0.8359953996560171}, "off_policy_estimator": {}, "info": {"num_steps_trained": 198783744, "num_steps_sampled": 3296800, "sample_time_ms": 187585.135, "load_time_ms": 136.554, "grad_time_ms": 11358.106, "update_time_ms": 3.693, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 12043.8837890625, "policy_loss": -1.3339188171812566e-06, "vf_loss": 12043.888671875, "vf_explained_var": 0.6894986033439636, "kl": 0.003024893347173929, "entropy": 0.4978632926940918, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3296800, "episodes_total": 2535, "training_iteration": 317, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-41-57", "timestamp": 1710344517, "time_this_iter_s": 209.9024908542633, "time_total_s": 51356.25509619713, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51356.25509619713, "timesteps_since_restore": 3296800, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 35.669333333333334, "ram_util_percent": 36.09633333333334}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 241213.09495438356, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 855.4262534732377}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.71809966903162, "mean_processing_ms": 3.728610844929223, "mean_inference_ms": 0.8360511393027602}, "off_policy_estimator": {}, "info": {"num_steps_trained": 199560320, "num_steps_sampled": 3307200, "sample_time_ms": 188965.928, "load_time_ms": 137.012, "grad_time_ms": 11459.656, "update_time_ms": 3.652, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 13673.427734375, "policy_loss": -0.0001243589213117957, "vf_loss": 13673.431640625, "vf_explained_var": 0.6888999938964844, "kl": 0.0030299914069473743, "entropy": 0.4192710220813751, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3307200, "episodes_total": 2543, "training_iteration": 318, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-45-14", "timestamp": 1710344714, "time_this_iter_s": 196.22899317741394, "time_total_s": 51552.48408937454, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51552.48408937454, "timesteps_since_restore": 3307200, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 35.762142857142855, "ram_util_percent": 36.11892857142857}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 272858.7081380832, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 240547.43214978502, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 853.0655796502765}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.75822388201963, "mean_processing_ms": 3.73044899052835, "mean_inference_ms": 0.8361076576463151}, "off_policy_estimator": {}, "info": {"num_steps_trained": 200323712, "num_steps_sampled": 3317600, "sample_time_ms": 190374.918, "load_time_ms": 140.116, "grad_time_ms": 11518.849, "update_time_ms": 3.857, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14343.396484375, "policy_loss": 7.996185013325885e-05, "vf_loss": 14343.3994140625, "vf_explained_var": 0.6736598014831543, "kl": 0.0022128799464553595, "entropy": 0.43152663111686707, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3317600, "episodes_total": 2551, "training_iteration": 319, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-48-29", "timestamp": 1710344909, "time_this_iter_s": 195.0968873500824, "time_total_s": 51747.580976724625, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51747.580976724625, "timesteps_since_restore": 3317600, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 35.817266187050365, "ram_util_percent": 36.19028776978417}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 273636.8887786132, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 240422.52281742028, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 852.6226073388904}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.79830988492091, "mean_processing_ms": 3.732282220001823, "mean_inference_ms": 0.8361639694008908}, "off_policy_estimator": {}, "info": {"num_steps_trained": 201046144, "num_steps_sampled": 3328000, "sample_time_ms": 190390.03, "load_time_ms": 138.366, "grad_time_ms": 11510.103, "update_time_ms": 3.818, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 15830.5625, "policy_loss": 0.00016478034376632422, "vf_loss": 15830.5654296875, "vf_explained_var": 0.6577815413475037, "kl": 0.002106295432895422, "entropy": 0.40165576338768005, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3328000, "episodes_total": 2559, "training_iteration": 320, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-51-36", "timestamp": 1710345096, "time_this_iter_s": 186.51128935813904, "time_total_s": 51934.092266082764, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 51934.092266082764, "timesteps_since_restore": 3328000, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 35.43071161048689, "ram_util_percent": 36.15767790262172}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 275597.80013193307, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 240982.07848994457, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 854.6069880486014}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.837812245527374, "mean_processing_ms": 3.734086776323953, "mean_inference_ms": 0.8362211837908601}, "off_policy_estimator": {}, "info": {"num_steps_trained": 201738240, "num_steps_sampled": 3338400, "sample_time_ms": 188847.991, "load_time_ms": 136.258, "grad_time_ms": 11407.425, "update_time_ms": 3.855, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16988.75390625, "policy_loss": 3.0911342037143186e-05, "vf_loss": 16988.7578125, "vf_explained_var": 0.6493772864341736, "kl": 0.002206414472311735, "entropy": 0.39724817872047424, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3338400, "episodes_total": 2567, "training_iteration": 321, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-54-35", "timestamp": 1710345275, "time_this_iter_s": 178.9205973148346, "time_total_s": 52113.0128633976, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52113.0128633976, "timesteps_since_restore": 3338400, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 35.641176470588235, "ram_util_percent": 36.126666666666665}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 282697.82811869564, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 241559.7260805254, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 856.6555290464765}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.87640075581871, "mean_processing_ms": 3.735847506624261, "mean_inference_ms": 0.836277452329142}, "off_policy_estimator": {}, "info": {"num_steps_trained": 202423552, "num_steps_sampled": 3348800, "sample_time_ms": 186665.714, "load_time_ms": 134.01, "grad_time_ms": 11274.737, "update_time_ms": 3.797, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17521.240234375, "policy_loss": 3.73958027921617e-05, "vf_loss": 17521.244140625, "vf_explained_var": 0.6419692039489746, "kl": 0.0026049409061670303, "entropy": 0.4168742597103119, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3348800, "episodes_total": 2575, "training_iteration": 322, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_11-57-31", "timestamp": 1710345451, "time_this_iter_s": 175.88247919082642, "time_total_s": 52288.895342588425, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52288.895342588425, "timesteps_since_restore": 3348800, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 35.654183266932264, "ram_util_percent": 36.234262948207174}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 282697.82811869564, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 242710.09793752906, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 860.7351512076355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.91362124821872, "mean_processing_ms": 3.737544057701913, "mean_inference_ms": 0.8363311428896136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 203110016, "num_steps_sampled": 3359200, "sample_time_ms": 183759.67, "load_time_ms": 130.302, "grad_time_ms": 11102.428, "update_time_ms": 3.869, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 17860.638671875, "policy_loss": 0.00010955255856970325, "vf_loss": 17860.642578125, "vf_explained_var": 0.628396213054657, "kl": 0.0024709878489375114, "entropy": 0.42630329728126526, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3359200, "episodes_total": 2583, "training_iteration": 323, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_12-00-27", "timestamp": 1710345627, "time_this_iter_s": 175.8292942047119, "time_total_s": 52464.72463679314, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52464.72463679314, "timesteps_since_restore": 3359200, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 35.52777777777778, "ram_util_percent": 36.27619047619048}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 282697.82811869564, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 244150.13550319488, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 865.8420295878959}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.9490422211601, "mean_processing_ms": 3.739161272216798, "mean_inference_ms": 0.8363826095332141}, "off_policy_estimator": {}, "info": {"num_steps_trained": 203814400, "num_steps_sampled": 3369600, "sample_time_ms": 181332.162, "load_time_ms": 127.702, "grad_time_ms": 10929.996, "update_time_ms": 3.884, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16740.021484375, "policy_loss": -6.753673369530588e-05, "vf_loss": 16740.025390625, "vf_explained_var": 0.6319741606712341, "kl": 0.002473840257152915, "entropy": 0.45227155089378357, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3369600, "episodes_total": 2591, "training_iteration": 324, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_12-03-30", "timestamp": 1710345810, "time_this_iter_s": 183.10147762298584, "time_total_s": 52647.82611441612, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52647.82611441612, "timesteps_since_restore": 3369600, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 35.195402298850574, "ram_util_percent": 36.1544061302682}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 282697.82811869564, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 245735.4909674026, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 871.4642562146344}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.982719626044506, "mean_processing_ms": 3.7406983197292116, "mean_inference_ms": 0.8364328059696342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 204529792, "num_steps_sampled": 3380000, "sample_time_ms": 179251.021, "load_time_ms": 125.806, "grad_time_ms": 10788.516, "update_time_ms": 4.0, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 16100.0263671875, "policy_loss": 2.2817008357378654e-05, "vf_loss": 16100.03125, "vf_explained_var": 0.6357929706573486, "kl": 0.0026871126610785723, "entropy": 0.44302716851234436, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3380000, "episodes_total": 2599, "training_iteration": 325, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_12-06-36", "timestamp": 1710345996, "time_this_iter_s": 185.88215255737305, "time_total_s": 52833.708266973495, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 52833.708266973495, "timesteps_since_restore": 3380000, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 35.50754716981132, "ram_util_percent": 36.20716981132075}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}
{"episode_reward_max": 282697.82811869564, "episode_reward_min": 202706.06337176578, "episode_reward_mean": 246862.4416818342, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -43.83214768022299}, "policy_reward_max": {"shared_policy": 1521.6426284313202}, "policy_reward_mean": {"shared_policy": 875.4608187879785}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.015488027245176, "mean_processing_ms": 3.742197500733488, "mean_inference_ms": 0.8364861225873489}, "off_policy_estimator": {}, "info": {"num_steps_trained": 205284224, "num_steps_sampled": 3390400, "sample_time_ms": 177241.773, "load_time_ms": 124.782, "grad_time_ms": 10624.195, "update_time_ms": 4.155, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 14886.4345703125, "policy_loss": 9.894160757539794e-05, "vf_loss": 14886.4404296875, "vf_explained_var": 0.6352607011795044, "kl": 0.0023400415666401386, "entropy": 0.4654957354068756, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 3390400, "episodes_total": 2607, "training_iteration": 326, "experiment_id": "1ed7dc0f5e3e4e0eafdf43f34c61151c", "date": "2024-03-13_12-09-50", "timestamp": 1710346190, "time_this_iter_s": 193.56928372383118, "time_total_s": 53027.27755069733, "pid": 6961, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1440.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2160.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f2ef056ad90>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 53027.27755069733, "timesteps_since_restore": 3390400, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 36.28086642599278, "ram_util_percent": 36.222743682310465}, "num_healthy_workers": 4, "trial_id": "8e3bb9f0", "experiment_tag": "0"}

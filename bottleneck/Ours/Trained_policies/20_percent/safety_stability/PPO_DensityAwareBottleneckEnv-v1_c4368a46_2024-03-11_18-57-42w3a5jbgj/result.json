{"episode_reward_max": -658139.9998869782, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -718944.6853576063, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 451.7122720479965}, "policy_reward_mean": {"shared_policy": -5071.920178889639}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.92095657111773, "mean_processing_ms": 3.079527068807271, "mean_inference_ms": 0.6958684844266723}, "off_policy_estimator": {}, "info": {"num_steps_trained": 628736, "num_steps_sampled": 10400, "sample_time_ms": 159217.335, "load_time_ms": 138.918, "grad_time_ms": 9036.351, "update_time_ms": 372.55, "learner": {"shared_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 81937.0, "policy_loss": -0.005292488727718592, "vf_loss": 81937.1484375, "vf_explained_var": 1.0237874192853269e-07, "kl": 0.010485809296369553, "entropy": 1.4464225769042969, "entropy_coeff": 0.10000000149011612}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 10400, "episodes_total": 8, "training_iteration": 1, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-00-36", "timestamp": 1710198036, "time_this_iter_s": 168.85165333747864, "time_total_s": 168.85165333747864, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 168.85165333747864, "timesteps_since_restore": 10400, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.366390041493773, "ram_util_percent": 27.590456431535266}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -434874.76628151943, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -641741.7051234087, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 484.45204281806946}, "policy_reward_mean": {"shared_policy": -4852.489263693072}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 55.56183497045687, "mean_processing_ms": 3.0823002026438457, "mean_inference_ms": 0.6991945332558583}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1237376, "num_steps_sampled": 20800, "sample_time_ms": 158327.065, "load_time_ms": 112.835, "grad_time_ms": 8623.837, "update_time_ms": 187.697, "learner": {"shared_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.480000153416768e-05, "total_loss": 54819.7265625, "policy_loss": -0.005720411892980337, "vf_loss": 54819.87109375, "vf_explained_var": -2.6323818680396016e-09, "kl": 0.01012476347386837, "entropy": 1.482534408569336, "entropy_coeff": 0.09167999774217606}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 20800, "episodes_total": 16, "training_iteration": 2, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-03-22", "timestamp": 1710198202, "time_this_iter_s": 165.79758667945862, "time_total_s": 334.64924001693726, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 334.64924001693726, "timesteps_since_restore": 20800, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.326160337552743, "ram_util_percent": 28.778902953586496}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -370350.57676460024, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -575378.243310343, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 490.90867280960083}, "policy_reward_mean": {"shared_policy": -4568.00457805102}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.99306113100224, "mean_processing_ms": 3.0722165668741326, "mean_inference_ms": 0.6998245329847381}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1817600, "num_steps_sampled": 31200, "sample_time_ms": 155257.156, "load_time_ms": 101.137, "grad_time_ms": 8404.322, "update_time_ms": 126.003, "learner": {"shared_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 8.959999831859022e-05, "total_loss": 37001.75, "policy_loss": -0.004356109071522951, "vf_loss": 37001.8828125, "vf_explained_var": -6.982145528411365e-09, "kl": 0.007387268356978893, "entropy": 1.508442759513855, "entropy_coeff": 0.08336000144481659}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 31200, "episodes_total": 24, "training_iteration": 3, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-05-59", "timestamp": 1710198359, "time_this_iter_s": 157.2232484817505, "time_total_s": 491.87248849868774, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 491.87248849868774, "timesteps_since_restore": 31200, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.021874999999998, "ram_util_percent": 29.199107142857144}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -278559.4717691939, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -527151.0983581701, "episode_len_mean": 1300.0, "episodes_this_iter": 7, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 490.90867280960083}, "policy_reward_mean": {"shared_policy": -4355.459501360148}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 54.45275147565743, "mean_processing_ms": 3.0550124637893896, "mean_inference_ms": 0.7007288413816246}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2369536, "num_steps_sampled": 41600, "sample_time_ms": 152530.732, "load_time_ms": 94.979, "grad_time_ms": 8210.969, "update_time_ms": 95.244, "learner": {"shared_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 8.440000237897038e-05, "total_loss": 24962.890625, "policy_loss": -0.002238717395812273, "vf_loss": 24963.009765625, "vf_explained_var": -2.031976586991391e-09, "kl": 0.00582141662016511, "entropy": 1.5322140455245972, "entropy_coeff": 0.07503999769687653}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 41600, "episodes_total": 31, "training_iteration": 4, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-08-31", "timestamp": 1710198511, "time_this_iter_s": 152.12120652198792, "time_total_s": 643.9936950206757, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 643.9936950206757, "timesteps_since_restore": 41600, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.44009216589862, "ram_util_percent": 29.45990783410138}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -273846.00221719296, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -483525.77288830164, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 490.90867280960083}, "policy_reward_mean": {"shared_policy": -4139.9572212170715}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.93726485701082, "mean_processing_ms": 3.039542103204697, "mean_inference_ms": 0.7019732660696919}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2914176, "num_steps_sampled": 52000, "sample_time_ms": 150329.82, "load_time_ms": 91.239, "grad_time_ms": 8060.004, "update_time_ms": 76.894, "learner": {"shared_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 7.919999916339293e-05, "total_loss": 19496.74609375, "policy_loss": -0.0023660066071897745, "vf_loss": 19496.8515625, "vf_explained_var": -8.362860626220936e-09, "kl": 0.005676023196429014, "entropy": 1.538854718208313, "entropy_coeff": 0.06672000139951706}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 52000, "episodes_total": 39, "training_iteration": 5, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-11-00", "timestamp": 1710198660, "time_this_iter_s": 149.11787271499634, "time_total_s": 793.111567735672, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 793.111567735672, "timesteps_since_restore": 52000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.48169014084507, "ram_util_percent": 29.780751173708907}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -273846.00221719296, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -453182.3561452722, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 490.90867280960083}, "policy_reward_mean": {"shared_policy": -3953.883560205643}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.505387312441144, "mean_processing_ms": 3.027742336599822, "mean_inference_ms": 0.7029484990527042}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3454592, "num_steps_sampled": 62400, "sample_time_ms": 148102.909, "load_time_ms": 88.266, "grad_time_ms": 7941.406, "update_time_ms": 64.694, "learner": {"shared_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 7.400000322377309e-05, "total_loss": 18755.3515625, "policy_loss": -0.00189676764421165, "vf_loss": 18755.44140625, "vf_explained_var": -8.103521409452696e-09, "kl": 0.0034721612464636564, "entropy": 1.5262548923492432, "entropy_coeff": 0.058400001376867294}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 62400, "episodes_total": 47, "training_iteration": 6, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-13-25", "timestamp": 1710198805, "time_this_iter_s": 144.50613403320312, "time_total_s": 937.6177017688751, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 937.6177017688751, "timesteps_since_restore": 62400, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.797572815533982, "ram_util_percent": 29.932524271844667}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -225954.03942511347, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -423203.5542313322, "episode_len_mean": 1300.0, "episodes_this_iter": 9, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 537.3270127773285}, "policy_reward_mean": {"shared_policy": -3719.886836753194}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 53.05663753866078, "mean_processing_ms": 3.018829290615124, "mean_inference_ms": 0.7037127117712431}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3967488, "num_steps_sampled": 72800, "sample_time_ms": 146655.272, "load_time_ms": 85.447, "grad_time_ms": 7800.557, "update_time_ms": 55.836, "learner": {"shared_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 6.880000000819564e-05, "total_loss": 17443.041015625, "policy_loss": -0.0016844209749251604, "vf_loss": 17443.119140625, "vf_explained_var": -6.7384338109377495e-09, "kl": 0.0020311488769948483, "entropy": 1.5064276456832886, "entropy_coeff": 0.05008000135421753}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 72800, "episodes_total": 56, "training_iteration": 7, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-15-50", "timestamp": 1710198950, "time_this_iter_s": 145.0492765903473, "time_total_s": 1082.6669783592224, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1082.6669783592224, "timesteps_since_restore": 72800, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.336231884057973, "ram_util_percent": 30.028019323671504}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -215645.28951850545, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -398664.75205137883, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 537.3270127773285}, "policy_reward_mean": {"shared_policy": -3538.7717241731275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.64808408889254, "mean_processing_ms": 3.009176841583029, "mean_inference_ms": 0.7041693678455335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4454912, "num_steps_sampled": 83200, "sample_time_ms": 143839.058, "load_time_ms": 82.61, "grad_time_ms": 7659.573, "update_time_ms": 49.221, "learner": {"shared_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 6.359999679261819e-05, "total_loss": 13395.6123046875, "policy_loss": -0.0025962742511183023, "vf_loss": 13395.6767578125, "vf_explained_var": -2.081779859608446e-09, "kl": 0.004919076804071665, "entropy": 1.4775049686431885, "entropy_coeff": 0.041760001331567764}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 83200, "episodes_total": 64, "training_iteration": 8, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-18-01", "timestamp": 1710199081, "time_this_iter_s": 130.9138262271881, "time_total_s": 1213.5808045864105, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1213.5808045864105, "timesteps_since_restore": 83200, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.771657754010697, "ram_util_percent": 30.13689839572193}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -195489.69969823555, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -377624.98856373184, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 537.3270127773285}, "policy_reward_mean": {"shared_policy": -3335.664234644668}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 52.236534175607176, "mean_processing_ms": 2.998295515514913, "mean_inference_ms": 0.704355212594741}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4924544, "num_steps_sampled": 93600, "sample_time_ms": 141222.324, "load_time_ms": 80.597, "grad_time_ms": 7523.394, "update_time_ms": 44.101, "learner": {"shared_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 5.8400000852998346e-05, "total_loss": 13660.771484375, "policy_loss": -0.002640757244080305, "vf_loss": 13660.822265625, "vf_explained_var": -8.44764613816551e-09, "kl": 0.003409439930692315, "entropy": 1.4226642847061157, "entropy_coeff": 0.033440001308918}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 93600, "episodes_total": 72, "training_iteration": 9, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-20-08", "timestamp": 1710199208, "time_this_iter_s": 126.83894371986389, "time_total_s": 1340.4197483062744, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1340.4197483062744, "timesteps_since_restore": 93600, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.56408839779006, "ram_util_percent": 30.168508287292816}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -173227.6940814571, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -358833.20279536856, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 537.3270127773285}, "policy_reward_mean": {"shared_policy": -3179.735957424622}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.84094328378683, "mean_processing_ms": 2.9872514495050853, "mean_inference_ms": 0.7045103228517223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5394432, "num_steps_sampled": 104000, "sample_time_ms": 139169.913, "load_time_ms": 79.421, "grad_time_ms": 7417.845, "update_time_ms": 40.006, "learner": {"shared_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 5.32000012753997e-05, "total_loss": 11115.892578125, "policy_loss": -0.003513915929943323, "vf_loss": 11115.9287109375, "vf_explained_var": -2.5978597051334873e-09, "kl": 0.005943009164184332, "entropy": 1.3504265546798706, "entropy_coeff": 0.025119999423623085}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 104000, "episodes_total": 80, "training_iteration": 10, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-22-15", "timestamp": 1710199335, "time_this_iter_s": 127.29080176353455, "time_total_s": 1467.710550069809, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1467.710550069809, "timesteps_since_restore": 104000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.80164835164835, "ram_util_percent": 30.190659340659344}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -155174.50606994706, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -341471.947259375, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 537.3270127773285}, "policy_reward_mean": {"shared_policy": -3006.4563640645324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.45537424734582, "mean_processing_ms": 2.9759099566654843, "mean_inference_ms": 0.7045874657416845}, "off_policy_estimator": {}, "info": {"num_steps_trained": 5844352, "num_steps_sampled": 114400, "sample_time_ms": 134832.818, "load_time_ms": 71.385, "grad_time_ms": 7128.706, "update_time_ms": 3.073, "learner": {"shared_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 10854.0791015625, "policy_loss": -0.0029566914308816195, "vf_loss": 10854.107421875, "vf_explained_var": -5.205868180979678e-09, "kl": 0.009128697216510773, "entropy": 1.2919275760650635, "entropy_coeff": 0.019899999722838402}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 114400, "episodes_total": 88, "training_iteration": 11, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-24-17", "timestamp": 1710199457, "time_this_iter_s": 122.1003212928772, "time_total_s": 1589.8108713626862, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1589.8108713626862, "timesteps_since_restore": 114400, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.93045977011494, "ram_util_percent": 30.230459770114933}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -131795.04557465913, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -325665.6455932733, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 537.3270127773285}, "policy_reward_mean": {"shared_policy": -2867.721700326017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 51.089559552785886, "mean_processing_ms": 2.965051121910076, "mean_inference_ms": 0.70463231004155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6304384, "num_steps_sampled": 124800, "sample_time_ms": 130781.092, "load_time_ms": 69.418, "grad_time_ms": 6933.543, "update_time_ms": 3.093, "learner": {"shared_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 8523.88671875, "policy_loss": -0.002689003711566329, "vf_loss": 8523.9130859375, "vf_explained_var": -2.885700567389904e-09, "kl": 0.00580397667363286, "entropy": 1.2190700769424438, "entropy_coeff": 0.01964000053703785}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 124800, "episodes_total": 96, "training_iteration": 12, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-26-20", "timestamp": 1710199580, "time_this_iter_s": 123.29776883125305, "time_total_s": 1713.1086401939392, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1713.1086401939392, "timesteps_since_restore": 124800, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.80965909090909, "ram_util_percent": 30.242613636363636}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -114172.83186366165, "episode_reward_min": -785948.6258135696, "episode_reward_mean": -294157.4845415343, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -15010.108901601285}, "policy_reward_max": {"shared_policy": 583.3720489740372}, "policy_reward_mean": {"shared_policy": -2606.1618192746905}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 50.542352625440486, "mean_processing_ms": 2.9490154523357246, "mean_inference_ms": 0.7049171135183019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6747008, "num_steps_sampled": 135200, "sample_time_ms": 127221.228, "load_time_ms": 67.971, "grad_time_ms": 6729.738, "update_time_ms": 3.11, "learner": {"shared_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 7371.9384765625, "policy_loss": -0.00206097774207592, "vf_loss": 7371.96337890625, "vf_explained_var": -3.998923414627598e-09, "kl": 0.005867155734449625, "entropy": 1.1599539518356323, "entropy_coeff": 0.019379999488592148}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 135200, "episodes_total": 104, "training_iteration": 13, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-28-20", "timestamp": 1710199700, "time_this_iter_s": 119.55777478218079, "time_total_s": 1832.66641497612, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1832.66641497612, "timesteps_since_restore": 135200, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.912280701754387, "ram_util_percent": 30.305263157894743}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -102452.56771664764, "episode_reward_min": -635361.3985675834, "episode_reward_mean": -252230.21459546886, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -12019.624382220209}, "policy_reward_max": {"shared_policy": 595.8125960826874}, "policy_reward_mean": {"shared_policy": -2255.882430869053}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.79846442492914, "mean_processing_ms": 2.9276914545529085, "mean_inference_ms": 0.7053502697421032}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7190784, "num_steps_sampled": 145600, "sample_time_ms": 124193.954, "load_time_ms": 65.985, "grad_time_ms": 6563.644, "update_time_ms": 3.144, "learner": {"shared_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6305.39306640625, "policy_loss": -0.0021611119154840708, "vf_loss": 6305.4169921875, "vf_explained_var": -4.435534606272995e-09, "kl": 0.005080264527350664, "entropy": 1.104071021080017, "entropy_coeff": 0.019120000302791595}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 145600, "episodes_total": 112, "training_iteration": 14, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-30-20", "timestamp": 1710199820, "time_this_iter_s": 120.15291786193848, "time_total_s": 1952.8193328380585, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1952.8193328380585, "timesteps_since_restore": 145600, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.852631578947374, "ram_util_percent": 30.29590643274854}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -83285.77173112647, "episode_reward_min": -496395.8718104236, "episode_reward_mean": -219235.03643834044, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -10886.475066959858}, "policy_reward_max": {"shared_policy": 595.8125960826874}, "policy_reward_mean": {"shared_policy": -1967.115625287936}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 49.076133851755145, "mean_processing_ms": 2.9053312951084154, "mean_inference_ms": 0.7054676297077362}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7636992, "num_steps_sampled": 156000, "sample_time_ms": 121458.435, "load_time_ms": 64.163, "grad_time_ms": 6393.992, "update_time_ms": 3.052, "learner": {"shared_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5157.1083984375, "policy_loss": -0.0022815463598817587, "vf_loss": 5157.13037109375, "vf_explained_var": -4.377162632351883e-09, "kl": 0.00501834275200963, "entropy": 1.0349727869033813, "entropy_coeff": 0.018859999254345894}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 156000, "episodes_total": 120, "training_iteration": 15, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-32-20", "timestamp": 1710199940, "time_this_iter_s": 120.0400218963623, "time_total_s": 2072.859354734421, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2072.859354734421, "timesteps_since_restore": 156000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.757309941520468, "ram_util_percent": 30.30935672514621}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -80016.45001733056, "episode_reward_min": -386946.4074249259, "episode_reward_mean": -193446.31981564566, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -8308.567690794822}, "policy_reward_max": {"shared_policy": 627.0352747440338}, "policy_reward_mean": {"shared_policy": -1732.7688983845007}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 48.42754349878309, "mean_processing_ms": 2.885863901363324, "mean_inference_ms": 0.7055684905038792}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8094208, "num_steps_sampled": 166400, "sample_time_ms": 119349.911, "load_time_ms": 63.049, "grad_time_ms": 6268.769, "update_time_ms": 2.959, "learner": {"shared_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4373.9765625, "policy_loss": -0.002435478614643216, "vf_loss": 4373.9970703125, "vf_explained_var": -5.623394638831769e-09, "kl": 0.006868516560643911, "entropy": 0.9678625464439392, "entropy_coeff": 0.01860000006854534}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 166400, "episodes_total": 128, "training_iteration": 16, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-34-22", "timestamp": 1710200062, "time_this_iter_s": 122.09319496154785, "time_total_s": 2194.9525496959686, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2194.9525496959686, "timesteps_since_restore": 166400, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.906285714285715, "ram_util_percent": 30.316571428571425}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -53898.3650326855, "episode_reward_min": -335528.14466952096, "episode_reward_mean": -172012.97798372913, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -7392.574179135263}, "policy_reward_max": {"shared_policy": 643.6624590158463}, "policy_reward_mean": {"shared_policy": -1511.6704278383793}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.832820905265656, "mean_processing_ms": 2.8681226883343154, "mean_inference_ms": 0.7053144386861573}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8509312, "num_steps_sampled": 176800, "sample_time_ms": 116284.01, "load_time_ms": 61.902, "grad_time_ms": 6129.972, "update_time_ms": 2.992, "learner": {"shared_policy": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 4695.08154296875, "policy_loss": -0.0017569309566169977, "vf_loss": 4695.1005859375, "vf_explained_var": -4.484592253106712e-09, "kl": 0.00455448217689991, "entropy": 0.9288100004196167, "entropy_coeff": 0.01834000088274479}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 176800, "episodes_total": 136, "training_iteration": 17, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-36-15", "timestamp": 1710200175, "time_this_iter_s": 112.98200392723083, "time_total_s": 2307.9345536231995, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2307.9345536231995, "timesteps_since_restore": 176800, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.740993788819875, "ram_util_percent": 30.32173913043479}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -41002.484625971876, "episode_reward_min": -318443.70445358614, "episode_reward_mean": -151533.17672721366, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -6878.387225600192}, "policy_reward_max": {"shared_policy": 680.7097728252411}, "policy_reward_mean": {"shared_policy": -1306.996521711348}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 47.26429800820078, "mean_processing_ms": 2.8501752296409792, "mean_inference_ms": 0.7049009773403917}, "off_policy_estimator": {}, "info": {"num_steps_trained": 8923136, "num_steps_sampled": 187200, "sample_time_ms": 114588.129, "load_time_ms": 61.191, "grad_time_ms": 6021.505, "update_time_ms": 2.948, "learner": {"shared_policy": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 3844.244873046875, "policy_loss": -0.0015675211325287819, "vf_loss": 3844.26220703125, "vf_explained_var": -6.508023453477563e-09, "kl": 0.004301984328776598, "entropy": 0.8685157299041748, "entropy_coeff": 0.018079999834299088}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 187200, "episodes_total": 144, "training_iteration": 18, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-38-08", "timestamp": 1710200288, "time_this_iter_s": 112.85608410835266, "time_total_s": 2420.790637731552, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2420.790637731552, "timesteps_since_restore": 187200, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.798757763975154, "ram_util_percent": 30.314285714285717}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -34583.32965305634, "episode_reward_min": -299422.32724096824, "episode_reward_mean": -133270.74661145333, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -6049.784238871187}, "policy_reward_max": {"shared_policy": 702.8317477703094}, "policy_reward_mean": {"shared_policy": -1136.4436480894803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.72857625629389, "mean_processing_ms": 2.831442071293014, "mean_inference_ms": 0.704443552907854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9348224, "num_steps_sampled": 197600, "sample_time_ms": 113621.395, "load_time_ms": 60.135, "grad_time_ms": 5956.362, "update_time_ms": 2.896, "learner": {"shared_policy": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 3640.469970703125, "policy_loss": -0.001646484131924808, "vf_loss": 3640.486328125, "vf_explained_var": -5.5997135817165145e-09, "kl": 0.004225186537951231, "entropy": 0.8250114321708679, "entropy_coeff": 0.017820000648498535}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 197600, "episodes_total": 152, "training_iteration": 19, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-40-05", "timestamp": 1710200405, "time_this_iter_s": 116.50604391098022, "time_total_s": 2537.2966816425323, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2537.2966816425323, "timesteps_since_restore": 197600, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.733132530120482, "ram_util_percent": 30.345180722891563}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -28148.40419308559, "episode_reward_min": -245917.02994679025, "episode_reward_mean": -116118.66670348817, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -5430.847608435899}, "policy_reward_max": {"shared_policy": 761.1218619346619}, "policy_reward_mean": {"shared_policy": -976.4435477925342}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 46.21533805961588, "mean_processing_ms": 2.813149675943348, "mean_inference_ms": 0.7039952742340276}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9755392, "num_steps_sampled": 208000, "sample_time_ms": 112161.16, "load_time_ms": 58.861, "grad_time_ms": 5855.037, "update_time_ms": 2.898, "learner": {"shared_policy": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 3525.995361328125, "policy_loss": -0.0014016152126714587, "vf_loss": 3526.01025390625, "vf_explained_var": -6.6144103527676634e-09, "kl": 0.0036768880672752857, "entropy": 0.769985020160675, "entropy_coeff": 0.017559999600052834}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 208000, "episodes_total": 160, "training_iteration": 20, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-41-56", "timestamp": 1710200516, "time_this_iter_s": 111.65362858772278, "time_total_s": 2648.950310230255, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2648.950310230255, "timesteps_since_restore": 208000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.64625, "ram_util_percent": 30.330000000000005}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": -16421.760331215337, "episode_reward_min": -226094.00765205213, "episode_reward_mean": -100839.03779841689, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -5430.847608435899}, "policy_reward_max": {"shared_policy": 761.1218619346619}, "policy_reward_mean": {"shared_policy": -834.8984748999577}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.744705075700814, "mean_processing_ms": 2.7963130956659334, "mean_inference_ms": 0.7036007348446413}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10160128, "num_steps_sampled": 218400, "sample_time_ms": 111190.32, "load_time_ms": 59.154, "grad_time_ms": 5784.038, "update_time_ms": 2.906, "learner": {"shared_policy": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 3465.889404296875, "policy_loss": -0.0009643746307119727, "vf_loss": 3465.9033203125, "vf_explained_var": -6.03209571181651e-09, "kl": 0.0034709437750279903, "entropy": 0.7393125295639038, "entropy_coeff": 0.01730000041425228}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 218400, "episodes_total": 168, "training_iteration": 21, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-43-48", "timestamp": 1710200628, "time_this_iter_s": 111.68144369125366, "time_total_s": 2760.631753921509, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2760.631753921509, "timesteps_since_restore": 218400, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 24.561006289308175, "ram_util_percent": 30.310062893081767}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 1754.903696176596, "episode_reward_min": -202684.37529838178, "episode_reward_mean": -84872.31678973442, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -4287.810399685055}, "policy_reward_max": {"shared_policy": 761.1218619346619}, "policy_reward_mean": {"shared_policy": -689.6824052473136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 45.295117681647774, "mean_processing_ms": 2.780247496318399, "mean_inference_ms": 0.7031709593488737}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10527744, "num_steps_sampled": 228800, "sample_time_ms": 109087.207, "load_time_ms": 57.302, "grad_time_ms": 5655.817, "update_time_ms": 2.933, "learner": {"shared_policy": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 3588.0966796875, "policy_loss": -0.0011131891515105963, "vf_loss": 3588.110107421875, "vf_explained_var": -4.835613687248497e-09, "kl": 0.003953261766582727, "entropy": 0.714856743812561, "entropy_coeff": 0.01703999936580658}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 228800, "episodes_total": 176, "training_iteration": 22, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-45-29", "timestamp": 1710200729, "time_this_iter_s": 100.95676040649414, "time_total_s": 2861.588514328003, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2861.588514328003, "timesteps_since_restore": 228800, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.47986111111111, "ram_util_percent": 30.350000000000005}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 2359.0621449211612, "episode_reward_min": -176382.21965322422, "episode_reward_mean": -70910.38524313056, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -4159.696051865816}, "policy_reward_max": {"shared_policy": 761.1218619346619}, "policy_reward_mean": {"shared_policy": -566.2864178496291}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.867597645184794, "mean_processing_ms": 2.764931333727254, "mean_inference_ms": 0.7027004750774657}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10893056, "num_steps_sampled": 239200, "sample_time_ms": 107291.729, "load_time_ms": 55.874, "grad_time_ms": 5554.658, "update_time_ms": 3.084, "learner": {"shared_policy": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 3629.609375, "policy_loss": -0.0008870019228197634, "vf_loss": 3629.62158203125, "vf_explained_var": -6.328033208546913e-09, "kl": 0.0033879324328154325, "entropy": 0.6776008605957031, "entropy_coeff": 0.016780000180006027}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 239200, "episodes_total": 184, "training_iteration": 23, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-47-10", "timestamp": 1710200830, "time_this_iter_s": 100.57120084762573, "time_total_s": 2962.1597151756287, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2962.1597151756287, "timesteps_since_restore": 239200, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.854545454545452, "ram_util_percent": 30.307692307692314}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 7470.920868967194, "episode_reward_min": -171905.64682167413, "episode_reward_mean": -57649.98356159173, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -4159.696051865816}, "policy_reward_max": {"shared_policy": 787.4565939903259}, "policy_reward_mean": {"shared_policy": -453.4013650144847}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.45690140654002, "mean_processing_ms": 2.7501661670741995, "mean_inference_ms": 0.7021802763494742}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11257472, "num_steps_sampled": 249600, "sample_time_ms": 105496.704, "load_time_ms": 54.929, "grad_time_ms": 5450.182, "update_time_ms": 3.127, "learner": {"shared_policy": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 3438.62744140625, "policy_loss": -0.0012156626908108592, "vf_loss": 3438.63916015625, "vf_explained_var": -6.657631335116321e-09, "kl": 0.0041983663104474545, "entropy": 0.6483375430107117, "entropy_coeff": 0.016519999131560326}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 249600, "episodes_total": 192, "training_iteration": 24, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-48-51", "timestamp": 1710200931, "time_this_iter_s": 101.14332938194275, "time_total_s": 3063.3030445575714, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3063.3030445575714, "timesteps_since_restore": 249600, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.49034482758621, "ram_util_percent": 30.309655172413798}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 7470.920868967194, "episode_reward_min": -127209.80960801858, "episode_reward_mean": -46971.553362626626, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3303.2451191842556}, "policy_reward_max": {"shared_policy": 787.4565939903259}, "policy_reward_mean": {"shared_policy": -364.48788207206206}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 44.06995971702278, "mean_processing_ms": 2.7360355826916454, "mean_inference_ms": 0.7016379052004166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11652224, "num_steps_sampled": 260000, "sample_time_ms": 104388.569, "load_time_ms": 54.638, "grad_time_ms": 5407.092, "update_time_ms": 3.153, "learner": {"shared_policy": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 2881.198486328125, "policy_loss": -0.000911267998162657, "vf_loss": 2881.209228515625, "vf_explained_var": -5.353594900725511e-09, "kl": 0.0038199040573090315, "entropy": 0.5988966822624207, "entropy_coeff": 0.016259999945759773}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 260000, "episodes_total": 200, "training_iteration": 25, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-50-39", "timestamp": 1710201039, "time_this_iter_s": 108.51975393295288, "time_total_s": 3171.8227984905243, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3171.8227984905243, "timesteps_since_restore": 260000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.221935483870965, "ram_util_percent": 30.31677419354839}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 22038.199303545058, "episode_reward_min": -112241.8383030332, "episode_reward_mean": -36486.5421055432, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3195.3446971562225}, "policy_reward_max": {"shared_policy": 787.4565939903259}, "policy_reward_mean": {"shared_policy": -279.1411682774325}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.69789137153024, "mean_processing_ms": 2.7225600943049937, "mean_inference_ms": 0.701123714824278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12019968, "num_steps_sampled": 270400, "sample_time_ms": 102685.363, "load_time_ms": 53.999, "grad_time_ms": 5289.009, "update_time_ms": 3.155, "learner": {"shared_policy": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 3146.28955078125, "policy_loss": -0.0006494094850495458, "vf_loss": 3146.298583984375, "vf_explained_var": -4.398254205284502e-09, "kl": 0.002988920547068119, "entropy": 0.5717755556106567, "entropy_coeff": 0.01600000075995922}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 270400, "episodes_total": 208, "training_iteration": 26, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-52-23", "timestamp": 1710201143, "time_this_iter_s": 103.86385416984558, "time_total_s": 3275.68665266037, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3275.68665266037, "timesteps_since_restore": 270400, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 24.441216216216215, "ram_util_percent": 30.4304054054054}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 26223.99578919541, "episode_reward_min": -111724.45623302253, "episode_reward_mean": -26689.091370158963, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3195.3446971562225}, "policy_reward_max": {"shared_policy": 795.6551299095154}, "policy_reward_mean": {"shared_policy": -201.0629152490505}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 43.3328391926533, "mean_processing_ms": 2.70945422069084, "mean_inference_ms": 0.7005654194978124}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12374784, "num_steps_sampled": 280800, "sample_time_ms": 101187.605, "load_time_ms": 53.206, "grad_time_ms": 5196.835, "update_time_ms": 3.141, "learner": {"shared_policy": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 3202.35595703125, "policy_loss": -0.0007710434729233384, "vf_loss": 3202.364990234375, "vf_explained_var": -5.07456565657094e-09, "kl": 0.002790858969092369, "entropy": 0.5332448482513428, "entropy_coeff": 0.01573999971151352}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 280800, "episodes_total": 216, "training_iteration": 27, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-54-00", "timestamp": 1710201240, "time_this_iter_s": 97.06581044197083, "time_total_s": 3372.7524631023407, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3372.7524631023407, "timesteps_since_restore": 280800, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.749275362318837, "ram_util_percent": 30.31159420289855}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 30619.854969073087, "episode_reward_min": -96190.39456838855, "episode_reward_mean": -16742.354054908898, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -3195.3446971562225}, "policy_reward_max": {"shared_policy": 795.6551299095154}, "policy_reward_mean": {"shared_policy": -123.89812813519498}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.966251707942085, "mean_processing_ms": 2.6964045171397784, "mean_inference_ms": 0.6999330642219109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12723712, "num_steps_sampled": 291200, "sample_time_ms": 99568.257, "load_time_ms": 52.448, "grad_time_ms": 5097.948, "update_time_ms": 3.422, "learner": {"shared_policy": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 3236.293212890625, "policy_loss": -0.0007074808818288147, "vf_loss": 3236.302001953125, "vf_explained_var": -3.7170908573358474e-09, "kl": 0.003023724537342787, "entropy": 0.4992523491382599, "entropy_coeff": 0.015479999594390392}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 291200, "episodes_total": 224, "training_iteration": 28, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-55-36", "timestamp": 1710201336, "time_this_iter_s": 95.66110444068909, "time_total_s": 3468.41356754303, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3468.41356754303, "timesteps_since_restore": 291200, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 24.557664233576638, "ram_util_percent": 30.3051094890511}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 36310.46469068155, "episode_reward_min": -70266.25237699994, "episode_reward_mean": -8489.801070881833, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2085.3849431313574}, "policy_reward_max": {"shared_policy": 795.6551299095154}, "policy_reward_mean": {"shared_policy": -62.010087436139294}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.60645580657458, "mean_processing_ms": 2.6835877787859967, "mean_inference_ms": 0.6992725539019564}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13081216, "num_steps_sampled": 301600, "sample_time_ms": 98049.723, "load_time_ms": 52.135, "grad_time_ms": 5005.52, "update_time_ms": 3.512, "learner": {"shared_policy": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 3128.690185546875, "policy_loss": -0.0011169107165187597, "vf_loss": 3128.6982421875, "vf_explained_var": -3.990715757851149e-09, "kl": 0.003923292737454176, "entropy": 0.4494556486606598, "entropy_coeff": 0.01522000040858984}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 301600, "episodes_total": 232, "training_iteration": 29, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-57-16", "timestamp": 1710201436, "time_this_iter_s": 100.38796424865723, "time_total_s": 3568.801531791687, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3568.801531791687, "timesteps_since_restore": 301600, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.69090909090909, "ram_util_percent": 30.301398601398603}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 36310.46469068155, "episode_reward_min": -57306.97782669641, "episode_reward_mean": -1779.0047128231777, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2085.3849431313574}, "policy_reward_max": {"shared_policy": 808.1152333021164}, "policy_reward_mean": {"shared_policy": -12.897880902074803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 42.260153326442506, "mean_processing_ms": 2.6712861508561696, "mean_inference_ms": 0.6985933616242577}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13436160, "num_steps_sampled": 312000, "sample_time_ms": 96821.603, "load_time_ms": 51.409, "grad_time_ms": 4949.561, "update_time_ms": 3.615, "learner": {"shared_policy": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 3211.39599609375, "policy_loss": -0.0007072234293445945, "vf_loss": 3211.40283203125, "vf_explained_var": -4.384907104082458e-09, "kl": 0.003431193297728896, "entropy": 0.42115217447280884, "entropy_coeff": 0.014960000291466713}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 312000, "episodes_total": 240, "training_iteration": 30, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_19-58-55", "timestamp": 1710201535, "time_this_iter_s": 98.80111956596375, "time_total_s": 3667.6026513576508, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3667.6026513576508, "timesteps_since_restore": 312000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 24.71985815602837, "ram_util_percent": 30.30851063829788}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 39274.047057547956, "episode_reward_min": -51595.932370110866, "episode_reward_mean": 5147.5426123314255, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -2029.8110228190199}, "policy_reward_max": {"shared_policy": 817.4389805793762}, "policy_reward_mean": {"shared_policy": 36.97416041036794}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.91662822596242, "mean_processing_ms": 2.6591407194838075, "mean_inference_ms": 0.697833591577398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13776256, "num_steps_sampled": 322400, "sample_time_ms": 95319.234, "load_time_ms": 49.971, "grad_time_ms": 4872.913, "update_time_ms": 3.578, "learner": {"shared_policy": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 3501.552978515625, "policy_loss": -0.0005277120508253574, "vf_loss": 3501.559326171875, "vf_explained_var": -4.778242246317177e-09, "kl": 0.0022639650851488113, "entropy": 0.3994429111480713, "entropy_coeff": 0.014700000174343586}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 322400, "episodes_total": 248, "training_iteration": 31, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-00-31", "timestamp": 1710201631, "time_this_iter_s": 95.86980199813843, "time_total_s": 3763.472453355789, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3763.472453355789, "timesteps_since_restore": 322400, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.016788321167883, "ram_util_percent": 30.31021897810219}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 43436.61352427304, "episode_reward_min": -42246.92309947166, "episode_reward_mean": 11253.438776420477, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1728.570303030312}, "policy_reward_max": {"shared_policy": 834.8374397754669}, "policy_reward_mean": {"shared_policy": 80.15840712600952}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.57698391242787, "mean_processing_ms": 2.6470969375194193, "mean_inference_ms": 0.6970263155688861}, "off_policy_estimator": {}, "info": {"num_steps_trained": 14101760, "num_steps_sampled": 332800, "sample_time_ms": 94368.793, "load_time_ms": 49.427, "grad_time_ms": 4821.065, "update_time_ms": 3.583, "learner": {"shared_policy": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 3834.459228515625, "policy_loss": -0.00043873998220078647, "vf_loss": 3834.465087890625, "vf_explained_var": -4.711181222916139e-09, "kl": 0.003495948389172554, "entropy": 0.39807814359664917, "entropy_coeff": 0.014440000057220459}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 332800, "episodes_total": 256, "training_iteration": 32, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-02-02", "timestamp": 1710201722, "time_this_iter_s": 90.92394232749939, "time_total_s": 3854.3963956832886, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3854.3963956832886, "timesteps_since_restore": 332800, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.878461538461536, "ram_util_percent": 30.310000000000006}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 43436.61352427304, "episode_reward_min": -34282.02977086259, "episode_reward_mean": 16503.552922341525, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 834.8374397754669}, "policy_reward_mean": {"shared_policy": 116.80623485272507}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 41.24367284824596, "mean_processing_ms": 2.6351824366166277, "mean_inference_ms": 0.6961909660592912}, "off_policy_estimator": {}, "info": {"num_steps_trained": 14437376, "num_steps_sampled": 343200, "sample_time_ms": 93653.468, "load_time_ms": 49.193, "grad_time_ms": 4790.126, "update_time_ms": 3.493, "learner": {"shared_policy": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 3685.246337890625, "policy_loss": -0.000497686502058059, "vf_loss": 3685.251708984375, "vf_explained_var": -3.887259403256849e-09, "kl": 0.0030595134012401104, "entropy": 0.36362648010253906, "entropy_coeff": 0.014179999940097332}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 343200, "episodes_total": 264, "training_iteration": 33, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-03-35", "timestamp": 1710201815, "time_this_iter_s": 93.10417366027832, "time_total_s": 3947.500569343567, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3947.500569343567, "timesteps_since_restore": 343200, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.53082706766917, "ram_util_percent": 30.354135338345866}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 43436.61352427304, "episode_reward_min": -10799.031053266954, "episode_reward_mean": 20643.938454533705, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 834.8374397754669}, "policy_reward_mean": {"shared_policy": 145.80082247710789}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.922034467185206, "mean_processing_ms": 2.623663840627538, "mean_inference_ms": 0.6953651969328797}, "off_policy_estimator": {}, "info": {"num_steps_trained": 14776704, "num_steps_sampled": 353600, "sample_time_ms": 92912.433, "load_time_ms": 49.182, "grad_time_ms": 4758.302, "update_time_ms": 3.416, "learner": {"shared_policy": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 3509.26904296875, "policy_loss": -0.0005991489160805941, "vf_loss": 3509.274169921875, "vf_explained_var": -5.9806999352929324e-09, "kl": 0.002946754451841116, "entropy": 0.3394472002983093, "entropy_coeff": 0.013919999822974205}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 353600, "episodes_total": 272, "training_iteration": 34, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-05-09", "timestamp": 1710201909, "time_this_iter_s": 93.41063928604126, "time_total_s": 4040.911208629608, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4040.911208629608, "timesteps_since_restore": 353600, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.47142857142857, "ram_util_percent": 30.405263157894737}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 43436.61352427304, "episode_reward_min": -10799.031053266954, "episode_reward_mean": 23546.721487234507, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 862.3843567371368}, "policy_reward_mean": {"shared_policy": 166.29040598329456}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.622108508300556, "mean_processing_ms": 2.6129386252719224, "mean_inference_ms": 0.6945905951244954}, "off_policy_estimator": {}, "info": {"num_steps_trained": 15144448, "num_steps_sampled": 364000, "sample_time_ms": 92254.502, "load_time_ms": 48.875, "grad_time_ms": 4726.59, "update_time_ms": 3.429, "learner": {"shared_policy": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 2968.932861328125, "policy_loss": -0.0007037774776108563, "vf_loss": 2968.93798828125, "vf_explained_var": -2.0539017153708983e-09, "kl": 0.004809267818927765, "entropy": 0.3098691701889038, "entropy_coeff": 0.013659999705851078}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 364000, "episodes_total": 280, "training_iteration": 35, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-06-50", "timestamp": 1710202010, "time_this_iter_s": 101.61718440055847, "time_total_s": 4142.528393030167, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4142.528393030167, "timesteps_since_restore": 364000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.555862068965517, "ram_util_percent": 30.396551724137932}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 43436.61352427304, "episode_reward_min": -10799.031053266954, "episode_reward_mean": 25885.83774028098, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 866.1633863449097}, "policy_reward_mean": {"shared_policy": 182.79667919130696}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.34305061175442, "mean_processing_ms": 2.603013328691918, "mean_inference_ms": 0.6938819039579025}, "off_policy_estimator": {}, "info": {"num_steps_trained": 15516288, "num_steps_sampled": 374400, "sample_time_ms": 92112.393, "load_time_ms": 48.517, "grad_time_ms": 4746.981, "update_time_ms": 3.463, "learner": {"shared_policy": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 2953.229248046875, "policy_loss": -0.0003611583379097283, "vf_loss": 2953.233642578125, "vf_explained_var": -3.857374419879989e-09, "kl": 0.003181412583217025, "entropy": 0.30255451798439026, "entropy_coeff": 0.013399999588727951}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 374400, "episodes_total": 288, "training_iteration": 36, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-08-33", "timestamp": 1710202113, "time_this_iter_s": 102.6447446346283, "time_total_s": 4245.173137664795, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4245.173137664795, "timesteps_since_restore": 374400, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 24.792517006802722, "ram_util_percent": 30.418367346938776}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 46311.29185585026, "episode_reward_min": -10799.031053266954, "episode_reward_mean": 29344.176782111554, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 866.1633863449097}, "policy_reward_mean": {"shared_policy": 206.94059789923523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 40.07076446903121, "mean_processing_ms": 2.593375184609644, "mean_inference_ms": 0.6931662619551286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 15850240, "num_steps_sampled": 384800, "sample_time_ms": 91557.963, "load_time_ms": 47.998, "grad_time_ms": 4734.678, "update_time_ms": 3.545, "learner": {"shared_policy": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 3551.12646484375, "policy_loss": -0.0004935662145726383, "vf_loss": 3551.131103515625, "vf_explained_var": -1.7134336172119902e-09, "kl": 0.0030435994267463684, "entropy": 0.29990822076797485, "entropy_coeff": 0.013140000402927399}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 384800, "episodes_total": 296, "training_iteration": 37, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-10-04", "timestamp": 1710202204, "time_this_iter_s": 91.39264941215515, "time_total_s": 4336.56578707695, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4336.56578707695, "timesteps_since_restore": 384800, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.633846153846154, "ram_util_percent": 30.357692307692307}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 46311.29185585026, "episode_reward_min": 617.8876338558039, "episode_reward_mean": 31889.595360686908, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 866.1633863449097}, "policy_reward_mean": {"shared_policy": 224.6220705831296}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.80891661445091, "mean_processing_ms": 2.5840117858517675, "mean_inference_ms": 0.6924554698412797}, "off_policy_estimator": {}, "info": {"num_steps_trained": 16204032, "num_steps_sampled": 395200, "sample_time_ms": 91727.613, "load_time_ms": 48.029, "grad_time_ms": 4746.456, "update_time_ms": 3.316, "learner": {"shared_policy": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 3168.01708984375, "policy_loss": -0.0006539146997965872, "vf_loss": 3168.02099609375, "vf_explained_var": -2.4152388977682904e-09, "kl": 0.003263097023591399, "entropy": 0.25761473178863525, "entropy_coeff": 0.012880000285804272}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 395200, "episodes_total": 304, "training_iteration": 38, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-11-42", "timestamp": 1710202302, "time_this_iter_s": 97.4753942489624, "time_total_s": 4434.0411813259125, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4434.0411813259125, "timesteps_since_restore": 395200, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 24.632374100719424, "ram_util_percent": 30.298561151079138}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 48387.944743614, "episode_reward_min": 16730.638840692933, "episode_reward_mean": 34388.71187383064, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 880.0321464538574}, "policy_reward_mean": {"shared_policy": 242.20814110318807}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.55605404505578, "mean_processing_ms": 2.5749256944016894, "mean_inference_ms": 0.6917762239673183}, "off_policy_estimator": {}, "info": {"num_steps_trained": 16534272, "num_steps_sampled": 405600, "sample_time_ms": 90879.063, "load_time_ms": 47.42, "grad_time_ms": 4689.621, "update_time_ms": 3.277, "learner": {"shared_policy": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 3751.322021484375, "policy_loss": -0.0003859697317238897, "vf_loss": 3751.32568359375, "vf_explained_var": -4.366386807674871e-09, "kl": 0.0031053172424435616, "entropy": 0.2573423385620117, "entropy_coeff": 0.012620000168681145}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 405600, "episodes_total": 312, "training_iteration": 39, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-13-13", "timestamp": 1710202393, "time_this_iter_s": 91.32234573364258, "time_total_s": 4525.363527059555, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4525.363527059555, "timesteps_since_restore": 405600, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.73769230769231, "ram_util_percent": 30.313846153846157}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 57327.59161502868, "episode_reward_min": 19865.034547631396, "episode_reward_mean": 36664.18781819948, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1420.304377734661}, "policy_reward_max": {"shared_policy": 882.7813342809677}, "policy_reward_mean": {"shared_policy": 258.2348768713867}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.31265755428742, "mean_processing_ms": 2.5661947933177025, "mean_inference_ms": 0.6911366766083751}, "off_policy_estimator": {}, "info": {"num_steps_trained": 16853120, "num_steps_sampled": 416000, "sample_time_ms": 90032.439, "load_time_ms": 46.705, "grad_time_ms": 4641.547, "update_time_ms": 3.245, "learner": {"shared_policy": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 4105.1376953125, "policy_loss": -0.00031318896799348295, "vf_loss": 4105.140625, "vf_explained_var": -3.4934877213288473e-09, "kl": 0.0036708414554595947, "entropy": 0.23832635581493378, "entropy_coeff": 0.012360000051558018}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 416000, "episodes_total": 320, "training_iteration": 40, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-14-43", "timestamp": 1710202483, "time_this_iter_s": 89.84263181686401, "time_total_s": 4615.206158876419, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4615.206158876419, "timesteps_since_restore": 416000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.6031007751938, "ram_util_percent": 30.316279069767447}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 57327.59161502868, "episode_reward_min": 21289.511674826965, "episode_reward_mean": 38393.19556844145, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1233.6670413687825}, "policy_reward_max": {"shared_policy": 882.7813342809677}, "policy_reward_mean": {"shared_policy": 270.3936584861008}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 39.0791971435323, "mean_processing_ms": 2.5578165833276625, "mean_inference_ms": 0.6905141587605235}, "off_policy_estimator": {}, "info": {"num_steps_trained": 17181312, "num_steps_sampled": 426400, "sample_time_ms": 89574.956, "load_time_ms": 46.368, "grad_time_ms": 4630.004, "update_time_ms": 3.223, "learner": {"shared_policy": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 3822.8466796875, "policy_loss": -0.00027554354164749384, "vf_loss": 3822.849365234375, "vf_explained_var": -3.8357121923127124e-09, "kl": 0.00347740831784904, "entropy": 0.2090211808681488, "entropy_coeff": 0.01209999993443489}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 426400, "episodes_total": 328, "training_iteration": 41, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-16-14", "timestamp": 1710202574, "time_this_iter_s": 91.17429280281067, "time_total_s": 4706.38045167923, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4706.38045167923, "timesteps_since_restore": 426400, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.466923076923077, "ram_util_percent": 30.31153846153847}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 60055.155843266286, "episode_reward_min": 23265.30488076806, "episode_reward_mean": 40476.292944696055, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1233.6670413687825}, "policy_reward_max": {"shared_policy": 882.7813342809677}, "policy_reward_mean": {"shared_policy": 285.06439146908974}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.84990731572775, "mean_processing_ms": 2.54961322393666, "mean_inference_ms": 0.6898994413604576}, "off_policy_estimator": {}, "info": {"num_steps_trained": 17490688, "num_steps_sampled": 436800, "sample_time_ms": 89238.547, "load_time_ms": 45.984, "grad_time_ms": 4607.091, "update_time_ms": 3.255, "learner": {"shared_policy": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 4410.8896484375, "policy_loss": -0.00039229527465067804, "vf_loss": 4410.892578125, "vf_explained_var": -5.943201930591613e-09, "kl": 0.0034176672343164682, "entropy": 0.19682665169239044, "entropy_coeff": 0.011839999817311764}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 436800, "episodes_total": 336, "training_iteration": 42, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-17-42", "timestamp": 1710202662, "time_this_iter_s": 87.32448768615723, "time_total_s": 4793.704939365387, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4793.704939365387, "timesteps_since_restore": 436800, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 24.39677419354838, "ram_util_percent": 30.304032258064527}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 60776.83051130921, "episode_reward_min": 23265.30488076806, "episode_reward_mean": 42129.42148134621, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1233.6670413687825}, "policy_reward_max": {"shared_policy": 882.7813342809677}, "policy_reward_mean": {"shared_policy": 296.7069616264963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.62972239821962, "mean_processing_ms": 2.5416862640843227, "mean_inference_ms": 0.6893350105294731}, "off_policy_estimator": {}, "info": {"num_steps_trained": 17809920, "num_steps_sampled": 447200, "sample_time_ms": 88896.594, "load_time_ms": 45.348, "grad_time_ms": 4578.575, "update_time_ms": 3.375, "learner": {"shared_policy": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 4038.842041015625, "policy_loss": -0.00034917888115160167, "vf_loss": 4038.843994140625, "vf_explained_var": -3.178595830988229e-09, "kl": 0.002948819426819682, "entropy": 0.17268766462802887, "entropy_coeff": 0.011579999700188637}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 447200, "episodes_total": 344, "training_iteration": 43, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-19-11", "timestamp": 1710202751, "time_this_iter_s": 89.39044642448425, "time_total_s": 4883.095385789871, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4883.095385789871, "timesteps_since_restore": 447200, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 24.33984375, "ram_util_percent": 30.436718749999997}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 60776.83051130921, "episode_reward_min": 23265.30488076806, "episode_reward_mean": 43225.18334634113, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1233.6670413687825}, "policy_reward_max": {"shared_policy": 882.7813342809677}, "policy_reward_mean": {"shared_policy": 304.4241379416941}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.42102654868257, "mean_processing_ms": 2.534124326189856, "mean_inference_ms": 0.688828144677737}, "off_policy_estimator": {}, "info": {"num_steps_trained": 18141440, "num_steps_sampled": 457600, "sample_time_ms": 88755.14, "load_time_ms": 44.991, "grad_time_ms": 4569.546, "update_time_ms": 3.524, "learner": {"shared_policy": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 3724.26806640625, "policy_loss": -2.900348226830829e-05, "vf_loss": 3724.26953125, "vf_explained_var": -2.784618535756067e-09, "kl": 0.0032027580309659243, "entropy": 0.16948790848255157, "entropy_coeff": 0.01131999958306551}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 457600, "episodes_total": 352, "training_iteration": 44, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-20-43", "timestamp": 1710202843, "time_this_iter_s": 91.90461897850037, "time_total_s": 4975.000004768372, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4975.000004768372, "timesteps_since_restore": 457600, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.698473282442748, "ram_util_percent": 30.320610687022903}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 60776.83051130921, "episode_reward_min": 23265.30488076806, "episode_reward_mean": 44556.3693003559, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1233.6670413687825}, "policy_reward_max": {"shared_policy": 882.7813342809677}, "policy_reward_mean": {"shared_policy": 313.79934713962894}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.221917253311005, "mean_processing_ms": 2.526942596396058, "mean_inference_ms": 0.6883616275861132}, "off_policy_estimator": {}, "info": {"num_steps_trained": 18462720, "num_steps_sampled": 468000, "sample_time_ms": 87681.814, "load_time_ms": 44.134, "grad_time_ms": 4514.4, "update_time_ms": 3.522, "learner": {"shared_policy": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 3895.832763671875, "policy_loss": -0.0002792080049403012, "vf_loss": 3895.834228515625, "vf_explained_var": -3.3958025280611537e-09, "kl": 0.0027866812888532877, "entropy": 0.14149437844753265, "entropy_coeff": 0.011060000397264957}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 468000, "episodes_total": 360, "training_iteration": 45, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-22-13", "timestamp": 1710202933, "time_this_iter_s": 90.31763291358948, "time_total_s": 5065.317637681961, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5065.317637681961, "timesteps_since_restore": 468000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.528682170542638, "ram_util_percent": 30.3093023255814}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 60776.83051130921, "episode_reward_min": 23265.30488076806, "episode_reward_mean": 45589.3977389584, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1233.6670413687825}, "policy_reward_max": {"shared_policy": 887.2473151683807}, "policy_reward_mean": {"shared_policy": 321.07470764813297}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 38.034259679005295, "mean_processing_ms": 2.520252712786675, "mean_inference_ms": 0.6879435579460068}, "off_policy_estimator": {}, "info": {"num_steps_trained": 18805120, "num_steps_sampled": 478400, "sample_time_ms": 87228.7, "load_time_ms": 43.57, "grad_time_ms": 4470.074, "update_time_ms": 3.579, "learner": {"shared_policy": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 3442.384765625, "policy_loss": -0.0005092018400318921, "vf_loss": 3442.386474609375, "vf_explained_var": -4.367293637841385e-09, "kl": 0.0041064010001719, "entropy": 0.12386593222618103, "entropy_coeff": 0.01080000028014183}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 478400, "episodes_total": 368, "training_iteration": 46, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-23-51", "timestamp": 1710203031, "time_this_iter_s": 97.66161942481995, "time_total_s": 5162.979257106781, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5162.979257106781, "timesteps_since_restore": 478400, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.687857142857144, "ram_util_percent": 30.377857142857142}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 60776.83051130921, "episode_reward_min": 23265.30488076806, "episode_reward_mean": 47179.62454603101, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1233.6670413687825}, "policy_reward_max": {"shared_policy": 887.2473151683807}, "policy_reward_mean": {"shared_policy": 332.2742766816748}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 37.85151215302459, "mean_processing_ms": 2.5137616997652943, "mean_inference_ms": 0.6875416023196821}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19133824, "num_steps_sampled": 488800, "sample_time_ms": 87283.438, "load_time_ms": 43.583, "grad_time_ms": 4466.807, "update_time_ms": 3.521, "learner": {"shared_policy": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 3772.239013671875, "policy_loss": -7.78868852648884e-05, "vf_loss": 3772.24072265625, "vf_explained_var": -3.992211450309924e-09, "kl": 0.002620148239657283, "entropy": 0.11692876368761063, "entropy_coeff": 0.010540000163018703}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 488800, "episodes_total": 376, "training_iteration": 47, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-25-23", "timestamp": 1710203123, "time_this_iter_s": 91.9108316898346, "time_total_s": 5254.890088796616, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5254.890088796616, "timesteps_since_restore": 488800, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.697709923664124, "ram_util_percent": 30.43587786259542}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 64333.25128315622, "episode_reward_min": 23265.30488076806, "episode_reward_mean": 49230.24489634644, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1118.5910058170557}, "policy_reward_max": {"shared_policy": 887.2473151683807}, "policy_reward_mean": {"shared_policy": 346.7162821068135}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 37.66613309106831, "mean_processing_ms": 2.5071340820223122, "mean_inference_ms": 0.6871224159404243}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19435520, "num_steps_sampled": 499200, "sample_time_ms": 86102.886, "load_time_ms": 42.567, "grad_time_ms": 4414.964, "update_time_ms": 3.568, "learner": {"shared_policy": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 4699.43212890625, "policy_loss": -0.0005485501606017351, "vf_loss": 4699.43408203125, "vf_explained_var": -5.00709340656158e-09, "kl": 0.00410111341625452, "entropy": 0.10798954963684082, "entropy_coeff": 0.010280000045895576}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 499200, "episodes_total": 384, "training_iteration": 48, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-26-48", "timestamp": 1710203208, "time_this_iter_s": 85.13621091842651, "time_total_s": 5340.026299715042, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5340.026299715042, "timesteps_since_restore": 499200, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.36611570247934, "ram_util_percent": 30.414876033057848}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 65537.91547790612, "episode_reward_min": 27176.586294214358, "episode_reward_mean": 50967.97106964295, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -957.547644302249}, "policy_reward_max": {"shared_policy": 887.2473151683807}, "policy_reward_mean": {"shared_policy": 358.9546522265155}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 37.481024801317034, "mean_processing_ms": 2.500542458850841, "mean_inference_ms": 0.6867476357083595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19726592, "num_steps_sampled": 509600, "sample_time_ms": 85502.346, "load_time_ms": 41.557, "grad_time_ms": 4301.771, "update_time_ms": 3.612, "learner": {"shared_policy": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 5080.3447265625, "policy_loss": -0.00018374292994849384, "vf_loss": 5080.345703125, "vf_explained_var": -4.6656229990560405e-09, "kl": 0.0030173209961503744, "entropy": 0.12446331232786179, "entropy_coeff": 0.01001999992877245}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 509600, "episodes_total": 392, "training_iteration": 49, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-28-12", "timestamp": 1710203292, "time_this_iter_s": 84.17421460151672, "time_total_s": 5424.200514316559, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5424.200514316559, "timesteps_since_restore": 509600, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.8825, "ram_util_percent": 30.409166666666653}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 66680.47136771772, "episode_reward_min": 32286.092216018587, "episode_reward_mean": 52491.41443428341, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -957.547644302249}, "policy_reward_max": {"shared_policy": 887.319197177887}, "policy_reward_mean": {"shared_policy": 369.6578481287564}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 37.2977449540822, "mean_processing_ms": 2.4940710124030936, "mean_inference_ms": 0.6863751222499769}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20023680, "num_steps_sampled": 520000, "sample_time_ms": 85026.64, "load_time_ms": 41.077, "grad_time_ms": 4266.091, "update_time_ms": 3.471, "learner": {"shared_policy": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 4876.85498046875, "policy_loss": -1.3765719813818578e-05, "vf_loss": 4876.85595703125, "vf_explained_var": -4.314338664102024e-09, "kl": 0.0025344546884298325, "entropy": 0.09917350113391876, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 520000, "episodes_total": 400, "training_iteration": 50, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-29-37", "timestamp": 1710203377, "time_this_iter_s": 84.71948385238647, "time_total_s": 5508.919998168945, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5508.919998168945, "timesteps_since_restore": 520000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.22479338842975, "ram_util_percent": 30.50495867768595}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 66680.47136771772, "episode_reward_min": 38737.97697659768, "episode_reward_mean": 53749.912514294796, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -957.547644302249}, "policy_reward_max": {"shared_policy": 898.3938714265823}, "policy_reward_mean": {"shared_policy": 378.52051066404783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 37.118073993367716, "mean_processing_ms": 2.487745130161394, "mean_inference_ms": 0.6860149792152648}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20329600, "num_steps_sampled": 530400, "sample_time_ms": 84788.194, "load_time_ms": 40.603, "grad_time_ms": 4231.439, "update_time_ms": 3.658, "learner": {"shared_policy": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 4486.39599609375, "policy_loss": -0.00044346757931634784, "vf_loss": 4486.39697265625, "vf_explained_var": -5.860707918969865e-09, "kl": 0.0028546385001391172, "entropy": 0.053808607161045074, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 530400, "episodes_total": 408, "training_iteration": 51, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-31-06", "timestamp": 1710203466, "time_this_iter_s": 88.43742394447327, "time_total_s": 5597.357422113419, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5597.357422113419, "timesteps_since_restore": 530400, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.551968503937008, "ram_util_percent": 30.429921259842512}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 66680.47136771772, "episode_reward_min": 38737.97697659768, "episode_reward_mean": 54288.53882446517, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -957.547644302249}, "policy_reward_max": {"shared_policy": 903.9031367301941}, "policy_reward_mean": {"shared_policy": 382.31365369341665}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.94679817575881, "mean_processing_ms": 2.4818031133408316, "mean_inference_ms": 0.6856827614411074}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20664064, "num_steps_sampled": 540800, "sample_time_ms": 85293.605, "load_time_ms": 41.014, "grad_time_ms": 4250.183, "update_time_ms": 3.621, "learner": {"shared_policy": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 3666.195556640625, "policy_loss": -0.000622011546511203, "vf_loss": 3666.19677734375, "vf_explained_var": -4.904324057974918e-09, "kl": 0.003789040492847562, "entropy": 0.022879842668771744, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 540800, "episodes_total": 416, "training_iteration": 52, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-32-38", "timestamp": 1710203558, "time_this_iter_s": 92.57330393791199, "time_total_s": 5689.930726051331, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5689.930726051331, "timesteps_since_restore": 540800, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.55530303030303, "ram_util_percent": 30.576515151515142}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 66680.47136771772, "episode_reward_min": 41986.046386897564, "episode_reward_mean": 54749.70551601935, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -957.547644302249}, "policy_reward_max": {"shared_policy": 914.5635788440704}, "policy_reward_mean": {"shared_policy": 385.56130645084045}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.78321706434674, "mean_processing_ms": 2.4761463745008285, "mean_inference_ms": 0.6853684652300797}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20996864, "num_steps_sampled": 551200, "sample_time_ms": 85472.654, "load_time_ms": 41.581, "grad_time_ms": 4267.538, "update_time_ms": 3.499, "learner": {"shared_policy": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 3804.35546875, "policy_loss": -0.0004958314239047468, "vf_loss": 3804.35546875, "vf_explained_var": -3.5762786065873797e-09, "kl": 0.003834865754470229, "entropy": 0.002047884976491332, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 551200, "episodes_total": 424, "training_iteration": 53, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-34-10", "timestamp": 1710203650, "time_this_iter_s": 91.36134433746338, "time_total_s": 5781.292070388794, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5781.292070388794, "timesteps_since_restore": 551200, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.3, "ram_util_percent": 30.409230769230767}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 66680.47136771772, "episode_reward_min": 41986.046386897564, "episode_reward_mean": 55080.781402057524, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -957.547644302249}, "policy_reward_max": {"shared_policy": 914.5635788440704}, "policy_reward_mean": {"shared_policy": 387.892826775053}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.62663182973971, "mean_processing_ms": 2.470725180755039, "mean_inference_ms": 0.6850701489072276}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21314560, "num_steps_sampled": 561600, "sample_time_ms": 85223.615, "load_time_ms": 41.747, "grad_time_ms": 4246.074, "update_time_ms": 3.443, "learner": {"shared_policy": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 4169.3583984375, "policy_loss": -0.000193574363947846, "vf_loss": 4169.35888671875, "vf_explained_var": -4.658864405371332e-09, "kl": 0.0023516551591455936, "entropy": -0.0024458812549710274, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 561600, "episodes_total": 432, "training_iteration": 54, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-35-39", "timestamp": 1710203739, "time_this_iter_s": 89.19746899604797, "time_total_s": 5870.489539384842, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5870.489539384842, "timesteps_since_restore": 561600, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 24.43359375, "ram_util_percent": 30.411718749999995}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 69820.9422668526, "episode_reward_min": 41986.046386897564, "episode_reward_mean": 55580.87080595134, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -892.8300759382546}, "policy_reward_max": {"shared_policy": 914.5635788440704}, "policy_reward_mean": {"shared_policy": 391.4145831405024}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.477125227691666, "mean_processing_ms": 2.465572426450895, "mean_inference_ms": 0.6847767290519662}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21636608, "num_steps_sampled": 572000, "sample_time_ms": 85330.712, "load_time_ms": 41.666, "grad_time_ms": 4235.482, "update_time_ms": 3.434, "learner": {"shared_policy": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 4058.753662109375, "policy_loss": -5.7141332945320755e-05, "vf_loss": 4058.753173828125, "vf_explained_var": -5.448755224790602e-09, "kl": 0.0027567362412810326, "entropy": -0.02225349470973015, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 572000, "episodes_total": 440, "training_iteration": 55, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-37-10", "timestamp": 1710203830, "time_this_iter_s": 91.28198146820068, "time_total_s": 5961.771520853043, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5961.771520853043, "timesteps_since_restore": 572000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.203846153846154, "ram_util_percent": 30.412307692307696}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 69820.9422668526, "episode_reward_min": 41986.046386897564, "episode_reward_mean": 56066.688861322946, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -892.8300759382546}, "policy_reward_max": {"shared_policy": 919.0092823505402}, "policy_reward_mean": {"shared_policy": 394.83583705157}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.33315872163105, "mean_processing_ms": 2.4606197368036913, "mean_inference_ms": 0.6844848568263925}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21959296, "num_steps_sampled": 582400, "sample_time_ms": 84698.548, "load_time_ms": 41.371, "grad_time_ms": 4208.649, "update_time_ms": 3.463, "learner": {"shared_policy": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 4040.573974609375, "policy_loss": 7.77992609073408e-05, "vf_loss": 4040.573486328125, "vf_explained_var": -5.036013384085436e-09, "kl": 0.002704364713281393, "entropy": -0.043865103274583817, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 582400, "episodes_total": 448, "training_iteration": 56, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-38-42", "timestamp": 1710203922, "time_this_iter_s": 91.0673508644104, "time_total_s": 6052.838871717453, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6052.838871717453, "timesteps_since_restore": 582400, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.43076923076923, "ram_util_percent": 30.409999999999997}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 69820.9422668526, "episode_reward_min": 41986.046386897564, "episode_reward_mean": 56766.39838845779, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -892.8300759382546}, "policy_reward_max": {"shared_policy": 919.0092823505402}, "policy_reward_mean": {"shared_policy": 399.7633689328014}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.19381431435471, "mean_processing_ms": 2.455860442681599, "mean_inference_ms": 0.6841991543069237}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22281472, "num_steps_sampled": 592800, "sample_time_ms": 84667.706, "load_time_ms": 41.501, "grad_time_ms": 4197.774, "update_time_ms": 3.438, "learner": {"shared_policy": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 3984.403564453125, "policy_loss": -0.0003171554999426007, "vf_loss": 3984.403564453125, "vf_explained_var": -5.612356357431736e-09, "kl": 0.003951026126742363, "entropy": -0.06765414774417877, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 592800, "episodes_total": 456, "training_iteration": 57, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-40-13", "timestamp": 1710204013, "time_this_iter_s": 91.49593210220337, "time_total_s": 6144.334803819656, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6144.334803819656, "timesteps_since_restore": 592800, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 24.26106870229008, "ram_util_percent": 30.416030534351144}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 69820.9422668526, "episode_reward_min": 41986.046386897564, "episode_reward_mean": 57284.65759494808, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -892.8300759382546}, "policy_reward_max": {"shared_policy": 922.2377018928528}, "policy_reward_mean": {"shared_policy": 403.44149302731233}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.05791470108339, "mean_processing_ms": 2.4512275004530824, "mean_inference_ms": 0.6839181896476246}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22604160, "num_steps_sampled": 603200, "sample_time_ms": 85259.208, "load_time_ms": 41.931, "grad_time_ms": 4218.496, "update_time_ms": 3.41, "learner": {"shared_policy": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 4164.185546875, "policy_loss": -0.00019999814685434103, "vf_loss": 4164.18505859375, "vf_explained_var": -4.846867351915307e-09, "kl": 0.003192305099219084, "entropy": -0.08101522922515869, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 603200, "episodes_total": 464, "training_iteration": 58, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-41-44", "timestamp": 1710204104, "time_this_iter_s": 91.26565384864807, "time_total_s": 6235.600457668304, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6235.600457668304, "timesteps_since_restore": 603200, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.450769230769225, "ram_util_percent": 30.431538461538466}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 69820.9422668526, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 57678.108076901044, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -892.8300759382546}, "policy_reward_max": {"shared_policy": 922.2377018928528}, "policy_reward_mean": {"shared_policy": 406.2124662081911}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.92623355190974, "mean_processing_ms": 2.4467278076182417, "mean_inference_ms": 0.6836460269125055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22934656, "num_steps_sampled": 613600, "sample_time_ms": 86179.022, "load_time_ms": 42.968, "grad_time_ms": 4353.942, "update_time_ms": 3.326, "learner": {"shared_policy": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 3923.47998046875, "policy_loss": 2.4036507966229692e-05, "vf_loss": 3923.478759765625, "vf_explained_var": -5.8865934349228155e-09, "kl": 0.002671157941222191, "entropy": -0.0964685007929802, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 613600, "episodes_total": 472, "training_iteration": 59, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-43-19", "timestamp": 1710204199, "time_this_iter_s": 94.73787212371826, "time_total_s": 6330.338329792023, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6330.338329792023, "timesteps_since_restore": 613600, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.5, "ram_util_percent": 30.44296296296296}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 69820.9422668526, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 58050.024580239806, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -892.8300759382546}, "policy_reward_max": {"shared_policy": 926.7781863212585}, "policy_reward_mean": {"shared_policy": 408.83178097217984}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.80057559903203, "mean_processing_ms": 2.4424395301522805, "mean_inference_ms": 0.6833914673679681}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23260416, "num_steps_sampled": 624000, "sample_time_ms": 86791.994, "load_time_ms": 43.59, "grad_time_ms": 4394.153, "update_time_ms": 3.431, "learner": {"shared_policy": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 4070.578369140625, "policy_loss": -0.00021647376706823707, "vf_loss": 4070.5771484375, "vf_explained_var": -5.316406426203457e-09, "kl": 0.002681419253349304, "entropy": -0.1368119716644287, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 624000, "episodes_total": 480, "training_iteration": 60, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-44-51", "timestamp": 1710204291, "time_this_iter_s": 91.26305150985718, "time_total_s": 6421.60138130188, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6421.60138130188, "timesteps_since_restore": 624000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 24.620000000000005, "ram_util_percent": 30.446153846153845}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70726.09046157077, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 58327.276861006954, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -892.8300759382546}, "policy_reward_max": {"shared_policy": 928.7464156150818}, "policy_reward_mean": {"shared_policy": 410.7843993309878}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.682856645822305, "mean_processing_ms": 2.438428998562033, "mean_inference_ms": 0.6831332935703816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23583104, "num_steps_sampled": 634400, "sample_time_ms": 87189.024, "load_time_ms": 43.903, "grad_time_ms": 4415.528, "update_time_ms": 3.272, "learner": {"shared_policy": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 4101.08837890625, "policy_loss": -1.3236250197223853e-05, "vf_loss": 4101.0869140625, "vf_explained_var": -5.721667584168699e-09, "kl": 0.0027881793212145567, "entropy": -0.14541806280612946, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 634400, "episodes_total": 488, "training_iteration": 61, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-46-23", "timestamp": 1710204383, "time_this_iter_s": 92.62419891357422, "time_total_s": 6514.225580215454, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6514.225580215454, "timesteps_since_restore": 634400, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.268421052631577, "ram_util_percent": 30.44436090225564}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70741.60850154376, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 58753.848139387665, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -796.151819486171}, "policy_reward_max": {"shared_policy": 928.7464156150818}, "policy_reward_mean": {"shared_policy": 413.78863398399653}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.570516633186095, "mean_processing_ms": 2.4346310005218057, "mean_inference_ms": 0.6828806110874425}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23891328, "num_steps_sampled": 644800, "sample_time_ms": 86790.418, "load_time_ms": 43.241, "grad_time_ms": 4395.031, "update_time_ms": 3.255, "learner": {"shared_policy": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 4752.2548828125, "policy_loss": -0.0001834297290770337, "vf_loss": 4752.25439453125, "vf_explained_var": -5.742640141193078e-09, "kl": 0.002912239171564579, "entropy": -0.13394515216350555, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 644800, "episodes_total": 496, "training_iteration": 62, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-47-52", "timestamp": 1710204472, "time_this_iter_s": 88.37120270729065, "time_total_s": 6602.596782922745, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6602.596782922745, "timesteps_since_restore": 644800, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 24.320634920634923, "ram_util_percent": 30.449206349206342}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70741.60850154376, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 58683.40529191468, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 933.169395327568}, "policy_reward_mean": {"shared_policy": 413.2925226559242}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.46539750017067, "mean_processing_ms": 2.431075701776551, "mean_inference_ms": 0.6826525573015729}, "off_policy_estimator": {}, "info": {"num_steps_trained": 24220032, "num_steps_sampled": 655200, "sample_time_ms": 86943.179, "load_time_ms": 42.755, "grad_time_ms": 4390.61, "update_time_ms": 3.266, "learner": {"shared_policy": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 3862.866455078125, "policy_loss": -0.00016063047223724425, "vf_loss": 3862.864501953125, "vf_explained_var": -5.2455799703921e-09, "kl": 0.0025545242242515087, "entropy": -0.16835223138332367, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 655200, "episodes_total": 504, "training_iteration": 63, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-49-24", "timestamp": 1710204564, "time_this_iter_s": 92.8377697467804, "time_total_s": 6695.434552669525, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6695.434552669525, "timesteps_since_restore": 655200, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 24.40681818181818, "ram_util_percent": 30.60454545454545}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70741.60850154376, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 59043.083055106814, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 933.169395327568}, "policy_reward_mean": {"shared_policy": 415.8256430389944}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.3652532165953, "mean_processing_ms": 2.4276785691411287, "mean_inference_ms": 0.6824384331591234}, "off_policy_estimator": {}, "info": {"num_steps_trained": 24547840, "num_steps_sampled": 665600, "sample_time_ms": 87084.505, "load_time_ms": 42.685, "grad_time_ms": 4399.872, "update_time_ms": 3.162, "learner": {"shared_policy": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 3856.946533203125, "policy_loss": -0.00010339006257709116, "vf_loss": 3856.944580078125, "vf_explained_var": -2.3506712132359553e-09, "kl": 0.002907729474827647, "entropy": -0.18619996309280396, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 665600, "episodes_total": 512, "training_iteration": 64, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-50-55", "timestamp": 1710204655, "time_this_iter_s": 90.70320177078247, "time_total_s": 6786.137754440308, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6786.137754440308, "timesteps_since_restore": 665600, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 24.838461538461537, "ram_util_percent": 30.455384615384613}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 59736.52034219731, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 933.169395327568}, "policy_reward_mean": {"shared_policy": 420.7093481385824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.26711988405714, "mean_processing_ms": 2.4243660691839137, "mean_inference_ms": 0.6822359707055594}, "off_policy_estimator": {}, "info": {"num_steps_trained": 24870656, "num_steps_sampled": 676000, "sample_time_ms": 87057.176, "load_time_ms": 42.769, "grad_time_ms": 4397.988, "update_time_ms": 3.283, "learner": {"shared_policy": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 4180.486328125, "policy_loss": -0.00011109587649116293, "vf_loss": 4180.484375, "vf_explained_var": -6.712022049271127e-09, "kl": 0.002592925913631916, "entropy": -0.18568050861358643, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 676000, "episodes_total": 520, "training_iteration": 65, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-52-26", "timestamp": 1710204746, "time_this_iter_s": 90.99103713035583, "time_total_s": 6877.128791570663, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6877.128791570663, "timesteps_since_restore": 676000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 24.299230769230775, "ram_util_percent": 30.459230769230768}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 60026.3159990783, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 933.169395327568}, "policy_reward_mean": {"shared_policy": 422.7503063531115}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.17246976592949, "mean_processing_ms": 2.421188815316845, "mean_inference_ms": 0.6820542774600724}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25193728, "num_steps_sampled": 686400, "sample_time_ms": 87012.189, "load_time_ms": 43.48, "grad_time_ms": 4392.365, "update_time_ms": 3.151, "learner": {"shared_policy": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 4075.565673828125, "policy_loss": 6.96631395840086e-05, "vf_loss": 4075.564208984375, "vf_explained_var": -3.896500011535409e-09, "kl": 0.0032442465890198946, "entropy": -0.17124395072460175, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 686400, "episodes_total": 528, "training_iteration": 66, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-53-57", "timestamp": 1710204837, "time_this_iter_s": 90.56776452064514, "time_total_s": 6967.696556091309, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6967.696556091309, "timesteps_since_restore": 686400, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 24.472868217054263, "ram_util_percent": 30.460465116279067}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 60054.50707985184, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 933.169395327568}, "policy_reward_mean": {"shared_policy": 422.94884907283495}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 35.08303480696162, "mean_processing_ms": 2.418201693926785, "mean_inference_ms": 0.6818923118756435}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25533568, "num_steps_sampled": 696800, "sample_time_ms": 87309.071, "load_time_ms": 43.404, "grad_time_ms": 4410.008, "update_time_ms": 3.152, "learner": {"shared_policy": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 3549.641357421875, "policy_loss": -0.00014463535626418889, "vf_loss": 3549.639892578125, "vf_explained_var": -3.2552442963407202e-09, "kl": 0.0027159147430211306, "entropy": -0.19993972778320312, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 696800, "episodes_total": 536, "training_iteration": 67, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-55-32", "timestamp": 1710204932, "time_this_iter_s": 94.63738894462585, "time_total_s": 7062.333945035934, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7062.333945035934, "timesteps_since_restore": 696800, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 24.694814814814816, "ram_util_percent": 30.493333333333336}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 60017.94181530757, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 936.1744620800018}, "policy_reward_mean": {"shared_policy": 422.72110026276636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.998623069369735, "mean_processing_ms": 2.4153885729855893, "mean_inference_ms": 0.6817445762601482}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25871360, "num_steps_sampled": 707200, "sample_time_ms": 87543.042, "load_time_ms": 43.839, "grad_time_ms": 4432.286, "update_time_ms": 3.156, "learner": {"shared_policy": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 3591.046142578125, "policy_loss": -0.00021098836441524327, "vf_loss": 3591.04443359375, "vf_explained_var": -4.178423385070573e-09, "kl": 0.0029394568409770727, "entropy": -0.21498417854309082, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 707200, "episodes_total": 544, "training_iteration": 68, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-57-05", "timestamp": 1710205025, "time_this_iter_s": 93.83411049842834, "time_total_s": 7156.168055534363, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7156.168055534363, "timesteps_since_restore": 707200, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 24.62910447761194, "ram_util_percent": 30.51492537313433}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 45343.71048428863, "episode_reward_mean": 59990.9322817499, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 942.042576789856}, "policy_reward_mean": {"shared_policy": 422.5308654863354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.91935758300515, "mean_processing_ms": 2.412756251743768, "mean_inference_ms": 0.6816068202367066}, "off_policy_estimator": {}, "info": {"num_steps_trained": 26221312, "num_steps_sampled": 717600, "sample_time_ms": 88008.239, "load_time_ms": 44.085, "grad_time_ms": 4458.366, "update_time_ms": 3.203, "learner": {"shared_policy": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 3289.6826171875, "policy_loss": -5.178967694519088e-05, "vf_loss": 3289.6806640625, "vf_explained_var": -9.374542253581808e-10, "kl": 0.0022801042068749666, "entropy": -0.21717987954616547, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 717600, "episodes_total": 552, "training_iteration": 69, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_20-58-45", "timestamp": 1710205125, "time_this_iter_s": 99.65530705451965, "time_total_s": 7255.823362588882, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7255.823362588882, "timesteps_since_restore": 717600, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 24.28943661971831, "ram_util_percent": 30.56901408450703}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 59604.36330021721, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 942.042576789856}, "policy_reward_mean": {"shared_policy": 419.8081652360699}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.84776626333749, "mean_processing_ms": 2.410396325009178, "mean_inference_ms": 0.6814787278288253}, "off_policy_estimator": {}, "info": {"num_steps_trained": 26598272, "num_steps_sampled": 728000, "sample_time_ms": 89437.874, "load_time_ms": 44.497, "grad_time_ms": 4496.571, "update_time_ms": 3.201, "learner": {"shared_policy": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 2841.807373046875, "policy_loss": 0.00010839407332241535, "vf_loss": 2841.80517578125, "vf_explained_var": -4.007375320469464e-09, "kl": 0.0022330901119858027, "entropy": -0.2414025217294693, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 728000, "episodes_total": 560, "training_iteration": 70, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-00-31", "timestamp": 1710205231, "time_this_iter_s": 105.94841694831848, "time_total_s": 7361.771779537201, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7361.771779537201, "timesteps_since_restore": 728000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 24.403973509933774, "ram_util_percent": 30.52980132450331}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 59459.26467193724, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 946.10704433918}, "policy_reward_mean": {"shared_policy": 418.75670590842486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.781132718051744, "mean_processing_ms": 2.4082020194798917, "mean_inference_ms": 0.6813394633880915}, "off_policy_estimator": {}, "info": {"num_steps_trained": 26955776, "num_steps_sampled": 738400, "sample_time_ms": 90000.017, "load_time_ms": 45.06, "grad_time_ms": 4510.288, "update_time_ms": 3.195, "learner": {"shared_policy": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 3172.020751953125, "policy_loss": -9.42657352425158e-05, "vf_loss": 3172.0185546875, "vf_explained_var": -4.502893169444633e-09, "kl": 0.0030381898395717144, "entropy": -0.24217292666435242, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 738400, "episodes_total": 568, "training_iteration": 71, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-02-10", "timestamp": 1710205330, "time_this_iter_s": 98.39018154144287, "time_total_s": 7460.161961078644, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7460.161961078644, "timesteps_since_restore": 738400, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 24.565957446808508, "ram_util_percent": 30.59148936170213}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 59022.25285466331, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 946.10704433918}, "policy_reward_mean": {"shared_policy": 415.67894115545676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.7189600151456, "mean_processing_ms": 2.406172145449056, "mean_inference_ms": 0.6811804422822122}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27308288, "num_steps_sampled": 748800, "sample_time_ms": 90956.952, "load_time_ms": 46.203, "grad_time_ms": 4547.805, "update_time_ms": 3.203, "learner": {"shared_policy": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 3484.2802734375, "policy_loss": -0.00037476993747986853, "vf_loss": 3484.27880859375, "vf_explained_var": -5.5622346728512184e-09, "kl": 0.005070384591817856, "entropy": -0.22737500071525574, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 748800, "episodes_total": 576, "training_iteration": 72, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-03-48", "timestamp": 1710205428, "time_this_iter_s": 98.34001040458679, "time_total_s": 7558.501971483231, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7558.501971483231, "timesteps_since_restore": 748800, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 24.282142857142862, "ram_util_percent": 30.607142857142858}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 58761.02751062142, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 946.10704433918}, "policy_reward_mean": {"shared_policy": 413.83919649708724}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.66108140308486, "mean_processing_ms": 2.404286124701426, "mean_inference_ms": 0.6810192242161128}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27662464, "num_steps_sampled": 759200, "sample_time_ms": 91714.43, "load_time_ms": 47.011, "grad_time_ms": 4544.77, "update_time_ms": 3.101, "learner": {"shared_policy": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 3411.81640625, "policy_loss": -0.00013546933769248426, "vf_loss": 3411.81396484375, "vf_explained_var": -3.6404717018712063e-09, "kl": 0.0028270846232771873, "entropy": -0.24814000725746155, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 759200, "episodes_total": 584, "training_iteration": 73, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-05-28", "timestamp": 1710205528, "time_this_iter_s": 100.39084768295288, "time_total_s": 7658.8928191661835, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7658.8928191661835, "timesteps_since_restore": 759200, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.242361111111112, "ram_util_percent": 30.609722222222217}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 58505.81958115152, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 946.10704433918}, "policy_reward_mean": {"shared_policy": 412.041830982122}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.608259893284064, "mean_processing_ms": 2.402559374438953, "mean_inference_ms": 0.6808618796726753}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28002048, "num_steps_sampled": 769600, "sample_time_ms": 92154.787, "load_time_ms": 47.131, "grad_time_ms": 4572.618, "update_time_ms": 3.056, "learner": {"shared_policy": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 3605.371337890625, "policy_loss": -8.269588579423726e-05, "vf_loss": 3605.368896484375, "vf_explained_var": -4.470909864551231e-09, "kl": 0.004038332030177116, "entropy": -0.25675728917121887, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 769600, "episodes_total": 592, "training_iteration": 74, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-07-04", "timestamp": 1710205624, "time_this_iter_s": 95.38888359069824, "time_total_s": 7754.281702756882, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7754.281702756882, "timesteps_since_restore": 769600, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 24.656617647058823, "ram_util_percent": 30.591911764705884}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 58339.66941916754, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -907.6513446867466}, "policy_reward_max": {"shared_policy": 946.10704433918}, "policy_reward_mean": {"shared_policy": 410.87167701364564}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.55920410211394, "mean_processing_ms": 2.4009941145500715, "mean_inference_ms": 0.6807005150507781}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28345088, "num_steps_sampled": 780000, "sample_time_ms": 92460.509, "load_time_ms": 47.459, "grad_time_ms": 4607.723, "update_time_ms": 2.959, "learner": {"shared_policy": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 3515.777587890625, "policy_loss": -0.00015874416567385197, "vf_loss": 3515.775390625, "vf_explained_var": -3.469524001431523e-09, "kl": 0.003701605834066868, "entropy": -0.25598081946372986, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 780000, "episodes_total": 600, "training_iteration": 75, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-08-38", "timestamp": 1710205718, "time_this_iter_s": 94.405109167099, "time_total_s": 7848.686811923981, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7848.686811923981, "timesteps_since_restore": 780000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 24.56, "ram_util_percent": 30.5762962962963}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 72837.45566392364, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 58244.17412901357, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -967.0162233524024}, "policy_reward_max": {"shared_policy": 947.6602041721344}, "policy_reward_mean": {"shared_policy": 410.1991276076736}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.51237340064513, "mean_processing_ms": 2.3994964444028426, "mean_inference_ms": 0.6805455437222822}, "off_policy_estimator": {}, "info": {"num_steps_trained": 28673408, "num_steps_sampled": 790400, "sample_time_ms": 92576.011, "load_time_ms": 46.66, "grad_time_ms": 4622.832, "update_time_ms": 3.059, "learner": {"shared_policy": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 4094.0, "policy_loss": 9.566394510329701e-06, "vf_loss": 4093.99755859375, "vf_explained_var": -6.111509520678737e-09, "kl": 0.0032442687079310417, "entropy": -0.26641350984573364, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 790400, "episodes_total": 608, "training_iteration": 76, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-10-10", "timestamp": 1710205810, "time_this_iter_s": 91.86707854270935, "time_total_s": 7940.55389046669, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7940.55389046669, "timesteps_since_restore": 790400, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.68549618320611, "ram_util_percent": 30.609923664122135}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 58489.919237628084, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 947.6602041721344}, "policy_reward_mean": {"shared_policy": 411.92984884589123}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.46707343449174, "mean_processing_ms": 2.398054370668863, "mean_inference_ms": 0.6804047245567506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29000704, "num_steps_sampled": 800800, "sample_time_ms": 92390.554, "load_time_ms": 47.085, "grad_time_ms": 4602.765, "update_time_ms": 3.206, "learner": {"shared_policy": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 4007.154052734375, "policy_loss": -4.9400059651816264e-05, "vf_loss": 4007.1513671875, "vf_explained_var": -6.200561397662341e-09, "kl": 0.0036610483657568693, "entropy": -0.28295406699180603, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 800800, "episodes_total": 616, "training_iteration": 77, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-11-43", "timestamp": 1710205903, "time_this_iter_s": 92.59048509597778, "time_total_s": 8033.144375562668, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8033.144375562668, "timesteps_since_restore": 800800, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 24.4530303030303, "ram_util_percent": 30.612878787878785}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 57823.5333078941, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 950.4251532554626}, "policy_reward_mean": {"shared_policy": 407.23665967951325}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.4274639419519, "mean_processing_ms": 2.3967703614173614, "mean_inference_ms": 0.6802857180482161}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29359488, "num_steps_sampled": 811200, "sample_time_ms": 93206.019, "load_time_ms": 47.281, "grad_time_ms": 4627.408, "update_time_ms": 3.167, "learner": {"shared_policy": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 3303.319580078125, "policy_loss": -0.0005236912402324378, "vf_loss": 3303.31787109375, "vf_explained_var": -3.147159199912153e-09, "kl": 0.005929852370172739, "entropy": -0.2673214375972748, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 811200, "episodes_total": 624, "training_iteration": 78, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-13-25", "timestamp": 1710206005, "time_this_iter_s": 102.23867583274841, "time_total_s": 8135.383051395416, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8135.383051395416, "timesteps_since_restore": 811200, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 24.283561643835615, "ram_util_percent": 30.652054794520545}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 57629.43780663374, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 950.4251532554626}, "policy_reward_mean": {"shared_policy": 405.8982800861653}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.39173175923432, "mean_processing_ms": 2.3956033481097156, "mean_inference_ms": 0.6801786015617424}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29720064, "num_steps_sampled": 821600, "sample_time_ms": 93317.47, "load_time_ms": 47.379, "grad_time_ms": 4628.13, "update_time_ms": 3.266, "learner": {"shared_policy": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 3103.37158203125, "policy_loss": -2.9601651476696134e-05, "vf_loss": 3103.368896484375, "vf_explained_var": -4.443370671403102e-10, "kl": 0.0028638592921197414, "entropy": -0.26596713066101074, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 821600, "episodes_total": 632, "training_iteration": 79, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-15-06", "timestamp": 1710206106, "time_this_iter_s": 100.7806293964386, "time_total_s": 8236.163680791855, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8236.163680791855, "timesteps_since_restore": 821600, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.569444444444443, "ram_util_percent": 30.641666666666666}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 57619.13331226357, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 952.5177435874939}, "policy_reward_mean": {"shared_policy": 405.79712171465303}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.358180815028064, "mean_processing_ms": 2.3945219598008434, "mean_inference_ms": 0.6800738470087038}, "off_policy_estimator": {}, "info": {"num_steps_trained": 30074496, "num_steps_sampled": 832000, "sample_time_ms": 92567.17, "load_time_ms": 47.92, "grad_time_ms": 4619.201, "update_time_ms": 3.245, "learner": {"shared_policy": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 3305.8583984375, "policy_loss": -0.00019278608669992536, "vf_loss": 3305.85595703125, "vf_explained_var": -2.1525692339707803e-09, "kl": 0.004053592681884766, "entropy": -0.2744215428829193, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 832000, "episodes_total": 640, "training_iteration": 80, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-16-44", "timestamp": 1710206204, "time_this_iter_s": 98.36100149154663, "time_total_s": 8334.524682283401, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8334.524682283401, "timesteps_since_restore": 832000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.417142857142853, "ram_util_percent": 30.630000000000006}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 57908.940398554856, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 952.5177435874939}, "policy_reward_mean": {"shared_policy": 407.8381604236556}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.325210665638394, "mean_processing_ms": 2.3934740590244927, "mean_inference_ms": 0.6799720397586779}, "off_policy_estimator": {}, "info": {"num_steps_trained": 30413696, "num_steps_sampled": 842400, "sample_time_ms": 92228.973, "load_time_ms": 47.779, "grad_time_ms": 4624.603, "update_time_ms": 3.257, "learner": {"shared_policy": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 3700.498046875, "policy_loss": -0.00038306848728097975, "vf_loss": 3700.495849609375, "vf_explained_var": -7.692372960832472e-09, "kl": 0.0043242438696324825, "entropy": -0.2810407876968384, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 842400, "episodes_total": 648, "training_iteration": 81, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-18-19", "timestamp": 1710206299, "time_this_iter_s": 95.0620470046997, "time_total_s": 8429.586729288101, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8429.586729288101, "timesteps_since_restore": 842400, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 24.413970588235294, "ram_util_percent": 30.67426470588235}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 41576.90256684064, "episode_reward_mean": 57913.64445002366, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 954.8413717746735}, "policy_reward_mean": {"shared_policy": 407.8712898797356}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.29333985661831, "mean_processing_ms": 2.3924603176500883, "mean_inference_ms": 0.679874274877274}, "off_policy_estimator": {}, "info": {"num_steps_trained": 30777472, "num_steps_sampled": 852800, "sample_time_ms": 92362.838, "load_time_ms": 47.734, "grad_time_ms": 4658.517, "update_time_ms": 3.244, "learner": {"shared_policy": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 3119.403564453125, "policy_loss": -1.9645100110210478e-05, "vf_loss": 3119.400390625, "vf_explained_var": -2.9361892917023624e-09, "kl": 0.002589945448562503, "entropy": -0.29596078395843506, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 852800, "episodes_total": 656, "training_iteration": 82, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-20-00", "timestamp": 1710206400, "time_this_iter_s": 100.01291561126709, "time_total_s": 8529.599644899368, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8529.599644899368, "timesteps_since_restore": 852800, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 24.627272727272725, "ram_util_percent": 30.7006993006993}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 44993.16301831114, "episode_reward_mean": 58408.37915040071, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 954.8413717746735}, "policy_reward_mean": {"shared_policy": 411.35558243820486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.26027520813886, "mean_processing_ms": 2.391401817842063, "mean_inference_ms": 0.679782303306026}, "off_policy_estimator": {}, "info": {"num_steps_trained": 31129088, "num_steps_sampled": 863200, "sample_time_ms": 91998.281, "load_time_ms": 47.582, "grad_time_ms": 4685.416, "update_time_ms": 3.318, "learner": {"shared_policy": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 3350.67236328125, "policy_loss": -7.646544690942392e-05, "vf_loss": 3350.66943359375, "vf_explained_var": -6.032068178285499e-09, "kl": 0.004159596282988787, "entropy": -0.29475003480911255, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 863200, "episodes_total": 664, "training_iteration": 83, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-21-37", "timestamp": 1710206497, "time_this_iter_s": 97.01728343963623, "time_total_s": 8626.616928339005, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8626.616928339005, "timesteps_since_restore": 863200, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 24.608695652173914, "ram_util_percent": 30.697826086956518}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 46008.31251768069, "episode_reward_mean": 58767.69052381979, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 954.8413717746735}, "policy_reward_mean": {"shared_policy": 413.88612242988785}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.228009558890555, "mean_processing_ms": 2.390335425130826, "mean_inference_ms": 0.6797155607144236}, "off_policy_estimator": {}, "info": {"num_steps_trained": 31475328, "num_steps_sampled": 873600, "sample_time_ms": 92122.005, "load_time_ms": 47.693, "grad_time_ms": 4694.067, "update_time_ms": 3.332, "learner": {"shared_policy": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 3441.96923828125, "policy_loss": -9.498642612015828e-05, "vf_loss": 3441.966064453125, "vf_explained_var": -6.27997165381089e-09, "kl": 0.00347096542827785, "entropy": -0.3044626712799072, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 873600, "episodes_total": 672, "training_iteration": 84, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-23-13", "timestamp": 1710206593, "time_this_iter_s": 96.71340751647949, "time_total_s": 8723.330335855484, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8723.330335855484, "timesteps_since_restore": 873600, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 24.791304347826085, "ram_util_percent": 30.72463768115942}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 46008.31251768069, "episode_reward_mean": 59427.78325872769, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 954.8413717746735}, "policy_reward_mean": {"shared_policy": 418.56446864859623}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.19501724066766, "mean_processing_ms": 2.3892188060848287, "mean_inference_ms": 0.6796605997714894}, "off_policy_estimator": {}, "info": {"num_steps_trained": 31816064, "num_steps_sampled": 884000, "sample_time_ms": 92202.86, "load_time_ms": 47.576, "grad_time_ms": 4678.635, "update_time_ms": 3.333, "learner": {"shared_policy": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 3579.800537109375, "policy_loss": -3.9809812733437866e-05, "vf_loss": 3579.797119140625, "vf_explained_var": -8.710069998585368e-09, "kl": 0.0042150202207267284, "entropy": -0.3026098310947418, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 884000, "episodes_total": 680, "training_iteration": 85, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-24-48", "timestamp": 1710206688, "time_this_iter_s": 95.05612087249756, "time_total_s": 8818.386456727982, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8818.386456727982, "timesteps_since_restore": 884000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.565441176470586, "ram_util_percent": 30.791176470588237}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75167.33470246941, "episode_reward_min": 46008.31251768069, "episode_reward_mean": 59549.27440606215, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1075.5088996328413}, "policy_reward_max": {"shared_policy": 954.8413717746735}, "policy_reward_mean": {"shared_policy": 419.4201606286952}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.16235269271102, "mean_processing_ms": 2.388111564518562, "mean_inference_ms": 0.6795958021849224}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32158464, "num_steps_sampled": 894400, "sample_time_ms": 92600.449, "load_time_ms": 47.875, "grad_time_ms": 4699.195, "update_time_ms": 3.283, "learner": {"shared_policy": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 3533.277099609375, "policy_loss": 5.5544620408909395e-05, "vf_loss": 3533.27392578125, "vf_explained_var": -4.968910616298672e-09, "kl": 0.0032956083305180073, "entropy": -0.3043174147605896, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 894400, "episodes_total": 688, "training_iteration": 86, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-26-25", "timestamp": 1710206785, "time_this_iter_s": 96.05212450027466, "time_total_s": 8914.438581228256, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8914.438581228256, "timesteps_since_restore": 894400, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 24.245255474452556, "ram_util_percent": 30.81021897810219}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46008.31251768069, "episode_reward_mean": 59617.54528607841, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1234.1259514652193}, "policy_reward_max": {"shared_policy": 955.1672149896622}, "policy_reward_mean": {"shared_policy": 419.90100919903097}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.12986489729168, "mean_processing_ms": 2.3870247619428437, "mean_inference_ms": 0.6795287475901053}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32500224, "num_steps_sampled": 904800, "sample_time_ms": 93000.116, "load_time_ms": 48.286, "grad_time_ms": 4725.088, "update_time_ms": 3.176, "learner": {"shared_policy": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 3563.228515625, "policy_loss": -0.00024238601326942444, "vf_loss": 3563.2255859375, "vf_explained_var": -4.330824587839288e-09, "kl": 0.0033888809848576784, "entropy": -0.301630437374115, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 904800, "episodes_total": 696, "training_iteration": 87, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-28-02", "timestamp": 1710206882, "time_this_iter_s": 96.84704732894897, "time_total_s": 9011.285628557205, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9011.285628557205, "timesteps_since_restore": 904800, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.918115942028983, "ram_util_percent": 30.808695652173917}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46008.31251768069, "episode_reward_mean": 59976.45220657487, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1234.1259514652193}, "policy_reward_max": {"shared_policy": 955.1672149896622}, "policy_reward_mean": {"shared_policy": 422.42887876162035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.09879315952247, "mean_processing_ms": 2.3859942250261827, "mean_inference_ms": 0.6794955087944468}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32838400, "num_steps_sampled": 915200, "sample_time_ms": 92558.012, "load_time_ms": 48.115, "grad_time_ms": 4715.179, "update_time_ms": 3.313, "learner": {"shared_policy": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 3560.054931640625, "policy_loss": -0.0001839390315581113, "vf_loss": 3560.0517578125, "vf_explained_var": -5.188897755914468e-09, "kl": 0.003183672670274973, "entropy": -0.31317365169525146, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 915200, "episodes_total": 704, "training_iteration": 88, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-29-39", "timestamp": 1710206979, "time_this_iter_s": 97.71722340583801, "time_total_s": 9109.002851963043, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9109.002851963043, "timesteps_since_restore": 915200, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 24.02, "ram_util_percent": 30.84142857142858}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46008.31251768069, "episode_reward_mean": 59465.586493498406, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1234.1259514652193}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 418.86022746705913}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.07162796822171, "mean_processing_ms": 2.385112197422133, "mean_inference_ms": 0.6794909890447457}, "off_policy_estimator": {}, "info": {"num_steps_trained": 33192064, "num_steps_sampled": 925600, "sample_time_ms": 92423.117, "load_time_ms": 50.264, "grad_time_ms": 4733.999, "update_time_ms": 3.271, "learner": {"shared_policy": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 3322.6611328125, "policy_loss": -0.00012097227590857074, "vf_loss": 3322.65869140625, "vf_explained_var": -4.681218968016765e-09, "kl": 0.004567744676023722, "entropy": -0.3044360280036926, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 925600, "episodes_total": 712, "training_iteration": 89, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-31-19", "timestamp": 1710207079, "time_this_iter_s": 99.63770794868469, "time_total_s": 9208.640559911728, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9208.640559911728, "timesteps_since_restore": 925600, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 25.01901408450704, "ram_util_percent": 30.88309859154929}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46008.31251768069, "episode_reward_mean": 59841.87284548319, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1234.1259514652193}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 421.51069131142634}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.046355355416964, "mean_processing_ms": 2.38434826585369, "mean_inference_ms": 0.6795144447703172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 33546624, "num_steps_sampled": 936000, "sample_time_ms": 92846.422, "load_time_ms": 49.796, "grad_time_ms": 4774.606, "update_time_ms": 3.197, "learner": {"shared_policy": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 4.999999873689376e-05, "total_loss": 3137.65673828125, "policy_loss": 0.00016197891090996563, "vf_loss": 3137.6533203125, "vf_explained_var": -3.765636247266002e-09, "kl": 0.002583943773061037, "entropy": -0.32001665234565735, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 936000, "episodes_total": 720, "training_iteration": 90, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-33-02", "timestamp": 1710207182, "time_this_iter_s": 102.99639701843262, "time_total_s": 9311.63695693016, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9311.63695693016, "timesteps_since_restore": 936000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 24.72380952380953, "ram_util_percent": 30.91904761904762}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 59957.06591071611, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1234.1259514652193}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 422.29233632001774}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 34.020764327309706, "mean_processing_ms": 2.3835849942948735, "mean_inference_ms": 0.6795312238002643}, "off_policy_estimator": {}, "info": {"num_steps_trained": 33893760, "num_steps_sampled": 946400, "sample_time_ms": 92845.267, "load_time_ms": 49.858, "grad_time_ms": 4761.629, "update_time_ms": 3.232, "learner": {"shared_policy": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 3458.512939453125, "policy_loss": -0.00010199084499618039, "vf_loss": 3458.510009765625, "vf_explained_var": -4.505513295782748e-09, "kl": 0.00399107625707984, "entropy": -0.2753832936286926, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 946400, "episodes_total": 728, "training_iteration": 91, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-34-37", "timestamp": 1710207277, "time_this_iter_s": 94.92197775840759, "time_total_s": 9406.558934688568, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9406.558934688568, "timesteps_since_restore": 946400, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 24.166176470588237, "ram_util_percent": 30.91102941176471}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 60524.7465892403, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1234.1259514652193}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 426.2906507201035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.99328404541665, "mean_processing_ms": 2.382723780574028, "mean_inference_ms": 0.6795358220493445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34229760, "num_steps_sampled": 956800, "sample_time_ms": 92287.441, "load_time_ms": 49.749, "grad_time_ms": 4716.612, "update_time_ms": 3.284, "learner": {"shared_policy": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 3721.666259765625, "policy_loss": 4.736228220281191e-05, "vf_loss": 3721.663330078125, "vf_explained_var": -4.564012723307087e-09, "kl": 0.002267624717205763, "entropy": -0.2884274423122406, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 956800, "episodes_total": 736, "training_iteration": 92, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-36-11", "timestamp": 1710207371, "time_this_iter_s": 93.97979307174683, "time_total_s": 9500.538727760315, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9500.538727760315, "timesteps_since_restore": 956800, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 24.14626865671642, "ram_util_percent": 30.96194029850746}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 60152.809874435625, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 423.67100911702795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.966488283002306, "mean_processing_ms": 2.3818722094249085, "mean_inference_ms": 0.6795306918703465}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34580992, "num_steps_sampled": 967200, "sample_time_ms": 92185.572, "load_time_ms": 49.625, "grad_time_ms": 4723.622, "update_time_ms": 3.384, "learner": {"shared_policy": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 4.999999873689376e-05, "total_loss": 3412.32177734375, "policy_loss": -0.0003493833646643907, "vf_loss": 3412.3193359375, "vf_explained_var": -5.126346902528667e-09, "kl": 0.003683720948174596, "entropy": -0.27923455834388733, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 967200, "episodes_total": 744, "training_iteration": 93, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-37-47", "timestamp": 1710207467, "time_this_iter_s": 96.06664252281189, "time_total_s": 9596.605370283127, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9596.605370283127, "timesteps_since_restore": 967200, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 23.71167883211679, "ram_util_percent": 30.988321167883214}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 60355.41173657667, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 425.097983776424}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.939722398584856, "mean_processing_ms": 2.3809886840340844, "mean_inference_ms": 0.6795378393334404}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34916480, "num_steps_sampled": 977600, "sample_time_ms": 92152.574, "load_time_ms": 49.655, "grad_time_ms": 4655.704, "update_time_ms": 3.477, "learner": {"shared_policy": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3654.03125, "policy_loss": -0.00010626768926158547, "vf_loss": 3654.0283203125, "vf_explained_var": -5.548848935887918e-09, "kl": 0.003740963526070118, "entropy": -0.28183990716934204, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 977600, "episodes_total": 752, "training_iteration": 94, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-39-23", "timestamp": 1710207563, "time_this_iter_s": 95.70415949821472, "time_total_s": 9692.309529781342, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9692.309529781342, "timesteps_since_restore": 977600, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 24.747058823529414, "ram_util_percent": 31.003676470588236}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 60277.37232619034, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 424.54833304824865}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.91330481873129, "mean_processing_ms": 2.380093390292473, "mean_inference_ms": 0.679558183229513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35261184, "num_steps_sampled": 988000, "sample_time_ms": 92439.9, "load_time_ms": 49.597, "grad_time_ms": 4663.484, "update_time_ms": 3.425, "learner": {"shared_policy": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3503.155517578125, "policy_loss": -0.0001858177565736696, "vf_loss": 3503.152587890625, "vf_explained_var": -3.6519740564955327e-09, "kl": 0.003954736515879631, "entropy": -0.25916147232055664, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 988000, "episodes_total": 760, "training_iteration": 95, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-41-01", "timestamp": 1710207661, "time_this_iter_s": 98.00736713409424, "time_total_s": 9790.316896915436, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9790.316896915436, "timesteps_since_restore": 988000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 25.08571428571429, "ram_util_percent": 31.01071428571428}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 60090.56932010805, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 423.2326336111287}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.886848738643856, "mean_processing_ms": 2.3791983170481474, "mean_inference_ms": 0.6795660520949011}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35611520, "num_steps_sampled": 998400, "sample_time_ms": 92460.314, "load_time_ms": 49.697, "grad_time_ms": 4658.693, "update_time_ms": 3.445, "learner": {"shared_policy": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3378.496826171875, "policy_loss": 0.00022698868997395039, "vf_loss": 3378.493896484375, "vf_explained_var": -3.223049827028035e-09, "kl": 0.0022120526991784573, "entropy": -0.2542648911476135, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 998400, "episodes_total": 768, "training_iteration": 96, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-42-37", "timestamp": 1710207757, "time_this_iter_s": 96.20944261550903, "time_total_s": 9886.526339530945, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9886.526339530945, "timesteps_since_restore": 998400, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 23.768840579710147, "ram_util_percent": 31.1}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 60039.09507345231, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 422.84030617263403}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.85943652806181, "mean_processing_ms": 2.37825723120599, "mean_inference_ms": 0.6795464472322793}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35944320, "num_steps_sampled": 1008800, "sample_time_ms": 91871.425, "load_time_ms": 48.905, "grad_time_ms": 4649.099, "update_time_ms": 3.507, "learner": {"shared_policy": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 4.999999873689376e-05, "total_loss": 3698.29150390625, "policy_loss": -0.00016195172793231905, "vf_loss": 3698.289306640625, "vf_explained_var": -5.570741645755106e-09, "kl": 0.004729909356683493, "entropy": -0.2570153772830963, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1008800, "episodes_total": 776, "training_iteration": 97, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-44-08", "timestamp": 1710207848, "time_this_iter_s": 90.85588812828064, "time_total_s": 9977.382227659225, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9977.382227659225, "timesteps_since_restore": 1008800, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.874418604651165, "ram_util_percent": 31.11395348837209}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 46503.34590059728, "episode_reward_mean": 59760.79788558337, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 420.8803287948684}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.83192518564734, "mean_processing_ms": 2.377319428204369, "mean_inference_ms": 0.6795325520939435}, "off_policy_estimator": {}, "info": {"num_steps_trained": 36276608, "num_steps_sampled": 1019200, "sample_time_ms": 91261.124, "load_time_ms": 48.567, "grad_time_ms": 4637.901, "update_time_ms": 3.378, "learner": {"shared_policy": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 3821.671142578125, "policy_loss": -0.00013310590293258429, "vf_loss": 3821.669189453125, "vf_explained_var": -5.740046660207554e-09, "kl": 0.005141262896358967, "entropy": -0.25247466564178467, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1019200, "episodes_total": 784, "training_iteration": 98, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-45-40", "timestamp": 1710207940, "time_this_iter_s": 91.49748539924622, "time_total_s": 10068.879713058472, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10068.879713058472, "timesteps_since_restore": 1019200, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 23.977862595419843, "ram_util_percent": 31.048091603053432}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75498.02411549576, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 60001.84545010592, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 422.5779664068309}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.80422932288386, "mean_processing_ms": 2.3763679133848354, "mean_inference_ms": 0.6795468350310631}, "off_policy_estimator": {}, "info": {"num_steps_trained": 36602880, "num_steps_sampled": 1029600, "sample_time_ms": 90906.437, "load_time_ms": 45.902, "grad_time_ms": 4580.641, "update_time_ms": 3.315, "learner": {"shared_policy": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 3985.760009765625, "policy_loss": 0.00020999017579015344, "vf_loss": 3985.7568359375, "vf_explained_var": -6.500624483152251e-09, "kl": 0.001764283631928265, "entropy": -0.27339762449264526, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1029600, "episodes_total": 792, "training_iteration": 99, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-47-15", "timestamp": 1710208035, "time_this_iter_s": 95.49299621582031, "time_total_s": 10164.372709274292, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10164.372709274292, "timesteps_since_restore": 1029600, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.887591240875913, "ram_util_percent": 31.008029197080294}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 71390.9403677556, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 59628.3583917214, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 419.94759061709544}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.777264777666126, "mean_processing_ms": 2.3754140774546197, "mean_inference_ms": 0.6795527963917608}, "off_policy_estimator": {}, "info": {"num_steps_trained": 36937472, "num_steps_sampled": 1040000, "sample_time_ms": 90102.338, "load_time_ms": 45.631, "grad_time_ms": 4515.986, "update_time_ms": 3.521, "learner": {"shared_policy": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 4.999999873689376e-05, "total_loss": 3761.751220703125, "policy_loss": 3.064754855586216e-05, "vf_loss": 3761.7490234375, "vf_explained_var": -5.6093125699874236e-09, "kl": 0.0027210379485040903, "entropy": -0.2712351083755493, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1040000, "episodes_total": 800, "training_iteration": 100, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-48-50", "timestamp": 1710208130, "time_this_iter_s": 94.3039882183075, "time_total_s": 10258.6766974926, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10258.6766974926, "timesteps_since_restore": 1040000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 24.26716417910448, "ram_util_percent": 31.01492537313433}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 71390.9403677556, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 59332.980968452815, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 957.9392601251602}, "policy_reward_mean": {"shared_policy": 417.86732142019025}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.75036354292804, "mean_processing_ms": 2.3744182041837836, "mean_inference_ms": 0.67953167839038}, "off_policy_estimator": {}, "info": {"num_steps_trained": 37286272, "num_steps_sampled": 1050400, "sample_time_ms": 90384.688, "load_time_ms": 45.681, "grad_time_ms": 4544.309, "update_time_ms": 3.483, "learner": {"shared_policy": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 3507.239013671875, "policy_loss": 0.00014930663746781647, "vf_loss": 3507.236328125, "vf_explained_var": -5.840161687586942e-09, "kl": 0.0027654061559587717, "entropy": -0.2652152478694916, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1050400, "episodes_total": 808, "training_iteration": 101, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-50-28", "timestamp": 1710208228, "time_this_iter_s": 98.02862572669983, "time_total_s": 10356.7053232193, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10356.7053232193, "timesteps_since_restore": 1050400, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 24.397142857142857, "ram_util_percent": 31.071428571428573}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 71390.9403677556, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 58973.47416108127, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 956.1254403591156}, "policy_reward_mean": {"shared_policy": 415.3354050361383}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.722506002514905, "mean_processing_ms": 2.373381664085442, "mean_inference_ms": 0.6794770781584706}, "off_policy_estimator": {}, "info": {"num_steps_trained": 37638528, "num_steps_sampled": 1060800, "sample_time_ms": 90762.626, "load_time_ms": 45.799, "grad_time_ms": 4569.015, "update_time_ms": 3.471, "learner": {"shared_policy": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 3447.648681640625, "policy_loss": -0.00020128536561969668, "vf_loss": 3447.646484375, "vf_explained_var": -6.51925802230835e-09, "kl": 0.0038224721793085337, "entropy": -0.25664660334587097, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1060800, "episodes_total": 816, "training_iteration": 102, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-52-06", "timestamp": 1710208326, "time_this_iter_s": 98.00993156433105, "time_total_s": 10454.71525478363, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10454.71525478363, "timesteps_since_restore": 1060800, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 24.170714285714283, "ram_util_percent": 31.132142857142856}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 71390.9403677556, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 59048.77226746248, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 956.1254403591156}, "policy_reward_mean": {"shared_policy": 415.86571073640744}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.694173484106685, "mean_processing_ms": 2.372298391721174, "mean_inference_ms": 0.679422488998156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 37972352, "num_steps_sampled": 1071200, "sample_time_ms": 90920.367, "load_time_ms": 46.085, "grad_time_ms": 4475.686, "update_time_ms": 3.48, "learner": {"shared_policy": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 4.999999873689376e-05, "total_loss": 3804.909423828125, "policy_loss": -0.00015870189236011356, "vf_loss": 3804.9072265625, "vf_explained_var": -4.365217520785336e-09, "kl": 0.003096611239016056, "entropy": -0.29237422347068787, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1071200, "episodes_total": 824, "training_iteration": 103, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-53-43", "timestamp": 1710208423, "time_this_iter_s": 96.71214437484741, "time_total_s": 10551.427399158478, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10551.427399158478, "timesteps_since_restore": 1071200, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 24.156521739130437, "ram_util_percent": 31.13115942028985}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 71390.9403677556, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 58891.63928725277, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1446.835748448968}, "policy_reward_max": {"shared_policy": 956.1254403591156}, "policy_reward_mean": {"shared_policy": 414.75906252026743}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.667579857403446, "mean_processing_ms": 2.3712924691019306, "mean_inference_ms": 0.6793881271204149}, "off_policy_estimator": {}, "info": {"num_steps_trained": 38315904, "num_steps_sampled": 1081600, "sample_time_ms": 91001.066, "load_time_ms": 46.1, "grad_time_ms": 4528.018, "update_time_ms": 3.416, "learner": {"shared_policy": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 3400.755126953125, "policy_loss": 0.00012870744103565812, "vf_loss": 3400.752197265625, "vf_explained_var": -4.8190043067108945e-09, "kl": 0.0032498612999916077, "entropy": -0.2705453932285309, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1081600, "episodes_total": 832, "training_iteration": 104, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-55-20", "timestamp": 1710208520, "time_this_iter_s": 97.03528165817261, "time_total_s": 10648.46268081665, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10648.46268081665, "timesteps_since_restore": 1081600, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.233093525179857, "ram_util_percent": 31.18705035971223}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 71390.9403677556, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 59003.81461533166, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 956.1254403591156}, "policy_reward_mean": {"shared_policy": 415.54908525481835}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.64149382794959, "mean_processing_ms": 2.370327001290521, "mean_inference_ms": 0.679361299118714}, "off_policy_estimator": {}, "info": {"num_steps_trained": 38658176, "num_steps_sampled": 1092000, "sample_time_ms": 90914.613, "load_time_ms": 46.181, "grad_time_ms": 4532.319, "update_time_ms": 3.493, "learner": {"shared_policy": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 3637.675048828125, "policy_loss": -6.56392949167639e-05, "vf_loss": 3637.67236328125, "vf_explained_var": -4.5472505760812965e-09, "kl": 0.002792354440316558, "entropy": -0.2713022232055664, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1092000, "episodes_total": 840, "training_iteration": 105, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-56-57", "timestamp": 1710208617, "time_this_iter_s": 97.18945908546448, "time_total_s": 10745.652139902115, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10745.652139902115, "timesteps_since_restore": 1092000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 23.638405797101445, "ram_util_percent": 31.174637681159425}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70115.45934545231, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 58614.153653356625, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 956.8566776514053}, "policy_reward_mean": {"shared_policy": 412.8338755694931}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.61757604386987, "mean_processing_ms": 2.369453480407367, "mean_inference_ms": 0.6793474091004441}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39022080, "num_steps_sampled": 1102400, "sample_time_ms": 91514.754, "load_time_ms": 46.768, "grad_time_ms": 4550.232, "update_time_ms": 3.626, "learner": {"shared_policy": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 4.999999873689376e-05, "total_loss": 3298.316650390625, "policy_loss": -0.00023664087348151952, "vf_loss": 3298.313720703125, "vf_explained_var": -5.534866787115789e-09, "kl": 0.004294205456972122, "entropy": -0.28944090008735657, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1102400, "episodes_total": 848, "training_iteration": 106, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_21-58-39", "timestamp": 1710208719, "time_this_iter_s": 102.40739583969116, "time_total_s": 10848.059535741806, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10848.059535741806, "timesteps_since_restore": 1102400, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.590476190476192, "ram_util_percent": 31.189795918367345}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70115.45934545231, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 58447.956591851005, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 968.0717532634735}, "policy_reward_mean": {"shared_policy": 411.6633088593535}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.59493943159501, "mean_processing_ms": 2.3686188077079624, "mean_inference_ms": 0.6793179676585106}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39377280, "num_steps_sampled": 1112800, "sample_time_ms": 92237.653, "load_time_ms": 47.219, "grad_time_ms": 4585.484, "update_time_ms": 3.643, "learner": {"shared_policy": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 3290.6220703125, "policy_loss": -0.0002090104389935732, "vf_loss": 3290.619140625, "vf_explained_var": -2.684893862792137e-09, "kl": 0.0033444443251937628, "entropy": -0.32373926043510437, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1112800, "episodes_total": 856, "training_iteration": 107, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-00-18", "timestamp": 1710208818, "time_this_iter_s": 98.44309377670288, "time_total_s": 10946.502629518509, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 10946.502629518509, "timesteps_since_restore": 1112800, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 24.39, "ram_util_percent": 31.195}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70149.08460614807, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 58854.41141423985, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 968.0717532634735}, "policy_reward_mean": {"shared_policy": 414.52606996929035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.57235395366397, "mean_processing_ms": 2.36779648234283, "mean_inference_ms": 0.6792903772201726}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39721088, "num_steps_sampled": 1123200, "sample_time_ms": 92834.022, "load_time_ms": 47.888, "grad_time_ms": 4588.273, "update_time_ms": 3.624, "learner": {"shared_policy": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 3680.538330078125, "policy_loss": 0.00010113696771441028, "vf_loss": 3680.535400390625, "vf_explained_var": 0.031208330765366554, "kl": 0.002786333439871669, "entropy": -0.311501681804657, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1123200, "episodes_total": 864, "training_iteration": 108, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-01-56", "timestamp": 1710208916, "time_this_iter_s": 97.4963972568512, "time_total_s": 11043.99902677536, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11043.99902677536, "timesteps_since_restore": 1123200, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 24.36115107913669, "ram_util_percent": 31.211510791366905}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70149.08460614807, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 59126.841800092494, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 968.0717532634735}, "policy_reward_mean": {"shared_policy": 416.44486406601277}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.55112396458525, "mean_processing_ms": 2.3670324357079147, "mean_inference_ms": 0.6792912132513328}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40063616, "num_steps_sampled": 1133600, "sample_time_ms": 93063.815, "load_time_ms": 48.237, "grad_time_ms": 4505.61, "update_time_ms": 3.627, "learner": {"shared_policy": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 3766.99853515625, "policy_loss": -0.00011549214832484722, "vf_loss": 3766.99560546875, "vf_explained_var": 0.0475616455078125, "kl": 0.0029258884023875, "entropy": -0.3342427909374237, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1133600, "episodes_total": 872, "training_iteration": 109, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-03-33", "timestamp": 1710209013, "time_this_iter_s": 96.97193932533264, "time_total_s": 11140.970966100693, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11140.970966100693, "timesteps_since_restore": 1133600, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 24.302877697841726, "ram_util_percent": 31.207913669064745}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 70149.08460614807, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 59158.421323045644, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 968.0717532634735}, "policy_reward_mean": {"shared_policy": 416.66728639981426}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.53281563340479, "mean_processing_ms": 2.366397912424928, "mean_inference_ms": 0.679319142365658}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40421376, "num_steps_sampled": 1144000, "sample_time_ms": 93640.636, "load_time_ms": 48.701, "grad_time_ms": 4535.309, "update_time_ms": 3.428, "learner": {"shared_policy": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 4.999999873689376e-05, "total_loss": 3401.347412109375, "policy_loss": -1.3167998986318707e-05, "vf_loss": 3401.34375, "vf_explained_var": 0.07038523256778717, "kl": 0.0024550452362746, "entropy": -0.3423353433609009, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1144000, "episodes_total": 880, "training_iteration": 110, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-05-13", "timestamp": 1710209113, "time_this_iter_s": 100.37403106689453, "time_total_s": 11241.344997167587, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11241.344997167587, "timesteps_since_restore": 1144000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 25.03426573426573, "ram_util_percent": 31.26153846153847}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 42932.03214542591, "episode_reward_mean": 59198.89897807291, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 968.0717532634735}, "policy_reward_mean": {"shared_policy": 416.9523804625504}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.51541150394444, "mean_processing_ms": 2.365803260886161, "mean_inference_ms": 0.6793406999353921}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40757888, "num_steps_sampled": 1154400, "sample_time_ms": 93144.794, "load_time_ms": 48.516, "grad_time_ms": 4515.258, "update_time_ms": 3.477, "learner": {"shared_policy": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 3890.0927734375, "policy_loss": -0.00010835979628609493, "vf_loss": 3890.08984375, "vf_explained_var": 0.08176559209823608, "kl": 0.005734134931117296, "entropy": -0.3500905930995941, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1154400, "episodes_total": 888, "training_iteration": 111, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-06-46", "timestamp": 1710209206, "time_this_iter_s": 92.86750888824463, "time_total_s": 11334.212506055832, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11334.212506055832, "timesteps_since_restore": 1154400, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 24.562406015037592, "ram_util_percent": 31.21278195488722}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 45093.67404139764, "episode_reward_mean": 59282.3539610267, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1336.3305208366364}, "policy_reward_max": {"shared_policy": 968.0717532634735}, "policy_reward_mean": {"shared_policy": 417.5401743979906}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.499135173985344, "mean_processing_ms": 2.3652505562561856, "mean_inference_ms": 0.6793578497672611}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41107840, "num_steps_sampled": 1164800, "sample_time_ms": 93274.153, "load_time_ms": 48.374, "grad_time_ms": 4509.103, "update_time_ms": 3.444, "learner": {"shared_policy": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 3601.237060546875, "policy_loss": -4.746762351715006e-05, "vf_loss": 3601.2333984375, "vf_explained_var": 0.11439775675535202, "kl": 0.0030229201074689627, "entropy": -0.3488045632839203, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1164800, "episodes_total": 896, "training_iteration": 112, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-08-25", "timestamp": 1710209305, "time_this_iter_s": 99.23930859565735, "time_total_s": 11433.45181465149, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11433.45181465149, "timesteps_since_restore": 1164800, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 23.782978723404252, "ram_util_percent": 31.224822695035467}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 45093.67404139764, "episode_reward_mean": 59316.89964249304, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1232.2597488164902}, "policy_reward_max": {"shared_policy": 970.4029376506805}, "policy_reward_mean": {"shared_policy": 417.7834881144741}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.483945417102035, "mean_processing_ms": 2.36474339099082, "mean_inference_ms": 0.6793782500670551}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41459840, "num_steps_sampled": 1175200, "sample_time_ms": 93337.148, "load_time_ms": 48.528, "grad_time_ms": 4610.524, "update_time_ms": 3.307, "learner": {"shared_policy": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 4.999999873689376e-05, "total_loss": 3552.8779296875, "policy_loss": 0.0003305023710709065, "vf_loss": 3552.873779296875, "vf_explained_var": 0.10882994532585144, "kl": 0.002012989018112421, "entropy": -0.3408489525318146, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1175200, "episodes_total": 904, "training_iteration": 113, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-10-04", "timestamp": 1710209404, "time_this_iter_s": 98.35859203338623, "time_total_s": 11531.810406684875, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11531.810406684875, "timesteps_since_restore": 1175200, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 24.69503546099291, "ram_util_percent": 31.253191489361708}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 45093.67404139764, "episode_reward_mean": 59803.63959345391, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1232.2597488164902}, "policy_reward_max": {"shared_policy": 970.4029376506805}, "policy_reward_mean": {"shared_policy": 421.2117170971538}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.46938682643765, "mean_processing_ms": 2.3642813209452, "mean_inference_ms": 0.6794021076878106}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41806848, "num_steps_sampled": 1185600, "sample_time_ms": 93632.01, "load_time_ms": 48.662, "grad_time_ms": 4629.803, "update_time_ms": 3.381, "learner": {"shared_policy": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 3793.34423828125, "policy_loss": -5.319997217156924e-05, "vf_loss": 3793.340576171875, "vf_explained_var": 0.12409332394599915, "kl": 0.003597475588321686, "entropy": -0.3748380243778229, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1185600, "episodes_total": 912, "training_iteration": 114, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-11-44", "timestamp": 1710209504, "time_this_iter_s": 100.17889451980591, "time_total_s": 11631.989301204681, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11631.989301204681, "timesteps_since_restore": 1185600, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 24.33076923076923, "ram_util_percent": 31.265034965034967}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 45093.67404139764, "episode_reward_mean": 60167.77571089197, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1232.2597488164902}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 423.746571666258}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.45494779711869, "mean_processing_ms": 2.363830596695077, "mean_inference_ms": 0.6794203100224491}, "off_policy_estimator": {}, "info": {"num_steps_trained": 42154496, "num_steps_sampled": 1196000, "sample_time_ms": 93519.039, "load_time_ms": 49.513, "grad_time_ms": 4625.258, "update_time_ms": 3.349, "learner": {"shared_policy": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 3787.9189453125, "policy_loss": -0.0001507382548879832, "vf_loss": 3787.915283203125, "vf_explained_var": 0.11548382043838501, "kl": 0.002538748551160097, "entropy": -0.37534233927726746, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1196000, "episodes_total": 920, "training_iteration": 115, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-13-20", "timestamp": 1710209600, "time_this_iter_s": 96.0217387676239, "time_total_s": 11728.011039972305, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11728.011039972305, "timesteps_since_restore": 1196000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 24.362773722627736, "ram_util_percent": 31.24160583941606}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 45093.67404139764, "episode_reward_mean": 60355.36775537022, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1232.2597488164902}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 425.06773544172285}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.440678617411486, "mean_processing_ms": 2.3633588245297785, "mean_inference_ms": 0.6794332752711388}, "off_policy_estimator": {}, "info": {"num_steps_trained": 42495616, "num_steps_sampled": 1206400, "sample_time_ms": 92875.428, "load_time_ms": 49.042, "grad_time_ms": 4528.542, "update_time_ms": 3.193, "learner": {"shared_policy": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 4.999999873689376e-05, "total_loss": 4049.503662109375, "policy_loss": -2.6160467314184643e-05, "vf_loss": 4049.500244140625, "vf_explained_var": 0.14323973655700684, "kl": 0.0031196034979075193, "entropy": -0.37743276357650757, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1206400, "episodes_total": 928, "training_iteration": 116, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-14-55", "timestamp": 1710209695, "time_this_iter_s": 94.99158000946045, "time_total_s": 11823.002619981766, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11823.002619981766, "timesteps_since_restore": 1206400, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 24.588970588235295, "ram_util_percent": 31.330147058823535}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 45093.67404139764, "episode_reward_mean": 60607.22498320627, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1232.2597488164902}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 426.8415028044671}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.42653223980578, "mean_processing_ms": 2.3628850755666333, "mean_inference_ms": 0.679444892679454}, "off_policy_estimator": {}, "info": {"num_steps_trained": 42839680, "num_steps_sampled": 1216800, "sample_time_ms": 92622.94, "load_time_ms": 48.569, "grad_time_ms": 4497.775, "update_time_ms": 3.118, "learner": {"shared_policy": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 3913.24560546875, "policy_loss": -2.0986024537705816e-05, "vf_loss": 3913.24169921875, "vf_explained_var": 0.15206162631511688, "kl": 0.0030509140342473984, "entropy": -0.3874422311782837, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1216800, "episodes_total": 936, "training_iteration": 117, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-16-31", "timestamp": 1710209791, "time_this_iter_s": 95.60257267951965, "time_total_s": 11918.605192661285, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11918.605192661285, "timesteps_since_restore": 1216800, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 25.204411764705885, "ram_util_percent": 31.310294117647064}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 60372.59920582794, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 425.4887533006409}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.413016173506996, "mean_processing_ms": 2.362442587093492, "mean_inference_ms": 0.6794448083363901}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43208192, "num_steps_sampled": 1227200, "sample_time_ms": 93246.897, "load_time_ms": 48.729, "grad_time_ms": 4522.053, "update_time_ms": 3.16, "learner": {"shared_policy": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 3559.893310546875, "policy_loss": -0.0002061048726318404, "vf_loss": 3559.89013671875, "vf_explained_var": 0.2697812616825104, "kl": 0.004503414500504732, "entropy": -0.3433544635772705, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1227200, "episodes_total": 944, "training_iteration": 118, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-18-15", "timestamp": 1710209895, "time_this_iter_s": 103.98164916038513, "time_total_s": 12022.58684182167, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12022.58684182167, "timesteps_since_restore": 1227200, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 24.153691275167787, "ram_util_percent": 31.380536912751676}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 60435.926801405585, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 425.93506802033676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.39937146821386, "mean_processing_ms": 2.361992411569477, "mean_inference_ms": 0.6794433772281491}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43562496, "num_steps_sampled": 1237600, "sample_time_ms": 93329.516, "load_time_ms": 48.75, "grad_time_ms": 4638.547, "update_time_ms": 3.149, "learner": {"shared_policy": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 3836.93359375, "policy_loss": -0.00015438503760378808, "vf_loss": 3836.929443359375, "vf_explained_var": 0.17837804555892944, "kl": 0.0026397171895951033, "entropy": -0.37874072790145874, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1237600, "episodes_total": 952, "training_iteration": 119, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-19-54", "timestamp": 1710209994, "time_this_iter_s": 98.96127152442932, "time_total_s": 12121.5481133461, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12121.5481133461, "timesteps_since_restore": 1237600, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 24.72127659574468, "ram_util_percent": 31.44255319148936}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 60523.29152013763, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 426.5507894857822}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.385850709278536, "mean_processing_ms": 2.361538581076155, "mean_inference_ms": 0.6794417585131763}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43910656, "num_steps_sampled": 1248000, "sample_time_ms": 92958.77, "load_time_ms": 48.524, "grad_time_ms": 4620.729, "update_time_ms": 3.209, "learner": {"shared_policy": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 4.999999873689376e-05, "total_loss": 3998.503662109375, "policy_loss": 0.00012703187530860305, "vf_loss": 3998.5, "vf_explained_var": 0.12719734013080597, "kl": 0.0032462512608617544, "entropy": -0.38917621970176697, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1248000, "episodes_total": 960, "training_iteration": 120, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-21-30", "timestamp": 1710210090, "time_this_iter_s": 96.48672246932983, "time_total_s": 12218.03483581543, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12218.03483581543, "timesteps_since_restore": 1248000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 24.484057971014494, "ram_util_percent": 31.464492753623183}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 60941.26234464392, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 429.49652790643387}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.37188349403377, "mean_processing_ms": 2.361067891690319, "mean_inference_ms": 0.6794331037218665}, "off_policy_estimator": {}, "info": {"num_steps_trained": 44243840, "num_steps_sampled": 1258400, "sample_time_ms": 92983.498, "load_time_ms": 48.604, "grad_time_ms": 4610.729, "update_time_ms": 3.223, "learner": {"shared_policy": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 4328.21826171875, "policy_loss": 0.0001151894248323515, "vf_loss": 4328.2138671875, "vf_explained_var": 0.12443853914737701, "kl": 0.0022470562253147364, "entropy": -0.4219430088996887, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1258400, "episodes_total": 968, "training_iteration": 121, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-23-04", "timestamp": 1710210184, "time_this_iter_s": 93.01822185516357, "time_total_s": 12311.053057670593, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12311.053057670593, "timesteps_since_restore": 1258400, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 24.33308270676692, "ram_util_percent": 31.477443609022558}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 75151.37351313513, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61061.668030737696, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 430.34511262765307}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.35767208351396, "mean_processing_ms": 2.36058735202693, "mean_inference_ms": 0.6794218922843122}, "off_policy_estimator": {}, "info": {"num_steps_trained": 44583168, "num_steps_sampled": 1268800, "sample_time_ms": 92874.19, "load_time_ms": 48.58, "grad_time_ms": 4608.531, "update_time_ms": 3.209, "learner": {"shared_policy": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 4361.3720703125, "policy_loss": -0.0002699422766454518, "vf_loss": 4361.36767578125, "vf_explained_var": 0.14411599934101105, "kl": 0.004428427666425705, "entropy": -0.42359447479248047, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1268800, "episodes_total": 976, "training_iteration": 122, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-24-42", "timestamp": 1710210282, "time_this_iter_s": 98.12841057777405, "time_total_s": 12409.181468248367, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12409.181468248367, "timesteps_since_restore": 1268800, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 25.174285714285713, "ram_util_percent": 31.48285714285714}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 74995.82973568485, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61047.87963487572, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 975.078376531601}, "policy_reward_mean": {"shared_policy": 430.24793597065144}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.343947635659234, "mean_processing_ms": 2.360112439411718, "mean_inference_ms": 0.6794091594343044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 44936192, "num_steps_sampled": 1279200, "sample_time_ms": 93237.123, "load_time_ms": 48.704, "grad_time_ms": 4597.242, "update_time_ms": 3.218, "learner": {"shared_policy": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 4.999999873689376e-05, "total_loss": 4060.422119140625, "policy_loss": 0.0001804283238016069, "vf_loss": 4060.41796875, "vf_explained_var": 0.16665400564670563, "kl": 0.0024535327684134245, "entropy": -0.4106820225715637, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1279200, "episodes_total": 984, "training_iteration": 123, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-26-24", "timestamp": 1710210384, "time_this_iter_s": 101.87812519073486, "time_total_s": 12511.059593439102, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12511.059593439102, "timesteps_since_restore": 1279200, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 24.15655172413793, "ram_util_percent": 31.526896551724136}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61187.4047128788, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 979.0356838703156}, "policy_reward_mean": {"shared_policy": 431.2312686791092}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.33064340830652, "mean_processing_ms": 2.3596534394293673, "mean_inference_ms": 0.6793968494473219}, "off_policy_estimator": {}, "info": {"num_steps_trained": 45285632, "num_steps_sampled": 1289600, "sample_time_ms": 93041.733, "load_time_ms": 48.613, "grad_time_ms": 4562.694, "update_time_ms": 3.166, "learner": {"shared_policy": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 3998.077392578125, "policy_loss": 0.00017072254559025168, "vf_loss": 3998.072998046875, "vf_explained_var": 0.15152710676193237, "kl": 0.0022720671258866787, "entropy": -0.4137776792049408, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1289600, "episodes_total": 992, "training_iteration": 124, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-28-02", "timestamp": 1710210482, "time_this_iter_s": 97.88014531135559, "time_total_s": 12608.939738750458, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12608.939738750458, "timesteps_since_restore": 1289600, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 23.61357142857143, "ram_util_percent": 31.585000000000004}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61570.58603052807, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 979.0356838703156}, "policy_reward_mean": {"shared_policy": 433.9318206394255}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.316906852837604, "mean_processing_ms": 2.35918676152924, "mean_inference_ms": 0.6793854783439912}, "off_policy_estimator": {}, "info": {"num_steps_trained": 45621248, "num_steps_sampled": 1300000, "sample_time_ms": 93039.22, "load_time_ms": 47.652, "grad_time_ms": 4550.79, "update_time_ms": 3.138, "learner": {"shared_policy": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 4508.97021484375, "policy_loss": 5.2425537433009595e-05, "vf_loss": 4508.9658203125, "vf_explained_var": 0.1522042155265808, "kl": 0.002843463560566306, "entropy": -0.4479973614215851, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1300000, "episodes_total": 1000, "training_iteration": 125, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-29-38", "timestamp": 1710210578, "time_this_iter_s": 95.86880564689636, "time_total_s": 12704.808544397354, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12704.808544397354, "timesteps_since_restore": 1300000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 24.705839416058392, "ram_util_percent": 31.635766423357666}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61793.45733375128, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 979.0356838703156}, "policy_reward_mean": {"shared_policy": 435.5332487577621}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.3031738631612, "mean_processing_ms": 2.3587250551670347, "mean_inference_ms": 0.6793810813008696}, "off_policy_estimator": {}, "info": {"num_steps_trained": 45972864, "num_steps_sampled": 1310400, "sample_time_ms": 93537.07, "load_time_ms": 47.535, "grad_time_ms": 4637.657, "update_time_ms": 3.202, "learner": {"shared_policy": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 4.999999873689376e-05, "total_loss": 3999.27001953125, "policy_loss": -0.00014507293235510588, "vf_loss": 3999.26611328125, "vf_explained_var": 0.1720132678747177, "kl": 0.0026789384428411722, "entropy": -0.4285430610179901, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1310400, "episodes_total": 1008, "training_iteration": 126, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-31-18", "timestamp": 1710210678, "time_this_iter_s": 100.83740544319153, "time_total_s": 12805.645949840546, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12805.645949840546, "timesteps_since_restore": 1310400, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 24.632638888888888, "ram_util_percent": 31.647222222222222}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61679.012255214984, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 979.0356838703156}, "policy_reward_mean": {"shared_policy": 434.7572584423415}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.289903904449226, "mean_processing_ms": 2.3582749935875045, "mean_inference_ms": 0.6793917395478917}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46312832, "num_steps_sampled": 1320800, "sample_time_ms": 93697.723, "load_time_ms": 47.559, "grad_time_ms": 4638.038, "update_time_ms": 3.218, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4433.55810546875, "policy_loss": -2.268158641527407e-05, "vf_loss": 4433.5537109375, "vf_explained_var": 0.1619977355003357, "kl": 0.003761633997783065, "entropy": -0.43222367763519287, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1320800, "episodes_total": 1016, "training_iteration": 127, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-32-56", "timestamp": 1710210776, "time_this_iter_s": 97.21362257003784, "time_total_s": 12902.859572410583, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12902.859572410583, "timesteps_since_restore": 1320800, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 25.424460431654676, "ram_util_percent": 31.770503597122303}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61481.31576799865, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 979.6815474033356}, "policy_reward_mean": {"shared_policy": 433.3637539155469}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.277196874513876, "mean_processing_ms": 2.3578647036110265, "mean_inference_ms": 0.6793890410936231}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46665088, "num_steps_sampled": 1331200, "sample_time_ms": 93050.929, "load_time_ms": 47.488, "grad_time_ms": 4608.215, "update_time_ms": 3.273, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 3897.228515625, "policy_loss": 1.991470890061464e-05, "vf_loss": 3897.224609375, "vf_explained_var": 0.15623705089092255, "kl": 0.0032955172937363386, "entropy": -0.39884987473487854, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1331200, "episodes_total": 1024, "training_iteration": 128, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-34-33", "timestamp": 1710210873, "time_this_iter_s": 97.21768808364868, "time_total_s": 13000.077260494232, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13000.077260494232, "timesteps_since_restore": 1331200, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 23.90072463768116, "ram_util_percent": 31.755072463768116}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 40137.68418789096, "episode_reward_mean": 61358.579038619326, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1304.029988706112}, "policy_reward_max": {"shared_policy": 979.6815474033356}, "policy_reward_mean": {"shared_policy": 432.49861872573007}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.265106549711966, "mean_processing_ms": 2.3574911385018296, "mean_inference_ms": 0.6793846632260255}, "off_policy_estimator": {}, "info": {"num_steps_trained": 47022336, "num_steps_sampled": 1341600, "sample_time_ms": 93301.82, "load_time_ms": 47.583, "grad_time_ms": 4596.585, "update_time_ms": 3.28, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 3849.3095703125, "policy_loss": -0.00015703913231845945, "vf_loss": 3849.3056640625, "vf_explained_var": 0.1423213928937912, "kl": 0.0031034830026328564, "entropy": -0.40807288885116577, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1341600, "episodes_total": 1032, "training_iteration": 129, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-36-15", "timestamp": 1710210975, "time_this_iter_s": 101.35709142684937, "time_total_s": 13101.434351921082, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13101.434351921082, "timesteps_since_restore": 1341600, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 24.14689655172414, "ram_util_percent": 31.78}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 44580.64533116936, "episode_reward_mean": 61934.060897084615, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -1010.6683215424418}, "policy_reward_max": {"shared_policy": 979.6815474033356}, "policy_reward_mean": {"shared_policy": 436.370470634007}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.25241081613879, "mean_processing_ms": 2.357096594246623, "mean_inference_ms": 0.6793760307692819}, "off_policy_estimator": {}, "info": {"num_steps_trained": 47363328, "num_steps_sampled": 1352000, "sample_time_ms": 93098.329, "load_time_ms": 47.51, "grad_time_ms": 4590.438, "update_time_ms": 3.309, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4464.55908203125, "policy_loss": 5.7786724937614053e-05, "vf_loss": 4464.55419921875, "vf_explained_var": 0.1342502385377884, "kl": 0.0028216333594173193, "entropy": -0.4392547011375427, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1352000, "episodes_total": 1040, "training_iteration": 130, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-37-49", "timestamp": 1710211069, "time_this_iter_s": 94.39226531982422, "time_total_s": 13195.826617240906, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13195.826617240906, "timesteps_since_restore": 1352000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 24.46148148148148, "ram_util_percent": 31.787407407407414}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 43836.4195958951, "episode_reward_mean": 62249.0784338079, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -851.5183471702039}, "policy_reward_max": {"shared_policy": 979.6815474033356}, "policy_reward_mean": {"shared_policy": 438.4973121570012}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.23961604366836, "mean_processing_ms": 2.3567010402004023, "mean_inference_ms": 0.6793696681766659}, "off_policy_estimator": {}, "info": {"num_steps_trained": 47722112, "num_steps_sampled": 1362400, "sample_time_ms": 93693.836, "load_time_ms": 48.044, "grad_time_ms": 4627.574, "update_time_ms": 3.304, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 3845.533447265625, "policy_loss": -0.0001515467738499865, "vf_loss": 3845.529052734375, "vf_explained_var": 0.14522922039031982, "kl": 0.003281812183558941, "entropy": -0.41592779755592346, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1362400, "episodes_total": 1048, "training_iteration": 131, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-39-28", "timestamp": 1710211168, "time_this_iter_s": 99.35021543502808, "time_total_s": 13295.176832675934, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13295.176832675934, "timesteps_since_restore": 1362400, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 24.1887323943662, "ram_util_percent": 31.83239436619718}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 43836.4195958951, "episode_reward_mean": 61583.328495388814, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -851.5183471702039}, "policy_reward_max": {"shared_policy": 980.7281224727631}, "policy_reward_mean": {"shared_policy": 433.8993059634243}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.228070602770494, "mean_processing_ms": 2.3563315402864786, "mean_inference_ms": 0.6793707126216085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48092032, "num_steps_sampled": 1372800, "sample_time_ms": 93950.572, "load_time_ms": 48.308, "grad_time_ms": 4589.888, "update_time_ms": 3.29, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 3813.614501953125, "policy_loss": 0.00018640852067619562, "vf_loss": 3813.6103515625, "vf_explained_var": 0.19623391330242157, "kl": 0.002335048047825694, "entropy": -0.4019659757614136, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1372800, "episodes_total": 1056, "training_iteration": 132, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-41-09", "timestamp": 1710211269, "time_this_iter_s": 100.31861090660095, "time_total_s": 13395.495443582535, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13395.495443582535, "timesteps_since_restore": 1372800, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 24.80979020979021, "ram_util_percent": 31.893706293706288}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 60781.91347385843, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 980.7281224727631}, "policy_reward_mean": {"shared_policy": 428.43387237512115}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.2186182655021, "mean_processing_ms": 2.356054267871173, "mean_inference_ms": 0.6793777427851705}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48470912, "num_steps_sampled": 1383200, "sample_time_ms": 94309.905, "load_time_ms": 47.925, "grad_time_ms": 4614.517, "update_time_ms": 3.354, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 3570.502685546875, "policy_loss": 2.8307373213465326e-05, "vf_loss": 3570.49853515625, "vf_explained_var": 0.24310092628002167, "kl": 0.0027675803285092115, "entropy": -0.4124910831451416, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1383200, "episodes_total": 1064, "training_iteration": 133, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-42-55", "timestamp": 1710211375, "time_this_iter_s": 105.71440434455872, "time_total_s": 13501.209847927094, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13501.209847927094, "timesteps_since_restore": 1383200, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.016556291390728, "ram_util_percent": 31.98476821192052}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 60096.203023176604, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 980.7281224727631}, "policy_reward_mean": {"shared_policy": 423.63036108259286}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.21090958814234, "mean_processing_ms": 2.3558465352886513, "mean_inference_ms": 0.6793780551923709}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48840192, "num_steps_sampled": 1393600, "sample_time_ms": 94815.049, "load_time_ms": 48.158, "grad_time_ms": 4666.655, "update_time_ms": 3.345, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 3773.002685546875, "policy_loss": -0.00023072678595781326, "vf_loss": 3772.99853515625, "vf_explained_var": 0.18759149312973022, "kl": 0.0037437696009874344, "entropy": -0.43399232625961304, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1393600, "episodes_total": 1072, "training_iteration": 134, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-44-38", "timestamp": 1710211478, "time_this_iter_s": 103.45375657081604, "time_total_s": 13604.66360449791, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13604.66360449791, "timesteps_since_restore": 1393600, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 24.447972972972973, "ram_util_percent": 32.0054054054054}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 59845.485990401154, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 981.147572517395}, "policy_reward_mean": {"shared_policy": 421.8630057126826}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.20404251118541, "mean_processing_ms": 2.3556725798847036, "mean_inference_ms": 0.6793736023028242}, "off_policy_estimator": {}, "info": {"num_steps_trained": 49200512, "num_steps_sampled": 1404000, "sample_time_ms": 95514.88, "load_time_ms": 48.451, "grad_time_ms": 4698.453, "update_time_ms": 3.437, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4140.6591796875, "policy_loss": 1.3070250588498311e-06, "vf_loss": 4140.6552734375, "vf_explained_var": 0.14596927165985107, "kl": 0.0026936258655041456, "entropy": -0.4547829329967499, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1404000, "episodes_total": 1080, "training_iteration": 135, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-46-21", "timestamp": 1710211581, "time_this_iter_s": 103.19115233421326, "time_total_s": 13707.854756832123, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13707.854756832123, "timesteps_since_restore": 1404000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 23.96326530612245, "ram_util_percent": 31.993877551020404}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 77761.51793936081, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 60262.60584938598, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 981.147572517395}, "policy_reward_mean": {"shared_policy": 424.80336845753544}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.19675418881854, "mean_processing_ms": 2.3555014393889993, "mean_inference_ms": 0.6793741844681354}, "off_policy_estimator": {}, "info": {"num_steps_trained": 49548672, "num_steps_sampled": 1414400, "sample_time_ms": 95492.68, "load_time_ms": 48.292, "grad_time_ms": 4681.29, "update_time_ms": 3.342, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4277.01611328125, "policy_loss": -0.0001643151044845581, "vf_loss": 4277.01171875, "vf_explained_var": 0.10884138196706772, "kl": 0.004348426591604948, "entropy": -0.47803232073783875, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1414400, "episodes_total": 1088, "training_iteration": 136, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-48-02", "timestamp": 1710211682, "time_this_iter_s": 100.4485559463501, "time_total_s": 13808.303312778473, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13808.303312778473, "timesteps_since_restore": 1414400, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 23.905594405594407, "ram_util_percent": 31.98601398601398}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 73301.47437831876, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 60129.80204451843, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 981.147572517395}, "policy_reward_mean": {"shared_policy": 423.8672074194166}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.19108990627734, "mean_processing_ms": 2.3553760273761584, "mean_inference_ms": 0.6793850864900545}, "off_policy_estimator": {}, "info": {"num_steps_trained": 49906944, "num_steps_sampled": 1424800, "sample_time_ms": 95951.183, "load_time_ms": 48.91, "grad_time_ms": 4698.459, "update_time_ms": 3.324, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4059.7685546875, "policy_loss": -2.8147362172603607e-05, "vf_loss": 4059.763427734375, "vf_explained_var": 0.13094846904277802, "kl": 0.002641770988702774, "entropy": -0.49381500482559204, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1424800, "episodes_total": 1096, "training_iteration": 137, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-49-44", "timestamp": 1710211784, "time_this_iter_s": 101.97755789756775, "time_total_s": 13910.28087067604, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13910.28087067604, "timesteps_since_restore": 1424800, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 24.369178082191777, "ram_util_percent": 32.00273972602739}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 73301.47437831876, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 60055.10247584982, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 981.147572517395}, "policy_reward_mean": {"shared_policy": 423.3406349629904}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.18566928492432, "mean_processing_ms": 2.355265639261564, "mean_inference_ms": 0.6793876151879263}, "off_policy_estimator": {}, "info": {"num_steps_trained": 50267264, "num_steps_sampled": 1435200, "sample_time_ms": 96019.927, "load_time_ms": 48.444, "grad_time_ms": 4709.046, "update_time_ms": 3.267, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4152.939453125, "policy_loss": 1.6015292203519493e-05, "vf_loss": 4152.93408203125, "vf_explained_var": 0.14105215668678284, "kl": 0.0031939533073455095, "entropy": -0.4709398150444031, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1435200, "episodes_total": 1104, "training_iteration": 138, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-51-22", "timestamp": 1710211882, "time_this_iter_s": 98.002681016922, "time_total_s": 14008.283551692963, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14008.283551692963, "timesteps_since_restore": 1435200, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 24.4, "ram_util_percent": 32.02357142857143}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 73301.47437831876, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 59536.779755841, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 981.7888262271881}, "policy_reward_mean": {"shared_policy": 419.6277118398717}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.18196550118845, "mean_processing_ms": 2.3551859351398075, "mean_inference_ms": 0.6793833227278091}, "off_policy_estimator": {}, "info": {"num_steps_trained": 50642304, "num_steps_sampled": 1445600, "sample_time_ms": 96307.666, "load_time_ms": 49.033, "grad_time_ms": 4748.514, "update_time_ms": 3.304, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 3625.984375, "policy_loss": -6.877936539240181e-05, "vf_loss": 3625.97998046875, "vf_explained_var": 0.14154981076717377, "kl": 0.0032481385860592127, "entropy": -0.4441356956958771, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1445600, "episodes_total": 1112, "training_iteration": 139, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-53-07", "timestamp": 1710211987, "time_this_iter_s": 104.63657212257385, "time_total_s": 14112.920123815536, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14112.920123815536, "timesteps_since_restore": 1445600, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 24.46442953020134, "ram_util_percent": 32.06979865771813}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 73301.47437831876, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 59306.579480531924, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 982.3520331382751}, "policy_reward_mean": {"shared_policy": 418.00521201389853}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.17917371344695, "mean_processing_ms": 2.3551353290919246, "mean_inference_ms": 0.6793850619556767}, "off_policy_estimator": {}, "info": {"num_steps_trained": 50999680, "num_steps_sampled": 1456000, "sample_time_ms": 96950.791, "load_time_ms": 49.704, "grad_time_ms": 4768.009, "update_time_ms": 3.256, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4282.93994140625, "policy_loss": -9.99243711703457e-05, "vf_loss": 4282.9345703125, "vf_explained_var": 0.12055017054080963, "kl": 0.002863213885575533, "entropy": -0.46309733390808105, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1456000, "episodes_total": 1120, "training_iteration": 140, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-54-48", "timestamp": 1710212088, "time_this_iter_s": 101.02427196502686, "time_total_s": 14213.944395780563, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14213.944395780563, "timesteps_since_restore": 1456000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 25.071034482758623, "ram_util_percent": 32.08137931034483}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 73121.5687905727, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 59522.23804321459, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 982.3520331382751}, "policy_reward_mean": {"shared_policy": 419.52521879908784}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.17616756265335, "mean_processing_ms": 2.3550938456410786, "mean_inference_ms": 0.6793902892601484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 51348224, "num_steps_sampled": 1466400, "sample_time_ms": 96922.207, "load_time_ms": 49.357, "grad_time_ms": 4749.745, "update_time_ms": 3.175, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4456.28662109375, "policy_loss": -0.00022643167176283896, "vf_loss": 4456.2822265625, "vf_explained_var": 0.12259513139724731, "kl": 0.004156006500124931, "entropy": -0.49168622493743896, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1466400, "episodes_total": 1128, "training_iteration": 141, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-56-27", "timestamp": 1710212187, "time_this_iter_s": 98.87835574150085, "time_total_s": 14312.822751522064, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14312.822751522064, "timesteps_since_restore": 1466400, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 24.231205673758865, "ram_util_percent": 32.09858156028369}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}
{"episode_reward_max": 73121.5687905727, "episode_reward_min": 42363.85721250647, "episode_reward_mean": 59775.11667345404, "episode_len_mean": 1300.0, "episodes_this_iter": 8, "policy_reward_min": {"shared_policy": -952.0718957427889}, "policy_reward_max": {"shared_policy": 982.3520331382751}, "policy_reward_mean": {"shared_policy": 421.30756042750244}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 33.17308578490995, "mean_processing_ms": 2.3550466162666273, "mean_inference_ms": 0.6794015663437333}, "off_policy_estimator": {}, "info": {"num_steps_trained": 51688832, "num_steps_sampled": 1476800, "sample_time_ms": 96384.918, "load_time_ms": 49.071, "grad_time_ms": 4774.475, "update_time_ms": 3.262, "learner": {"shared_policy": {"cur_kl_coeff": 0.0, "cur_lr": 4.999999873689376e-05, "total_loss": 4584.3935546875, "policy_loss": 9.836311801336706e-05, "vf_loss": 4584.3876953125, "vf_explained_var": 0.11362351477146149, "kl": 0.003467732109129429, "entropy": -0.4990975558757782, "entropy_coeff": 0.009999999776482582}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1476800, "episodes_total": 1136, "training_iteration": 142, "experiment_id": "47dd114bc2494a5da3b8e231b951cba8", "date": "2024-03-11_22-58-02", "timestamp": 1710212282, "time_this_iter_s": 95.19012832641602, "time_total_s": 14408.01287984848, "pid": 1201, "hostname": "COM2134", "node_ip": "172.19.177.241", "config": {"num_workers": 4, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10400, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 16, 8], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1300, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2600,\n                5200\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 5,\n            \"max_decel\": 5,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 15\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1300,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"flow.envs.multiagent.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 17\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 720.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 6,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 2880.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0.1,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(9,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x7f065d238f28>", "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": [[0, 0.0001], [100000, 5e-05]], "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.1], [100000, 0.02], [500000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14408.01287984848, "timesteps_since_restore": 1476800, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 24.00514705882353, "ram_util_percent": 32.1139705882353}, "num_healthy_workers": 4, "trial_id": "c4368a46", "experiment_tag": "0"}

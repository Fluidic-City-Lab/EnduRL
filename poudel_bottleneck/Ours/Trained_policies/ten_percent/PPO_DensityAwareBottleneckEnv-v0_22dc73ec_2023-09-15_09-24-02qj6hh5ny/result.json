{"episode_reward_max": -7967.3483483096, "episode_reward_min": -18880.863713255483, "episode_reward_mean": -12298.20400446231, "episode_len_mean": 3600.0, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 36.88234403562457, "mean_processing_ms": 8.660428422556377, "mean_inference_ms": 0.747054001736775}, "off_policy_estimator": {}, "info": {"num_steps_trained": 115200, "num_steps_sampled": 115200, "sample_time_ms": 697396.277, "load_time_ms": 257.287, "grad_time_ms": 18511.92, "update_time_ms": 721.066, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 12914.4111328125, "policy_loss": 0.2803514003753662, "vf_loss": 12924.255859375, "vf_explained_var": 0.035545915365219116, "kl": 12.861790657043457, "entropy": 84.65150451660156, "entropy_coeff": 0.15000000596046448}}}, "timesteps_this_iter": 115200, "done": false, "timesteps_total": 115200, "episodes_total": 29, "training_iteration": 1, "experiment_id": "25dec639bd8d4d1c8ddd6d6727b0eb56", "date": "2023-09-15_09-36-04", "timestamp": 1694784964, "time_this_iter_s": 716.9302432537079, "time_total_s": 716.9302432537079, "pid": 22618, "hostname": "Kurukshetra", "node_ip": "192.168.68.14", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 115200, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256, 128], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 3600, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"controlled_segments\": [\n                [\n                    \"1\",\n                    1,\n                    false\n                ],\n                [\n                    \"2\",\n                    2,\n                    true\n                ],\n                [\n                    \"3\",\n                    2,\n                    true\n                ],\n                [\n                    \"4\",\n                    2,\n                    true\n                ],\n                [\n                    \"5\",\n                    1,\n                    false\n                ]\n            ],\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                2400,\n                5000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"observed_segments\": [\n                [\n                    \"1\",\n                    1\n                ],\n                [\n                    \"2\",\n                    3\n                ],\n                [\n                    \"3\",\n                    3\n                ],\n                [\n                    \"4\",\n                    3\n                ],\n                [\n                    \"5\",\n                    1\n                ]\n            ],\n            \"reset_inflow\": true,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 3600,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 4000\n    },\n    \"env_name\": \"flow.envs.density_aware_bottleneck_env.DensityAwareBottleneckEnv\",\n    \"exp_tag\": \"bottleneck_ours\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 2,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 360.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 3240.0,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bottleneck.BottleneckNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 5.0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "PPO"}, "env": "DensityAwareBottleneckEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.15], [500000, 0.05], [1000000, 0.02], [2000000, 0.01]], "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 716.9302432537079, "timesteps_since_restore": 115200, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.1482421875, "ram_util_percent": 15.060839843750001}, "num_healthy_workers": 8, "trial_id": "22dc73ec", "experiment_tag": "0"}
